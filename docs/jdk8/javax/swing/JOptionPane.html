<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
    </head>
<body>
<pre class="code">
/*
 * Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.swing;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Container;
import java.awt.Dialog;
import java.awt.Dimension;
import java.awt.KeyboardFocusManager;
import java.awt.Frame;
import java.awt.Point;
import java.awt.HeadlessException;
import java.awt.Window;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.awt.event.WindowListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.lang.reflect.Method;
import java.lang.reflect.InvocationTargetException;
import java.security.AccessController;
import java.security.PrivilegedAction;
import java.util.Vector;
import javax.swing.plaf.OptionPaneUI;
import javax.swing.event.InternalFrameEvent;
import javax.swing.event.InternalFrameAdapter;
import javax.accessibility.*;
import static javax.swing.ClientPropertyKey.PopupFactory_FORCE_HEAVYWEIGHT_POPUP;

/**
 * &lt;code&gt;JOptionPane&lt;/code&gt; makes it easy to pop up a standard dialog box that
 * prompts users for a value or informs them of something.
 * For information about using &lt;code&gt;JOptionPane&lt;/code&gt;, see
 * &lt;a
 href=&quot;http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html&quot;&gt;How to Make Dialogs&lt;/a&gt;,
 * a section in &lt;em&gt;The Java Tutorial&lt;/em&gt;.
 *
 * &lt;p&gt;
 *
 * While the &lt;code&gt;JOptionPane&lt;/code&gt;
 * class may appear complex because of the large number of methods, almost
 * all uses of this class are one-line calls to one of the static
 * &lt;code&gt;showXxxDialog&lt;/code&gt; methods shown below:
 * &lt;blockquote&gt;
 *
 *
 * &lt;table border=1 summary=&quot;Common JOptionPane method names and their descriptions&quot;&gt;
 * &lt;tr&gt;
 *    &lt;th&gt;Method Name&lt;/th&gt;
 *    &lt;th&gt;Description&lt;/th&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *    &lt;td&gt;showConfirmDialog&lt;/td&gt;
 *    &lt;td&gt;Asks a confirming question, like yes/no/cancel.&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *    &lt;td&gt;showInputDialog&lt;/td&gt;
 *    &lt;td&gt;Prompt for some input.&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *   &lt;td&gt;showMessageDialog&lt;/td&gt;
 *   &lt;td&gt;Tell the user about something that has happened.&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *   &lt;td&gt;showOptionDialog&lt;/td&gt;
 *   &lt;td&gt;The Grand Unification of the above three.&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;/table&gt;
 *
 * &lt;/blockquote&gt;
 * Each of these methods also comes in a &lt;code&gt;showInternalXXX&lt;/code&gt;
 * flavor, which uses an internal frame to hold the dialog box (see
 * {@link JInternalFrame}).
 * Multiple convenience methods have also been defined -- overloaded
 * versions of the basic methods that use different parameter lists.
 * &lt;p&gt;
 * All dialogs are modal. Each &lt;code&gt;showXxxDialog&lt;/code&gt; method blocks
 * the caller until the user's interaction is complete.
 *
 * &lt;table cellspacing=6 cellpadding=4 border=0 style=&quot;float:right&quot; summary=&quot;layout&quot;&gt;
 * &lt;tr&gt;
 *  &lt;td style=&quot;background-color:#FFe0d0&quot; rowspan=2&gt;icon&lt;/td&gt;
 *  &lt;td style=&quot;background-color:#FFe0d0&quot;&gt;message&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *  &lt;td style=&quot;background-color:#FFe0d0&quot;&gt;input value&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;tr&gt;
 *   &lt;td style=&quot;background-color:#FFe0d0&quot; colspan=2&gt;option buttons&lt;/td&gt;
 * &lt;/tr&gt;
 * &lt;/table&gt;
 *
 * The basic appearance of one of these dialog boxes is generally
 * similar to the picture at the right, although the various
 * look-and-feels are
 * ultimately responsible for the final result.  In particular, the
 * look-and-feels will adjust the layout to accommodate the option pane's
 * &lt;code&gt;ComponentOrientation&lt;/code&gt; property.
 * &lt;br style=&quot;clear:all&quot;&gt;
 * &lt;p&gt;
 * &lt;b&gt;Parameters:&lt;/b&gt;&lt;br&gt;
 * The parameters to these methods follow consistent patterns:
 * &lt;blockquote&gt;
 * &lt;dl compact&gt;
 * &lt;dt&gt;parentComponent&lt;dd&gt;
 * Defines the &lt;code&gt;Component&lt;/code&gt; that is to be the parent of this
 * dialog box.
 * It is used in two ways: the &lt;code&gt;Frame&lt;/code&gt; that contains
 * it is used as the &lt;code&gt;Frame&lt;/code&gt;
 * parent for the dialog box, and its screen coordinates are used in
 * the placement of the dialog box. In general, the dialog box is placed
 * just below the component. This parameter may be &lt;code&gt;null&lt;/code&gt;,
 * in which case a default &lt;code&gt;Frame&lt;/code&gt; is used as the parent,
 * and the dialog will be
 * centered on the screen (depending on the {@literal L&amp;F}).
 * &lt;dt&gt;&lt;a name=message&gt;message&lt;/a&gt;&lt;dd&gt;
 * A descriptive message to be placed in the dialog box.
 * In the most common usage, message is just a &lt;code&gt;String&lt;/code&gt; or
 * &lt;code&gt;String&lt;/code&gt; constant.
 * However, the type of this parameter is actually &lt;code&gt;Object&lt;/code&gt;. Its
 * interpretation depends on its type:
 * &lt;dl compact&gt;
 * &lt;dt&gt;Object[]&lt;dd&gt;An array of objects is interpreted as a series of
 *                 messages (one per object) arranged in a vertical stack.
 *                 The interpretation is recursive -- each object in the
 *                 array is interpreted according to its type.
 * &lt;dt&gt;Component&lt;dd&gt;The &lt;code&gt;Component&lt;/code&gt; is displayed in the dialog.
 * &lt;dt&gt;Icon&lt;dd&gt;The &lt;code&gt;Icon&lt;/code&gt; is wrapped in a &lt;code&gt;JLabel&lt;/code&gt;
 *               and displayed in the dialog.
 * &lt;dt&gt;others&lt;dd&gt;The object is converted to a &lt;code&gt;String&lt;/code&gt; by calling
 *               its &lt;code&gt;toString&lt;/code&gt; method. The result is wrapped in a
 *               &lt;code&gt;JLabel&lt;/code&gt; and displayed.
 * &lt;/dl&gt;
 * &lt;dt&gt;messageType&lt;dd&gt;Defines the style of the message. The Look and Feel
 * manager may lay out the dialog differently depending on this value, and
 * will often provide a default icon. The possible values are:
 * &lt;ul&gt;
 * &lt;li&gt;&lt;code&gt;ERROR_MESSAGE&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;WARNING_MESSAGE&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
 * &lt;/ul&gt;
 * &lt;dt&gt;optionType&lt;dd&gt;Defines the set of option buttons that appear at
 * the bottom of the dialog box:
 * &lt;ul&gt;
 * &lt;li&gt;&lt;code&gt;DEFAULT_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;YES_NO_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
 * &lt;/ul&gt;
 * You aren't limited to this set of option buttons.  You can provide any
 * buttons you want using the options parameter.
 * &lt;dt&gt;options&lt;dd&gt;A more detailed description of the set of option buttons
 * that will appear at the bottom of the dialog box.
 * The usual value for the options parameter is an array of
 * &lt;code&gt;String&lt;/code&gt;s. But
 * the parameter type is an array of &lt;code&gt;Objects&lt;/code&gt;.
 * A button is created for each object depending on its type:
 * &lt;dl compact&gt;
 * &lt;dt&gt;Component&lt;dd&gt;The component is added to the button row directly.
 * &lt;dt&gt;Icon&lt;dd&gt;A &lt;code&gt;JButton&lt;/code&gt; is created with this as its label.
 * &lt;dt&gt;other&lt;dd&gt;The &lt;code&gt;Object&lt;/code&gt; is converted to a string using its
 *              &lt;code&gt;toString&lt;/code&gt; method and the result is used to
 *              label a &lt;code&gt;JButton&lt;/code&gt;.
 * &lt;/dl&gt;
 * &lt;dt&gt;icon&lt;dd&gt;A decorative icon to be placed in the dialog box. A default
 * value for this is determined by the &lt;code&gt;messageType&lt;/code&gt; parameter.
 * &lt;dt&gt;title&lt;dd&gt;The title for the dialog box.
 * &lt;dt&gt;initialValue&lt;dd&gt;The default selection (input value).
 * &lt;/dl&gt;
 * &lt;/blockquote&gt;
 * &lt;p&gt;
 * When the selection is changed, &lt;code&gt;setValue&lt;/code&gt; is invoked,
 * which generates a &lt;code&gt;PropertyChangeEvent&lt;/code&gt;.
 * &lt;p&gt;
 * If a &lt;code&gt;JOptionPane&lt;/code&gt; has configured to all input
 * &lt;code&gt;setWantsInput&lt;/code&gt;
 * the bound property &lt;code&gt;JOptionPane.INPUT_VALUE_PROPERTY&lt;/code&gt;
 *  can also be listened
 * to, to determine when the user has input or selected a value.
 * &lt;p&gt;
 * When one of the &lt;code&gt;showXxxDialog&lt;/code&gt; methods returns an integer,
 * the possible values are:
 * &lt;ul&gt;
 * &lt;li&gt;&lt;code&gt;YES_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;NO_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;CANCEL_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;OK_OPTION&lt;/code&gt;
 * &lt;li&gt;&lt;code&gt;CLOSED_OPTION&lt;/code&gt;
 * &lt;/ul&gt;
 * &lt;b&gt;Examples:&lt;/b&gt;
 * &lt;dl&gt;
 * &lt;dt&gt;Show an error dialog that displays the message, 'alert':
 * &lt;dd&gt;&lt;code&gt;
 * JOptionPane.showMessageDialog(null, &quot;alert&quot;, &quot;alert&quot;, JOptionPane.ERROR_MESSAGE);
 * &lt;/code&gt;
 * &lt;dt&gt;Show an internal information dialog with the message, 'information':
 * &lt;dd&gt;&lt;pre&gt;
 * JOptionPane.showInternalMessageDialog(frame, &quot;information&quot;,
 *             &quot;information&quot;, JOptionPane.INFORMATION_MESSAGE);
 * &lt;/pre&gt;
 * &lt;dt&gt;Show an information panel with the options yes/no and message 'choose one':
 * &lt;dd&gt;&lt;pre&gt;JOptionPane.showConfirmDialog(null,
 *             &quot;choose one&quot;, &quot;choose one&quot;, JOptionPane.YES_NO_OPTION);
 * &lt;/pre&gt;
 * &lt;dt&gt;Show an internal information dialog with the options yes/no/cancel and
 * message 'please choose one' and title information:
 * &lt;dd&gt;&lt;pre&gt;JOptionPane.showInternalConfirmDialog(frame,
 *             &quot;please choose one&quot;, &quot;information&quot;,
 *             JOptionPane.YES_NO_CANCEL_OPTION, JOptionPane.INFORMATION_MESSAGE);
 * &lt;/pre&gt;
 * &lt;dt&gt;Show a warning dialog with the options OK, CANCEL, title 'Warning', and
 * message 'Click OK to continue':
 * &lt;dd&gt;&lt;pre&gt;
 * Object[] options = { &quot;OK&quot;, &quot;CANCEL&quot; };
 * JOptionPane.showOptionDialog(null, &quot;Click OK to continue&quot;, &quot;Warning&quot;,
 *             JOptionPane.DEFAULT_OPTION, JOptionPane.WARNING_MESSAGE,
 *             null, options, options[0]);
 * &lt;/pre&gt;
 * &lt;dt&gt;Show a dialog asking the user to type in a String:
 * &lt;dd&gt;&lt;code&gt;
 * String inputValue = JOptionPane.showInputDialog(&quot;Please input a value&quot;);
 * &lt;/code&gt;
 * &lt;dt&gt;Show a dialog asking the user to select a String:
 * &lt;dd&gt;&lt;pre&gt;
 * Object[] possibleValues = { &quot;First&quot;, &quot;Second&quot;, &quot;Third&quot; };&lt;br&gt;
 * Object selectedValue = JOptionPane.showInputDialog(null,
 *             &quot;Choose one&quot;, &quot;Input&quot;,
 *             JOptionPane.INFORMATION_MESSAGE, null,
 *             possibleValues, possibleValues[0]);
 * &lt;/pre&gt;&lt;p&gt;
 * &lt;/dl&gt;
 * &lt;b&gt;Direct Use:&lt;/b&gt;&lt;br&gt;
 * To create and use an &lt;code&gt;JOptionPane&lt;/code&gt; directly, the
 * standard pattern is roughly as follows:
 * &lt;pre&gt;
 *     JOptionPane pane = new JOptionPane(&lt;i&gt;arguments&lt;/i&gt;);
 *     pane.set&lt;i&gt;.Xxxx(...); // Configure&lt;/i&gt;
 *     JDialog dialog = pane.createDialog(&lt;i&gt;parentComponent, title&lt;/i&gt;);
 *     dialog.show();
 *     Object selectedValue = pane.getValue();
 *     if(selectedValue == null)
 *       return CLOSED_OPTION;
 *     &lt;i&gt;//If there is &lt;b&gt;not&lt;/b&gt; an array of option buttons:&lt;/i&gt;
 *     if(options == null) {
 *       if(selectedValue instanceof Integer)
 *          return ((Integer)selectedValue).intValue();
 *       return CLOSED_OPTION;
 *     }
 *     &lt;i&gt;//If there is an array of option buttons:&lt;/i&gt;
 *     for(int counter = 0, maxCounter = options.length;
 *        counter &amp;lt; maxCounter; counter++) {
 *        if(options[counter].equals(selectedValue))
 *        return counter;
 *     }
 *     return CLOSED_OPTION;
 * &lt;/pre&gt;
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt; Swing is not thread safe. For more
 * information see &lt;a
 * href=&quot;package-summary.html#threading&quot;&gt;Swing's Threading
 * Policy&lt;/a&gt;.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * Serialized objects of this class will not be compatible with
 * future Swing releases. The current serialization support is
 * appropriate for short term storage or RMI between applications running
 * the same version of Swing.  As of 1.4, support for long term storage
 * of all JavaBeans&amp;trade;
 * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
 * Please see {@link java.beans.XMLEncoder}.
 *
 * @see JInternalFrame
 *
 * @beaninfo
 *      attribute: isContainer true
 *    description: A component which implements standard dialog box controls.
 *
 * @author James Gosling
 * @author Scott Violet
 */
public class JOptionPane extends JComponent implements Accessible
{
    /**
     * @see #getUIClassID
     * @see #readObject
     */
    private static final String uiClassID = &quot;OptionPaneUI&quot;;

    /**
     * Indicates that the user has not yet selected a value.
     */
    public static final Object      UNINITIALIZED_VALUE = &quot;uninitializedValue&quot;;

    //
    // Option types
    //

    /**
     * Type meaning Look and Feel should not supply any options -- only
     * use the options from the &lt;code&gt;JOptionPane&lt;/code&gt;.
     */
    public static final int         DEFAULT_OPTION = -1;
    /** Type used for &lt;code&gt;showConfirmDialog&lt;/code&gt;. */
    public static final int         YES_NO_OPTION = 0;
    /** Type used for &lt;code&gt;showConfirmDialog&lt;/code&gt;. */
    public static final int         YES_NO_CANCEL_OPTION = 1;
    /** Type used for &lt;code&gt;showConfirmDialog&lt;/code&gt;. */
    public static final int         OK_CANCEL_OPTION = 2;

    //
    // Return values.
    //
    /** Return value from class method if YES is chosen. */
    public static final int         YES_OPTION = 0;
    /** Return value from class method if NO is chosen. */
    public static final int         NO_OPTION = 1;
    /** Return value from class method if CANCEL is chosen. */
    public static final int         CANCEL_OPTION = 2;
    /** Return value form class method if OK is chosen. */
    public static final int         OK_OPTION = 0;
    /** Return value from class method if user closes window without selecting
     * anything, more than likely this should be treated as either a
     * &lt;code&gt;CANCEL_OPTION&lt;/code&gt; or &lt;code&gt;NO_OPTION&lt;/code&gt;. */
    public static final int         CLOSED_OPTION = -1;

    //
    // Message types. Used by the UI to determine what icon to display,
    // and possibly what behavior to give based on the type.
    //
    /** Used for error messages. */
    public static final int  ERROR_MESSAGE = 0;
    /** Used for information messages. */
    public static final int  INFORMATION_MESSAGE = 1;
    /** Used for warning messages. */
    public static final int  WARNING_MESSAGE = 2;
    /** Used for questions. */
    public static final int  QUESTION_MESSAGE = 3;
    /** No icon is used. */
    public static final int   PLAIN_MESSAGE = -1;

    /** Bound property name for &lt;code&gt;icon&lt;/code&gt;. */
    public static final String      ICON_PROPERTY = &quot;icon&quot;;
    /** Bound property name for &lt;code&gt;message&lt;/code&gt;. */
    public static final String      MESSAGE_PROPERTY = &quot;message&quot;;
    /** Bound property name for &lt;code&gt;value&lt;/code&gt;. */
    public static final String      VALUE_PROPERTY = &quot;value&quot;;
    /** Bound property name for &lt;code&gt;option&lt;/code&gt;. */
    public static final String      OPTIONS_PROPERTY = &quot;options&quot;;
    /** Bound property name for &lt;code&gt;initialValue&lt;/code&gt;. */
    public static final String      INITIAL_VALUE_PROPERTY = &quot;initialValue&quot;;
    /** Bound property name for &lt;code&gt;type&lt;/code&gt;. */
    public static final String      MESSAGE_TYPE_PROPERTY = &quot;messageType&quot;;
    /** Bound property name for &lt;code&gt;optionType&lt;/code&gt;. */
    public static final String      OPTION_TYPE_PROPERTY = &quot;optionType&quot;;
    /** Bound property name for &lt;code&gt;selectionValues&lt;/code&gt;. */
    public static final String      SELECTION_VALUES_PROPERTY = &quot;selectionValues&quot;;
    /** Bound property name for &lt;code&gt;initialSelectionValue&lt;/code&gt;. */
    public static final String      INITIAL_SELECTION_VALUE_PROPERTY = &quot;initialSelectionValue&quot;;
    /** Bound property name for &lt;code&gt;inputValue&lt;/code&gt;. */
    public static final String      INPUT_VALUE_PROPERTY = &quot;inputValue&quot;;
    /** Bound property name for &lt;code&gt;wantsInput&lt;/code&gt;. */
    public static final String      WANTS_INPUT_PROPERTY = &quot;wantsInput&quot;;

    /** Icon used in pane. */
    transient protected Icon                  icon;
    /** Message to display. */
    transient protected Object                message;
    /** Options to display to the user. */
    transient protected Object[]              options;
    /** Value that should be initially selected in &lt;code&gt;options&lt;/code&gt;. */
    transient protected Object                initialValue;
    /** Message type. */
    protected int                   messageType;
    /**
     * Option type, one of &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;,
     * &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     * &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt; or
     * &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;.
     */
    protected int                   optionType;
    /** Currently selected value, will be a valid option, or
     * &lt;code&gt;UNINITIALIZED_VALUE&lt;/code&gt; or &lt;code&gt;null&lt;/code&gt;. */
    transient protected Object                value;
    /** Array of values the user can choose from. Look and feel will
     * provide the UI component to choose this from. */
    protected transient Object[]              selectionValues;
    /** Value the user has input. */
    protected transient Object                inputValue;
    /** Initial value to select in &lt;code&gt;selectionValues&lt;/code&gt;. */
    protected transient Object                initialSelectionValue;
    /** If true, a UI widget will be provided to the user to get input. */
    protected boolean                         wantsInput;


    /**
     * Shows a question-message dialog requesting input from the user. The
     * dialog uses the default frame, which usually means it is centered on
     * the screen.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static String showInputDialog(Object message)
        throws HeadlessException {
        return showInputDialog(null, message);
    }

    /**
     * Shows a question-message dialog requesting input from the user, with
     * the input value initialized to &lt;code&gt;initialSelectionValue&lt;/code&gt;. The
     * dialog uses the default frame, which usually means it is centered on
     * the screen.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param initialSelectionValue the value used to initialize the input
     *                 field
     * @since 1.4
     */
    public static String showInputDialog(Object message, Object initialSelectionValue) {
        return showInputDialog(null, message, initialSelectionValue);
    }

    /**
     * Shows a question-message dialog requesting input from the user
     * parented to &lt;code&gt;parentComponent&lt;/code&gt;.
     * The dialog is displayed on top of the &lt;code&gt;Component&lt;/code&gt;'s
     * frame, and is usually positioned below the &lt;code&gt;Component&lt;/code&gt;.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt; for the
     *          dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     * @exception HeadlessException if
     *    &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *    &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static String showInputDialog(Component parentComponent,
        Object message) throws HeadlessException {
        return showInputDialog(parentComponent, message, UIManager.getString(
            &quot;OptionPane.inputDialogTitle&quot;, parentComponent), QUESTION_MESSAGE);
    }

    /**
     * Shows a question-message dialog requesting input from the user and
     * parented to &lt;code&gt;parentComponent&lt;/code&gt;. The input value will be
     * initialized to &lt;code&gt;initialSelectionValue&lt;/code&gt;.
     * The dialog is displayed on top of the &lt;code&gt;Component&lt;/code&gt;'s
     * frame, and is usually positioned below the &lt;code&gt;Component&lt;/code&gt;.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt; for the
     *          dialog
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param initialSelectionValue the value used to initialize the input
     *                 field
     * @since 1.4
     */
    public static String showInputDialog(Component parentComponent, Object message,
                                         Object initialSelectionValue) {
        return (String)showInputDialog(parentComponent, message,
                      UIManager.getString(&quot;OptionPane.inputDialogTitle&quot;,
                      parentComponent), QUESTION_MESSAGE, null, null,
                      initialSelectionValue);
    }

    /**
     * Shows a dialog requesting input from the user parented to
     * &lt;code&gt;parentComponent&lt;/code&gt; with the dialog having the title
     * &lt;code&gt;title&lt;/code&gt; and message type &lt;code&gt;messageType&lt;/code&gt;.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt; for the
     *                  dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title    the &lt;code&gt;String&lt;/code&gt; to display in the dialog
     *                  title bar
     * @param messageType the type of message that is to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static String showInputDialog(Component parentComponent,
        Object message, String title, int messageType)
        throws HeadlessException {
        return (String)showInputDialog(parentComponent, message, title,
                                       messageType, null, null, null);
    }

    /**
     * Prompts the user for input in a blocking dialog where the
     * initial selection, possible selections, and all other options can
     * be specified. The user will able to choose from
     * &lt;code&gt;selectionValues&lt;/code&gt;, where &lt;code&gt;null&lt;/code&gt; implies the
     * user can input
     * whatever they wish, usually by means of a &lt;code&gt;JTextField&lt;/code&gt;.
     * &lt;code&gt;initialSelectionValue&lt;/code&gt; is the initial value to prompt
     * the user with. It is up to the UI to decide how best to represent
     * the &lt;code&gt;selectionValues&lt;/code&gt;, but usually a
     * &lt;code&gt;JComboBox&lt;/code&gt;, &lt;code&gt;JList&lt;/code&gt;, or
     * &lt;code&gt;JTextField&lt;/code&gt; will be used.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt; for the
     *                  dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title    the &lt;code&gt;String&lt;/code&gt; to display in the
     *                  dialog title bar
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon     the &lt;code&gt;Icon&lt;/code&gt; image to display
     * @param selectionValues an array of &lt;code&gt;Object&lt;/code&gt;s that
     *                  gives the possible selections
     * @param initialSelectionValue the value used to initialize the input
     *                 field
     * @return user's input, or &lt;code&gt;null&lt;/code&gt; meaning the user
     *                  canceled the input
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static Object showInputDialog(Component parentComponent,
        Object message, String title, int messageType, Icon icon,
        Object[] selectionValues, Object initialSelectionValue)
        throws HeadlessException {
        JOptionPane    pane = new JOptionPane(message, messageType,
                                              OK_CANCEL_OPTION, icon,
                                              null, null);

        pane.setWantsInput(true);
        pane.setSelectionValues(selectionValues);
        pane.setInitialSelectionValue(initialSelectionValue);
        pane.setComponentOrientation(((parentComponent == null) ?
            getRootFrame() : parentComponent).getComponentOrientation());

        int style = styleFromMessageType(messageType);
        JDialog dialog = pane.createDialog(parentComponent, title, style);

        pane.selectInitialValue();
        dialog.show();
        dialog.dispose();

        Object value = pane.getInputValue();

        if (value == UNINITIALIZED_VALUE) {
            return null;
        }
        return value;
    }

    /**
     * Brings up an information-message dialog titled &quot;Message&quot;.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in
     *          which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static void showMessageDialog(Component parentComponent,
        Object message) throws HeadlessException {
        showMessageDialog(parentComponent, message, UIManager.getString(
                    &quot;OptionPane.messageDialogTitle&quot;, parentComponent),
                    INFORMATION_MESSAGE);
    }

    /**
     * Brings up a dialog that displays a message using a default
     * icon determined by the &lt;code&gt;messageType&lt;/code&gt; parameter.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static void showMessageDialog(Component parentComponent,
        Object message, String title, int messageType)
        throws HeadlessException {
        showMessageDialog(parentComponent, message, title, messageType, null);
    }

    /**
     * Brings up a dialog displaying a message, specifying all parameters.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in which the
     *                  dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *                  or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      an icon to display in the dialog that helps the user
     *                  identify the kind of message that is being displayed
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static void showMessageDialog(Component parentComponent,
        Object message, String title, int messageType, Icon icon)
        throws HeadlessException {
        showOptionDialog(parentComponent, message, title, DEFAULT_OPTION,
                         messageType, icon, null, null);
    }

    /**
     * Brings up a dialog with the options &lt;i&gt;Yes&lt;/i&gt;,
     * &lt;i&gt;No&lt;/i&gt; and &lt;i&gt;Cancel&lt;/i&gt;; with the
     * title, &lt;b&gt;Select an Option&lt;/b&gt;.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in which the
     *                  dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *                  or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @return an integer indicating the option selected by the user
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static int showConfirmDialog(Component parentComponent,
        Object message) throws HeadlessException {
        return showConfirmDialog(parentComponent, message,
                                 UIManager.getString(&quot;OptionPane.titleText&quot;),
                                 YES_NO_CANCEL_OPTION);
    }

    /**
     * Brings up a dialog where the number of choices is determined
     * by the &lt;code&gt;optionType&lt;/code&gt; parameter.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in which the
     *                  dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *                  or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param optionType an int designating the options available on the dialog:
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  or &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @return an int indicating the option selected by the user
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static int showConfirmDialog(Component parentComponent,
        Object message, String title, int optionType)
        throws HeadlessException {
        return showConfirmDialog(parentComponent, message, title, optionType,
                                 QUESTION_MESSAGE);
    }

    /**
     * Brings up a dialog where the number of choices is determined
     * by the &lt;code&gt;optionType&lt;/code&gt; parameter, where the
     * &lt;code&gt;messageType&lt;/code&gt;
     * parameter determines the icon to display.
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the Look and Feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in
     *                  which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *                  or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used.
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options available
     *                   on the dialog: &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  or &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param messageType an integer designating the kind of message this is;
     *                  primarily used to determine the icon from the pluggable
     *                  Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @return an integer indicating the option selected by the user
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static int showConfirmDialog(Component parentComponent,
        Object message, String title, int optionType, int messageType)
        throws HeadlessException {
        return showConfirmDialog(parentComponent, message, title, optionType,
                                messageType, null);
    }

    /**
     * Brings up a dialog with a specified icon, where the number of
     * choices is determined by the &lt;code&gt;optionType&lt;/code&gt; parameter.
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the look and feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in which the
     *                  dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *                  or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the Object to display
     * @param title     the title string for the dialog
     * @param optionType an int designating the options available on the dialog:
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  or &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param messageType an int designating the kind of message this is,
     *                  primarily used to determine the icon from the pluggable
     *                  Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      the icon to display in the dialog
     * @return an int indicating the option selected by the user
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static int showConfirmDialog(Component parentComponent,
        Object message, String title, int optionType,
        int messageType, Icon icon) throws HeadlessException {
        return showOptionDialog(parentComponent, message, title, optionType,
                                messageType, icon, null, null);
    }

    /**
     * Brings up a dialog with a specified icon, where the initial
     * choice is determined by the &lt;code&gt;initialValue&lt;/code&gt; parameter and
     * the number of choices is determined by the &lt;code&gt;optionType&lt;/code&gt;
     * parameter.
     * &lt;p&gt;
     * If &lt;code&gt;optionType&lt;/code&gt; is &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     * or &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
     * and the &lt;code&gt;options&lt;/code&gt; parameter is &lt;code&gt;null&lt;/code&gt;,
     * then the options are
     * supplied by the look and feel.
     * &lt;p&gt;
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the look and feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *                  in which the dialog is displayed;  if
     *                  &lt;code&gt;null&lt;/code&gt;, or if the
     *                  &lt;code&gt;parentComponent&lt;/code&gt; has no
     *                  &lt;code&gt;Frame&lt;/code&gt;, a
     *                  default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options available on the
     *                  dialog: &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  or &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param messageType an integer designating the kind of message this is,
     *                  primarily used to determine the icon from the
     *                  pluggable Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      the icon to display in the dialog
     * @param options   an array of objects indicating the possible choices
     *                  the user can make; if the objects are components, they
     *                  are rendered properly; non-&lt;code&gt;String&lt;/code&gt;
     *                  objects are
     *                  rendered using their &lt;code&gt;toString&lt;/code&gt; methods;
     *                  if this parameter is &lt;code&gt;null&lt;/code&gt;,
     *                  the options are determined by the Look and Feel
     * @param initialValue the object that represents the default selection
     *                  for the dialog; only meaningful if &lt;code&gt;options&lt;/code&gt;
     *                  is used; can be &lt;code&gt;null&lt;/code&gt;
     * @return an integer indicating the option chosen by the user,
     *                  or &lt;code&gt;CLOSED_OPTION&lt;/code&gt; if the user closed
     *                  the dialog
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static int showOptionDialog(Component parentComponent,
        Object message, String title, int optionType, int messageType,
        Icon icon, Object[] options, Object initialValue)
        throws HeadlessException {
        JOptionPane             pane = new JOptionPane(message, messageType,
                                                       optionType, icon,
                                                       options, initialValue);

        pane.setInitialValue(initialValue);
        pane.setComponentOrientation(((parentComponent == null) ?
            getRootFrame() : parentComponent).getComponentOrientation());

        int style = styleFromMessageType(messageType);
        JDialog dialog = pane.createDialog(parentComponent, title, style);

        pane.selectInitialValue();
        dialog.show();
        dialog.dispose();

        Object        selectedValue = pane.getValue();

        if(selectedValue == null)
            return CLOSED_OPTION;
        if(options == null) {
            if(selectedValue instanceof Integer)
                return ((Integer)selectedValue).intValue();
            return CLOSED_OPTION;
        }
        for(int counter = 0, maxCounter = options.length;
            counter &lt; maxCounter; counter++) {
            if(options[counter].equals(selectedValue))
                return counter;
        }
        return CLOSED_OPTION;
    }

    /**
     * Creates and returns a new &lt;code&gt;JDialog&lt;/code&gt; wrapping
     * &lt;code&gt;this&lt;/code&gt; centered on the &lt;code&gt;parentComponent&lt;/code&gt;
     * in the &lt;code&gt;parentComponent&lt;/code&gt;'s frame.
     * &lt;code&gt;title&lt;/code&gt; is the title of the returned dialog.
     * The returned &lt;code&gt;JDialog&lt;/code&gt; will not be resizable by the
     * user, however programs can invoke &lt;code&gt;setResizable&lt;/code&gt; on
     * the &lt;code&gt;JDialog&lt;/code&gt; instance to change this property.
     * The returned &lt;code&gt;JDialog&lt;/code&gt; will be set up such that
     * once it is closed, or the user clicks on one of the buttons,
     * the optionpane's value property will be set accordingly and
     * the dialog will be closed.  Each time the dialog is made visible,
     * it will reset the option pane's value property to
     * &lt;code&gt;JOptionPane.UNINITIALIZED_VALUE&lt;/code&gt; to ensure the
     * user's subsequent action closes the dialog properly.
     *
     * @param parentComponent determines the frame in which the dialog
     *          is displayed; if the &lt;code&gt;parentComponent&lt;/code&gt; has
     *          no &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param title     the title string for the dialog
     * @return a new &lt;code&gt;JDialog&lt;/code&gt; containing this instance
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public JDialog createDialog(Component parentComponent, String title)
        throws HeadlessException {
        int style = styleFromMessageType(getMessageType());
        return createDialog(parentComponent, title, style);
    }

    /**
     * Creates and returns a new parentless &lt;code&gt;JDialog&lt;/code&gt;
     * with the specified title.
     * The returned &lt;code&gt;JDialog&lt;/code&gt; will not be resizable by the
     * user, however programs can invoke &lt;code&gt;setResizable&lt;/code&gt; on
     * the &lt;code&gt;JDialog&lt;/code&gt; instance to change this property.
     * The returned &lt;code&gt;JDialog&lt;/code&gt; will be set up such that
     * once it is closed, or the user clicks on one of the buttons,
     * the optionpane's value property will be set accordingly and
     * the dialog will be closed.  Each time the dialog is made visible,
     * it will reset the option pane's value property to
     * &lt;code&gt;JOptionPane.UNINITIALIZED_VALUE&lt;/code&gt; to ensure the
     * user's subsequent action closes the dialog properly.
     *
     * @param title     the title string for the dialog
     * @return a new &lt;code&gt;JDialog&lt;/code&gt; containing this instance
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     * @since 1.6
     */
    public JDialog createDialog(String title) throws HeadlessException {
        int style = styleFromMessageType(getMessageType());
        JDialog dialog = new JDialog((Dialog) null, title, true);
        initDialog(dialog, style, null);
        return dialog;
    }

    private JDialog createDialog(Component parentComponent, String title,
            int style)
            throws HeadlessException {

        final JDialog dialog;

        Window window = JOptionPane.getWindowForComponent(parentComponent);
        if (window instanceof Frame) {
            dialog = new JDialog((Frame)window, title, true);
        } else {
            dialog = new JDialog((Dialog)window, title, true);
        }
        if (window instanceof SwingUtilities.SharedOwnerFrame) {
            WindowListener ownerShutdownListener =
                    SwingUtilities.getSharedOwnerFrameShutdownListener();
            dialog.addWindowListener(ownerShutdownListener);
        }
        initDialog(dialog, style, parentComponent);
        return dialog;
    }

    private void initDialog(final JDialog dialog, int style, Component parentComponent) {
        dialog.setComponentOrientation(this.getComponentOrientation());
        Container contentPane = dialog.getContentPane();

        contentPane.setLayout(new BorderLayout());
        contentPane.add(this, BorderLayout.CENTER);
        dialog.setResizable(false);
        if (JDialog.isDefaultLookAndFeelDecorated()) {
            boolean supportsWindowDecorations =
              UIManager.getLookAndFeel().getSupportsWindowDecorations();
            if (supportsWindowDecorations) {
                dialog.setUndecorated(true);
                getRootPane().setWindowDecorationStyle(style);
            }
        }
        dialog.pack();
        dialog.setLocationRelativeTo(parentComponent);

        final PropertyChangeListener listener = new PropertyChangeListener() {
            public void propertyChange(PropertyChangeEvent event) {
                // Let the defaultCloseOperation handle the closing
                // if the user closed the window without selecting a button
                // (newValue = null in that case).  Otherwise, close the dialog.
                if (dialog.isVisible() &amp;&amp; event.getSource() == JOptionPane.this &amp;&amp;
                        (event.getPropertyName().equals(VALUE_PROPERTY)) &amp;&amp;
                        event.getNewValue() != null &amp;&amp;
                        event.getNewValue() != JOptionPane.UNINITIALIZED_VALUE) {
                    dialog.setVisible(false);
                }
            }
        };

        WindowAdapter adapter = new WindowAdapter() {
            private boolean gotFocus = false;
            public void windowClosing(WindowEvent we) {
                setValue(null);
            }

            public void windowClosed(WindowEvent e) {
                removePropertyChangeListener(listener);
                dialog.getContentPane().removeAll();
            }

            public void windowGainedFocus(WindowEvent we) {
                // Once window gets focus, set initial focus
                if (!gotFocus) {
                    selectInitialValue();
                    gotFocus = true;
                }
            }
        };
        dialog.addWindowListener(adapter);
        dialog.addWindowFocusListener(adapter);
        dialog.addComponentListener(new ComponentAdapter() {
            public void componentShown(ComponentEvent ce) {
                // reset value to ensure closing works properly
                setValue(JOptionPane.UNINITIALIZED_VALUE);
            }
        });

        addPropertyChangeListener(listener);
    }


    /**
     * Brings up an internal confirmation dialog panel. The dialog
     * is a information-message dialog titled &quot;Message&quot;.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the object to display
     */
    public static void showInternalMessageDialog(Component parentComponent,
                                                 Object message) {
        showInternalMessageDialog(parentComponent, message, UIManager.
                                 getString(&quot;OptionPane.messageDialogTitle&quot;,
                                 parentComponent), INFORMATION_MESSAGE);
    }

    /**
     * Brings up an internal dialog panel that displays a message
     * using a default icon determined by the &lt;code&gt;messageType&lt;/code&gt;
     * parameter.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     */
    public static void showInternalMessageDialog(Component parentComponent,
                                                 Object message, String title,
                                                 int messageType) {
        showInternalMessageDialog(parentComponent, message, title, messageType,null);
    }

    /**
     * Brings up an internal dialog panel displaying a message,
     * specifying all parameters.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title     the title string for the dialog
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      an icon to display in the dialog that helps the user
     *                  identify the kind of message that is being displayed
     */
    public static void showInternalMessageDialog(Component parentComponent,
                                         Object message,
                                         String title, int messageType,
                                         Icon icon){
        showInternalOptionDialog(parentComponent, message, title, DEFAULT_OPTION,
                                 messageType, icon, null, null);
    }

    /**
     * Brings up an internal dialog panel with the options &lt;i&gt;Yes&lt;/i&gt;, &lt;i&gt;No&lt;/i&gt;
     * and &lt;i&gt;Cancel&lt;/i&gt;; with the title, &lt;b&gt;Select an Option&lt;/b&gt;.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in
     *          which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the &lt;code&gt;Object&lt;/code&gt; to display
     * @return an integer indicating the option selected by the user
     */
    public static int showInternalConfirmDialog(Component parentComponent,
                                                Object message) {
        return showInternalConfirmDialog(parentComponent, message,
                                 UIManager.getString(&quot;OptionPane.titleText&quot;),
                                 YES_NO_CANCEL_OPTION);
    }

    /**
     * Brings up a internal dialog panel where the number of choices
     * is determined by the &lt;code&gt;optionType&lt;/code&gt; parameter.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the object to display in the dialog; a
     *          &lt;code&gt;Component&lt;/code&gt; object is rendered as a
     *          &lt;code&gt;Component&lt;/code&gt;; a &lt;code&gt;String&lt;/code&gt;
     *          object is rendered as a string; other objects
     *          are converted to a &lt;code&gt;String&lt;/code&gt; using the
     *          &lt;code&gt;toString&lt;/code&gt; method
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options
     *          available on the dialog: &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *          or &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
     * @return an integer indicating the option selected by the user
     */
    public static int showInternalConfirmDialog(Component parentComponent,
                                                Object message, String title,
                                                int optionType) {
        return showInternalConfirmDialog(parentComponent, message, title, optionType,
                                         QUESTION_MESSAGE);
    }

    /**
     * Brings up an internal dialog panel where the number of choices
     * is determined by the &lt;code&gt;optionType&lt;/code&gt; parameter, where
     * the &lt;code&gt;messageType&lt;/code&gt; parameter determines the icon to display.
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the Look and Feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt; in
     *          which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the object to display in the dialog; a
     *          &lt;code&gt;Component&lt;/code&gt; object is rendered as a
     *          &lt;code&gt;Component&lt;/code&gt;; a &lt;code&gt;String&lt;/code&gt;
     *          object is rendered as a string; other objects are
     *          converted to a &lt;code&gt;String&lt;/code&gt; using the
     *          &lt;code&gt;toString&lt;/code&gt; method
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options
     *          available on the dialog:
     *          &lt;code&gt;YES_NO_OPTION&lt;/code&gt;, or &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
     * @param messageType an integer designating the kind of message this is,
     *          primarily used to determine the icon from the
     *          pluggable Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;, &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *          or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @return an integer indicating the option selected by the user
     */
    public static int showInternalConfirmDialog(Component parentComponent,
                                        Object message,
                                        String title, int optionType,
                                        int messageType) {
        return showInternalConfirmDialog(parentComponent, message, title, optionType,
                                         messageType, null);
    }

    /**
     * Brings up an internal dialog panel with a specified icon, where
     * the number of choices is determined by the &lt;code&gt;optionType&lt;/code&gt;
     * parameter.
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the look and feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the parentComponent has no Frame, a
     *          default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the object to display in the dialog; a
     *          &lt;code&gt;Component&lt;/code&gt; object is rendered as a
     *          &lt;code&gt;Component&lt;/code&gt;; a &lt;code&gt;String&lt;/code&gt;
     *          object is rendered as a string; other objects are
     *          converted to a &lt;code&gt;String&lt;/code&gt; using the
     *          &lt;code&gt;toString&lt;/code&gt; method
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options available
     *          on the dialog:
     *          &lt;code&gt;YES_NO_OPTION&lt;/code&gt;, or
     *          &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;.
     * @param messageType an integer designating the kind of message this is,
     *          primarily used to determine the icon from the pluggable
     *          Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;, &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *          or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      the icon to display in the dialog
     * @return an integer indicating the option selected by the user
     */
    public static int showInternalConfirmDialog(Component parentComponent,
                                        Object message,
                                        String title, int optionType,
                                        int messageType, Icon icon) {
        return showInternalOptionDialog(parentComponent, message, title, optionType,
                                        messageType, icon, null, null);
    }

    /**
     * Brings up an internal dialog panel with a specified icon, where
     * the initial choice is determined by the &lt;code&gt;initialValue&lt;/code&gt;
     * parameter and the number of choices is determined by the
     * &lt;code&gt;optionType&lt;/code&gt; parameter.
     * &lt;p&gt;
     * If &lt;code&gt;optionType&lt;/code&gt; is &lt;code&gt;YES_NO_OPTION&lt;/code&gt;, or
     * &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
     * and the &lt;code&gt;options&lt;/code&gt; parameter is &lt;code&gt;null&lt;/code&gt;,
     * then the options are supplied by the Look and Feel.
     * &lt;p&gt;
     * The &lt;code&gt;messageType&lt;/code&gt; parameter is primarily used to supply
     * a default icon from the look and feel.
     *
     * @param parentComponent determines the &lt;code&gt;Frame&lt;/code&gt;
     *          in which the dialog is displayed; if &lt;code&gt;null&lt;/code&gt;,
     *          or if the &lt;code&gt;parentComponent&lt;/code&gt; has no
     *          &lt;code&gt;Frame&lt;/code&gt;, a default &lt;code&gt;Frame&lt;/code&gt; is used
     * @param message   the object to display in the dialog; a
     *          &lt;code&gt;Component&lt;/code&gt; object is rendered as a
     *          &lt;code&gt;Component&lt;/code&gt;; a &lt;code&gt;String&lt;/code&gt;
     *          object is rendered as a string. Other objects are
     *          converted to a &lt;code&gt;String&lt;/code&gt; using the
     *          &lt;code&gt;toString&lt;/code&gt; method
     * @param title     the title string for the dialog
     * @param optionType an integer designating the options available
     *          on the dialog: &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *          or &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;
     * @param messageType an integer designating the kind of message this is;
     *          primarily used to determine the icon from the
     *          pluggable Look and Feel: &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *          &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;, &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *          or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon      the icon to display in the dialog
     * @param options   an array of objects indicating the possible choices
     *          the user can make; if the objects are components, they
     *          are rendered properly; non-&lt;code&gt;String&lt;/code&gt;
     *          objects are rendered using their &lt;code&gt;toString&lt;/code&gt;
     *          methods; if this parameter is &lt;code&gt;null&lt;/code&gt;,
     *          the options are determined by the Look and Feel
     * @param initialValue the object that represents the default selection
     *          for the dialog; only meaningful if &lt;code&gt;options&lt;/code&gt;
     *          is used; can be &lt;code&gt;null&lt;/code&gt;
     * @return an integer indicating the option chosen by the user,
     *          or &lt;code&gt;CLOSED_OPTION&lt;/code&gt; if the user closed the Dialog
     */
    public static int showInternalOptionDialog(Component parentComponent,
                                       Object message,
                                       String title, int optionType,
                                       int messageType, Icon icon,
                                       Object[] options, Object initialValue) {
        JOptionPane pane = new JOptionPane(message, messageType,
                optionType, icon, options, initialValue);
        pane.putClientProperty(PopupFactory_FORCE_HEAVYWEIGHT_POPUP,
                Boolean.TRUE);
        Component fo = KeyboardFocusManager.getCurrentKeyboardFocusManager().
                getFocusOwner();

        pane.setInitialValue(initialValue);

        JInternalFrame dialog =
            pane.createInternalFrame(parentComponent, title);
        pane.selectInitialValue();
        dialog.setVisible(true);

        /* Since all input will be blocked until this dialog is dismissed,
         * make sure its parent containers are visible first (this component
         * is tested below).  This is necessary for JApplets, because
         * because an applet normally isn't made visible until after its
         * start() method returns -- if this method is called from start(),
         * the applet will appear to hang while an invisible modal frame
         * waits for input.
         */
        if (dialog.isVisible() &amp;&amp; !dialog.isShowing()) {
            Container parent = dialog.getParent();
            while (parent != null) {
                if (parent.isVisible() == false) {
                    parent.setVisible(true);
                }
                parent = parent.getParent();
            }
        }

        // Use reflection to get Container.startLWModal.
        try {
            Method method = AccessController.doPrivileged(new ModalPrivilegedAction(
                    Container.class, &quot;startLWModal&quot;));
            if (method != null) {
                method.invoke(dialog, (Object[])null);
            }
        } catch (IllegalAccessException ex) {
        } catch (IllegalArgumentException ex) {
        } catch (InvocationTargetException ex) {
        }

        if (parentComponent instanceof JInternalFrame) {
            try {
                ((JInternalFrame)parentComponent).setSelected(true);
            } catch (java.beans.PropertyVetoException e) {
            }
        }

        Object selectedValue = pane.getValue();

        if (fo != null &amp;&amp; fo.isShowing()) {
            fo.requestFocus();
        }
        if (selectedValue == null) {
            return CLOSED_OPTION;
        }
        if (options == null) {
            if (selectedValue instanceof Integer) {
                return ((Integer)selectedValue).intValue();
            }
            return CLOSED_OPTION;
        }
        for(int counter = 0, maxCounter = options.length;
            counter &lt; maxCounter; counter++) {
            if (options[counter].equals(selectedValue)) {
                return counter;
            }
        }
        return CLOSED_OPTION;
    }

    /**
     * Shows an internal question-message dialog requesting input from
     * the user parented to &lt;code&gt;parentComponent&lt;/code&gt;. The dialog
     * is displayed in the &lt;code&gt;Component&lt;/code&gt;'s frame,
     * and is usually positioned below the &lt;code&gt;Component&lt;/code&gt;.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt;
     *          for the dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     */
    public static String showInternalInputDialog(Component parentComponent,
                                                 Object message) {
        return showInternalInputDialog(parentComponent, message, UIManager.
               getString(&quot;OptionPane.inputDialogTitle&quot;, parentComponent),
               QUESTION_MESSAGE);
    }

    /**
     * Shows an internal dialog requesting input from the user parented
     * to &lt;code&gt;parentComponent&lt;/code&gt; with the dialog having the title
     * &lt;code&gt;title&lt;/code&gt; and message type &lt;code&gt;messageType&lt;/code&gt;.
     *
     * @param parentComponent the parent &lt;code&gt;Component&lt;/code&gt; for the dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title    the &lt;code&gt;String&lt;/code&gt; to display in the
     *          dialog title bar
     * @param messageType the type of message that is to be displayed:
     *                    ERROR_MESSAGE, INFORMATION_MESSAGE, WARNING_MESSAGE,
     *                    QUESTION_MESSAGE, or PLAIN_MESSAGE
     */
    public static String showInternalInputDialog(Component parentComponent,
                             Object message, String title, int messageType) {
        return (String)showInternalInputDialog(parentComponent, message, title,
                                       messageType, null, null, null);
    }

    /**
     * Prompts the user for input in a blocking internal dialog where
     * the initial selection, possible selections, and all other
     * options can be specified. The user will able to choose from
     * &lt;code&gt;selectionValues&lt;/code&gt;, where &lt;code&gt;null&lt;/code&gt;
     * implies the user can input
     * whatever they wish, usually by means of a &lt;code&gt;JTextField&lt;/code&gt;.
     * &lt;code&gt;initialSelectionValue&lt;/code&gt; is the initial value to prompt
     * the user with. It is up to the UI to decide how best to represent
     * the &lt;code&gt;selectionValues&lt;/code&gt;, but usually a
     * &lt;code&gt;JComboBox&lt;/code&gt;, &lt;code&gt;JList&lt;/code&gt;, or
     * &lt;code&gt;JTextField&lt;/code&gt; will be used.
     *
     * @param parentComponent the parent &lt;code&gt;Component&lt;/code&gt; for the dialog
     * @param message  the &lt;code&gt;Object&lt;/code&gt; to display
     * @param title    the &lt;code&gt;String&lt;/code&gt; to display in the dialog
     *          title bar
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;, &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;, or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param icon     the &lt;code&gt;Icon&lt;/code&gt; image to display
     * @param selectionValues an array of &lt;code&gt;Objects&lt;/code&gt; that
     *                  gives the possible selections
     * @param initialSelectionValue the value used to initialize the input
     *                  field
     * @return user's input, or &lt;code&gt;null&lt;/code&gt; meaning the user
     *          canceled the input
     */
    public static Object showInternalInputDialog(Component parentComponent,
            Object message, String title, int messageType, Icon icon,
            Object[] selectionValues, Object initialSelectionValue) {
        JOptionPane pane = new JOptionPane(message, messageType,
                OK_CANCEL_OPTION, icon, null, null);
        pane.putClientProperty(PopupFactory_FORCE_HEAVYWEIGHT_POPUP,
                Boolean.TRUE);
        Component fo = KeyboardFocusManager.getCurrentKeyboardFocusManager().
                getFocusOwner();

        pane.setWantsInput(true);
        pane.setSelectionValues(selectionValues);
        pane.setInitialSelectionValue(initialSelectionValue);

        JInternalFrame dialog =
            pane.createInternalFrame(parentComponent, title);

        pane.selectInitialValue();
        dialog.setVisible(true);

        /* Since all input will be blocked until this dialog is dismissed,
         * make sure its parent containers are visible first (this component
         * is tested below).  This is necessary for JApplets, because
         * because an applet normally isn't made visible until after its
         * start() method returns -- if this method is called from start(),
         * the applet will appear to hang while an invisible modal frame
         * waits for input.
         */
        if (dialog.isVisible() &amp;&amp; !dialog.isShowing()) {
            Container parent = dialog.getParent();
            while (parent != null) {
                if (parent.isVisible() == false) {
                    parent.setVisible(true);
                }
                parent = parent.getParent();
            }
        }

        // Use reflection to get Container.startLWModal.
        try {
            Method method = AccessController.doPrivileged(new ModalPrivilegedAction(
                    Container.class, &quot;startLWModal&quot;));
            if (method != null) {
                method.invoke(dialog, (Object[])null);
            }
        } catch (IllegalAccessException ex) {
        } catch (IllegalArgumentException ex) {
        } catch (InvocationTargetException ex) {
        }

        if (parentComponent instanceof JInternalFrame) {
            try {
                ((JInternalFrame)parentComponent).setSelected(true);
            } catch (java.beans.PropertyVetoException e) {
            }
        }

        if (fo != null &amp;&amp; fo.isShowing()) {
            fo.requestFocus();
        }
        Object value = pane.getInputValue();

        if (value == UNINITIALIZED_VALUE) {
            return null;
        }
        return value;
    }

    /**
     * Creates and returns an instance of &lt;code&gt;JInternalFrame&lt;/code&gt;.
     * The internal frame is created with the specified title,
     * and wrapping the &lt;code&gt;JOptionPane&lt;/code&gt;.
     * The returned &lt;code&gt;JInternalFrame&lt;/code&gt; is
     * added to the &lt;code&gt;JDesktopPane&lt;/code&gt; ancestor of
     * &lt;code&gt;parentComponent&lt;/code&gt;, or components
     * parent if one its ancestors isn't a &lt;code&gt;JDesktopPane&lt;/code&gt;,
     * or if &lt;code&gt;parentComponent&lt;/code&gt;
     * doesn't have a parent then a &lt;code&gt;RuntimeException&lt;/code&gt; is thrown.
     *
     * @param parentComponent  the parent &lt;code&gt;Component&lt;/code&gt; for
     *          the internal frame
     * @param title    the &lt;code&gt;String&lt;/code&gt; to display in the
     *          frame's title bar
     * @return a &lt;code&gt;JInternalFrame&lt;/code&gt; containing a
     *          &lt;code&gt;JOptionPane&lt;/code&gt;
     * @exception RuntimeException if &lt;code&gt;parentComponent&lt;/code&gt; does
     *          not have a valid parent
     */
    public JInternalFrame createInternalFrame(Component parentComponent,
                                 String title) {
        Container parent =
                JOptionPane.getDesktopPaneForComponent(parentComponent);

        if (parent == null &amp;&amp; (parentComponent == null ||
                (parent = parentComponent.getParent()) == null)) {
            throw new RuntimeException(&quot;JOptionPane: parentComponent does &quot; +
                    &quot;not have a valid parent&quot;);
        }

        // Option dialogs should be closable only
        final JInternalFrame  iFrame = new JInternalFrame(title, false, true,
                                                           false, false);

        iFrame.putClientProperty(&quot;JInternalFrame.frameType&quot;, &quot;optionDialog&quot;);
        iFrame.putClientProperty(&quot;JInternalFrame.messageType&quot;,
                                 Integer.valueOf(getMessageType()));

        iFrame.addInternalFrameListener(new InternalFrameAdapter() {
            public void internalFrameClosing(InternalFrameEvent e) {
                if (getValue() == UNINITIALIZED_VALUE) {
                    setValue(null);
                }
            }
        });
        addPropertyChangeListener(new PropertyChangeListener() {
            public void propertyChange(PropertyChangeEvent event) {
                // Let the defaultCloseOperation handle the closing
                // if the user closed the iframe without selecting a button
                // (newValue = null in that case).  Otherwise, close the dialog.
                if (iFrame.isVisible() &amp;&amp;
                        event.getSource() == JOptionPane.this &amp;&amp;
                        event.getPropertyName().equals(VALUE_PROPERTY)) {
                // Use reflection to get Container.stopLWModal().
                try {
                    Method method = AccessController.doPrivileged(
                        new ModalPrivilegedAction(
                            Container.class, &quot;stopLWModal&quot;));
                    if (method != null) {
                        method.invoke(iFrame, (Object[])null);
                    }
                } catch (IllegalAccessException ex) {
                } catch (IllegalArgumentException ex) {
                } catch (InvocationTargetException ex) {
                }

                try {
                    iFrame.setClosed(true);
                }
                catch (java.beans.PropertyVetoException e) {
                }

                iFrame.setVisible(false);
                }
            }
        });
        iFrame.getContentPane().add(this, BorderLayout.CENTER);
        if (parent instanceof JDesktopPane) {
            parent.add(iFrame, JLayeredPane.MODAL_LAYER);
        } else {
            parent.add(iFrame, BorderLayout.CENTER);
        }
        Dimension iFrameSize = iFrame.getPreferredSize();
        Dimension rootSize = parent.getSize();
        Dimension parentSize = parentComponent.getSize();

        iFrame.setBounds((rootSize.width - iFrameSize.width) / 2,
                         (rootSize.height - iFrameSize.height) / 2,
                         iFrameSize.width, iFrameSize.height);
        // We want dialog centered relative to its parent component
        Point iFrameCoord =
          SwingUtilities.convertPoint(parentComponent, 0, 0, parent);
        int x = (parentSize.width - iFrameSize.width) / 2 + iFrameCoord.x;
        int y = (parentSize.height - iFrameSize.height) / 2 + iFrameCoord.y;

        // If possible, dialog should be fully visible
        int ovrx = x + iFrameSize.width - rootSize.width;
        int ovry = y + iFrameSize.height - rootSize.height;
        x = Math.max((ovrx &gt; 0? x - ovrx: x), 0);
        y = Math.max((ovry &gt; 0? y - ovry: y), 0);
        iFrame.setBounds(x, y, iFrameSize.width, iFrameSize.height);

        parent.validate();
        try {
            iFrame.setSelected(true);
        } catch (java.beans.PropertyVetoException e) {}

        return iFrame;
    }

    /**
     * Returns the specified component's &lt;code&gt;Frame&lt;/code&gt;.
     *
     * @param parentComponent the &lt;code&gt;Component&lt;/code&gt; to check for a
     *          &lt;code&gt;Frame&lt;/code&gt;
     * @return the &lt;code&gt;Frame&lt;/code&gt; that contains the component,
     *          or &lt;code&gt;getRootFrame&lt;/code&gt;
     *          if the component is &lt;code&gt;null&lt;/code&gt;,
     *          or does not have a valid &lt;code&gt;Frame&lt;/code&gt; parent
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see #getRootFrame
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static Frame getFrameForComponent(Component parentComponent)
        throws HeadlessException {
        if (parentComponent == null)
            return getRootFrame();
        if (parentComponent instanceof Frame)
            return (Frame)parentComponent;
        return JOptionPane.getFrameForComponent(parentComponent.getParent());
    }

    /**
     * Returns the specified component's toplevel &lt;code&gt;Frame&lt;/code&gt; or
     * &lt;code&gt;Dialog&lt;/code&gt;.
     *
     * @param parentComponent the &lt;code&gt;Component&lt;/code&gt; to check for a
     *          &lt;code&gt;Frame&lt;/code&gt; or &lt;code&gt;Dialog&lt;/code&gt;
     * @return the &lt;code&gt;Frame&lt;/code&gt; or &lt;code&gt;Dialog&lt;/code&gt; that
     *          contains the component, or the default
     *          frame if the component is &lt;code&gt;null&lt;/code&gt;,
     *          or does not have a valid
     *          &lt;code&gt;Frame&lt;/code&gt; or &lt;code&gt;Dialog&lt;/code&gt; parent
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    static Window getWindowForComponent(Component parentComponent)
        throws HeadlessException {
        if (parentComponent == null)
            return getRootFrame();
        if (parentComponent instanceof Frame || parentComponent instanceof Dialog)
            return (Window)parentComponent;
        return JOptionPane.getWindowForComponent(parentComponent.getParent());
    }


    /**
     * Returns the specified component's desktop pane.
     *
     * @param parentComponent the &lt;code&gt;Component&lt;/code&gt; to check for a
     *          desktop
     * @return the &lt;code&gt;JDesktopPane&lt;/code&gt; that contains the component,
     *          or &lt;code&gt;null&lt;/code&gt; if the component is &lt;code&gt;null&lt;/code&gt;
     *          or does not have an ancestor that is a
     *          &lt;code&gt;JInternalFrame&lt;/code&gt;
     */
    public static JDesktopPane getDesktopPaneForComponent(Component parentComponent) {
        if(parentComponent == null)
            return null;
        if(parentComponent instanceof JDesktopPane)
            return (JDesktopPane)parentComponent;
        return getDesktopPaneForComponent(parentComponent.getParent());
    }

    private static final Object sharedFrameKey = JOptionPane.class;

    /**
     * Sets the frame to use for class methods in which a frame is
     * not provided.
     * &lt;p&gt;
     * &lt;strong&gt;Note:&lt;/strong&gt;
     * It is recommended that rather than using this method you supply a valid parent.
     *
     * @param newRootFrame the default &lt;code&gt;Frame&lt;/code&gt; to use
     */
    public static void setRootFrame(Frame newRootFrame) {
        if (newRootFrame != null) {
            SwingUtilities.appContextPut(sharedFrameKey, newRootFrame);
        } else {
            SwingUtilities.appContextRemove(sharedFrameKey);
        }
    }

    /**
     * Returns the &lt;code&gt;Frame&lt;/code&gt; to use for the class methods in
     * which a frame is not provided.
     *
     * @return the default &lt;code&gt;Frame&lt;/code&gt; to use
     * @exception HeadlessException if
     *   &lt;code&gt;GraphicsEnvironment.isHeadless&lt;/code&gt; returns
     *   &lt;code&gt;true&lt;/code&gt;
     * @see #setRootFrame
     * @see java.awt.GraphicsEnvironment#isHeadless
     */
    public static Frame getRootFrame() throws HeadlessException {
        Frame sharedFrame =
            (Frame)SwingUtilities.appContextGet(sharedFrameKey);
        if (sharedFrame == null) {
            sharedFrame = SwingUtilities.getSharedOwnerFrame();
            SwingUtilities.appContextPut(sharedFrameKey, sharedFrame);
        }
        return sharedFrame;
    }

    /**
     * Creates a &lt;code&gt;JOptionPane&lt;/code&gt; with a test message.
     */
    public JOptionPane() {
        this(&quot;JOptionPane message&quot;);
    }

    /**
     * Creates a instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a
     * message using the
     * plain-message message type and the default options delivered by
     * the UI.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     */
    public JOptionPane(Object message) {
        this(message, PLAIN_MESSAGE);
    }

    /**
     * Creates an instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a message
     * with the specified message type and the default options,
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     */
    public JOptionPane(Object message, int messageType) {
        this(message, messageType, DEFAULT_OPTION);
    }

    /**
     * Creates an instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a message
     * with the specified message type and options.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param optionType the options to display in the pane:
     *                  &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;, &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     */
    public JOptionPane(Object message, int messageType, int optionType) {
        this(message, messageType, optionType, null);
    }

    /**
     * Creates an instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a message
     * with the specified message type, options, and icon.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param optionType the options to display in the pane:
     *                  &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;, &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param icon the &lt;code&gt;Icon&lt;/code&gt; image to display
     */
    public JOptionPane(Object message, int messageType, int optionType,
                       Icon icon) {
        this(message, messageType, optionType, icon, null);
    }

    /**
     * Creates an instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a message
     * with the specified message type, icon, and options.
     * None of the options is initially selected.
     * &lt;p&gt;
     * The options objects should contain either instances of
     * &lt;code&gt;Component&lt;/code&gt;s, (which are added directly) or
     * &lt;code&gt;Strings&lt;/code&gt; (which are wrapped in a &lt;code&gt;JButton&lt;/code&gt;).
     * If you provide &lt;code&gt;Component&lt;/code&gt;s, you must ensure that when the
     * &lt;code&gt;Component&lt;/code&gt; is clicked it messages &lt;code&gt;setValue&lt;/code&gt;
     * in the created &lt;code&gt;JOptionPane&lt;/code&gt;.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param optionType the options to display in the pane:
     *                  &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param icon the &lt;code&gt;Icon&lt;/code&gt; image to display
     * @param options  the choices the user can select
     */
    public JOptionPane(Object message, int messageType, int optionType,
                       Icon icon, Object[] options) {
        this(message, messageType, optionType, icon, options, null);
    }

    /**
     * Creates an instance of &lt;code&gt;JOptionPane&lt;/code&gt; to display a message
     * with the specified message type, icon, and options, with the
     * initially-selected option specified.
     *
     * @param message the &lt;code&gt;Object&lt;/code&gt; to display
     * @param messageType the type of message to be displayed:
     *                  &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                  &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;,
     *                  or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @param optionType the options to display in the pane:
     *                  &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @param icon the Icon image to display
     * @param options  the choices the user can select
     * @param initialValue the choice that is initially selected; if
     *                  &lt;code&gt;null&lt;/code&gt;, then nothing will be initially selected;
     *                  only meaningful if &lt;code&gt;options&lt;/code&gt; is used
     */
    public JOptionPane(Object message, int messageType, int optionType,
                       Icon icon, Object[] options, Object initialValue) {

        this.message = message;
        this.options = options;
        this.initialValue = initialValue;
        this.icon = icon;
        setMessageType(messageType);
        setOptionType(optionType);
        value = UNINITIALIZED_VALUE;
        inputValue = UNINITIALIZED_VALUE;
        updateUI();
    }

    /**
     * Sets the UI object which implements the {@literal L&amp;F} for this component.
     *
     * @param ui  the &lt;code&gt;OptionPaneUI&lt;/code&gt; {@literal L&amp;F} object
     * @see UIDefaults#getUI
     * @beaninfo
     *       bound: true
     *      hidden: true
     * description: The UI object that implements the optionpane's LookAndFeel
     */
    public void setUI(OptionPaneUI ui) {
        if (this.ui != ui) {
            super.setUI(ui);
            invalidate();
        }
    }

    /**
     * Returns the UI object which implements the {@literal L&amp;F} for this component.
     *
     * @return the &lt;code&gt;OptionPaneUI&lt;/code&gt; object
     */
    public OptionPaneUI getUI() {
        return (OptionPaneUI)ui;
    }

    /**
     * Notification from the &lt;code&gt;UIManager&lt;/code&gt; that the {@literal L&amp;F} has changed.
     * Replaces the current UI object with the latest version from the
     * &lt;code&gt;UIManager&lt;/code&gt;.
     *
     * @see JComponent#updateUI
     */
    public void updateUI() {
        setUI((OptionPaneUI)UIManager.getUI(this));
    }


    /**
     * Returns the name of the UI class that implements the
     * {@literal L&amp;F} for this component.
     *
     * @return the string &quot;OptionPaneUI&quot;
     * @see JComponent#getUIClassID
     * @see UIDefaults#getUI
     */
    public String getUIClassID() {
        return uiClassID;
    }


    /**
     * Sets the option pane's message-object.
     * @param newMessage the &lt;code&gt;Object&lt;/code&gt; to display
     * @see #getMessage
     *
     * @beaninfo
     *   preferred: true
     *   bound: true
     * description: The optionpane's message object.
     */
    public void setMessage(Object newMessage) {
        Object           oldMessage = message;

        message = newMessage;
        firePropertyChange(MESSAGE_PROPERTY, oldMessage, message);
    }

    /**
     * Returns the message-object this pane displays.
     * @see #setMessage
     *
     * @return the &lt;code&gt;Object&lt;/code&gt; that is displayed
     */
    public Object getMessage() {
        return message;
    }

    /**
     * Sets the icon to display. If non-&lt;code&gt;null&lt;/code&gt;, the look and feel
     * does not provide an icon.
     * @param newIcon the &lt;code&gt;Icon&lt;/code&gt; to display
     *
     * @see #getIcon
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's type icon.
     */
    public void setIcon(Icon newIcon) {
        Object              oldIcon = icon;

        icon = newIcon;
        firePropertyChange(ICON_PROPERTY, oldIcon, icon);
    }

    /**
     * Returns the icon this pane displays.
     * @return the &lt;code&gt;Icon&lt;/code&gt; that is displayed
     *
     * @see #setIcon
     */
    public Icon getIcon() {
        return icon;
    }

    /**
     * Sets the value the user has chosen.
     * @param newValue  the chosen value
     *
     * @see #getValue
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's value object.
     */
    public void setValue(Object newValue) {
        Object               oldValue = value;

        value = newValue;
        firePropertyChange(VALUE_PROPERTY, oldValue, value);
    }

    /**
     * Returns the value the user has selected. &lt;code&gt;UNINITIALIZED_VALUE&lt;/code&gt;
     * implies the user has not yet made a choice, &lt;code&gt;null&lt;/code&gt; means the
     * user closed the window with out choosing anything. Otherwise
     * the returned value will be one of the options defined in this
     * object.
     *
     * @return the &lt;code&gt;Object&lt;/code&gt; chosen by the user,
     *         &lt;code&gt;UNINITIALIZED_VALUE&lt;/code&gt;
     *         if the user has not yet made a choice, or &lt;code&gt;null&lt;/code&gt; if
     *         the user closed the window without making a choice
     *
     * @see #setValue
     */
    public Object getValue() {
        return value;
    }

    /**
     * Sets the options this pane displays. If an element in
     * &lt;code&gt;newOptions&lt;/code&gt; is a &lt;code&gt;Component&lt;/code&gt;
     * it is added directly to the pane,
     * otherwise a button is created for the element.
     *
     * @param newOptions an array of &lt;code&gt;Objects&lt;/code&gt; that create the
     *          buttons the user can click on, or arbitrary
     *          &lt;code&gt;Components&lt;/code&gt; to add to the pane
     *
     * @see #getOptions
     * @beaninfo
     *       bound: true
     * description: The option pane's options objects.
     */
    public void setOptions(Object[] newOptions) {
        Object[]           oldOptions = options;

        options = newOptions;
        firePropertyChange(OPTIONS_PROPERTY, oldOptions, options);
    }

    /**
     * Returns the choices the user can make.
     * @return the array of &lt;code&gt;Objects&lt;/code&gt; that give the user's choices
     *
     * @see #setOptions
     */
    public Object[] getOptions() {
        if(options != null) {
            int             optionCount = options.length;
            Object[]        retOptions = new Object[optionCount];

            System.arraycopy(options, 0, retOptions, 0, optionCount);
            return retOptions;
        }
        return options;
    }

    /**
     * Sets the initial value that is to be enabled -- the
     * &lt;code&gt;Component&lt;/code&gt;
     * that has the focus when the pane is initially displayed.
     *
     * @param newInitialValue the &lt;code&gt;Object&lt;/code&gt; that gets the initial
     *                         keyboard focus
     *
     * @see #getInitialValue
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's initial value object.
     */
    public void setInitialValue(Object newInitialValue) {
        Object            oldIV = initialValue;

        initialValue = newInitialValue;
        firePropertyChange(INITIAL_VALUE_PROPERTY, oldIV, initialValue);
    }

    /**
     * Returns the initial value.
     *
     * @return the &lt;code&gt;Object&lt;/code&gt; that gets the initial keyboard focus
     *
     * @see #setInitialValue
     */
    public Object getInitialValue() {
        return initialValue;
    }

    /**
     * Sets the option pane's message type.
     * The message type is used by the Look and Feel to determine the
     * icon to display (if not supplied) as well as potentially how to
     * lay out the &lt;code&gt;parentComponent&lt;/code&gt;.
     * @param newType an integer specifying the kind of message to display:
     *                &lt;code&gt;ERROR_MESSAGE&lt;/code&gt;, &lt;code&gt;INFORMATION_MESSAGE&lt;/code&gt;,
     *                &lt;code&gt;WARNING_MESSAGE&lt;/code&gt;,
     *                &lt;code&gt;QUESTION_MESSAGE&lt;/code&gt;, or &lt;code&gt;PLAIN_MESSAGE&lt;/code&gt;
     * @exception RuntimeException if &lt;code&gt;newType&lt;/code&gt; is not one of the
     *          legal values listed above

     * @see #getMessageType
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's message type.
     */
    public void setMessageType(int newType) {
        if(newType != ERROR_MESSAGE &amp;&amp; newType != INFORMATION_MESSAGE &amp;&amp;
           newType != WARNING_MESSAGE &amp;&amp; newType != QUESTION_MESSAGE &amp;&amp;
           newType != PLAIN_MESSAGE)
            throw new RuntimeException(&quot;JOptionPane: type must be one of JOptionPane.ERROR_MESSAGE, JOptionPane.INFORMATION_MESSAGE, JOptionPane.WARNING_MESSAGE, JOptionPane.QUESTION_MESSAGE or JOptionPane.PLAIN_MESSAGE&quot;);

        int           oldType = messageType;

        messageType = newType;
        firePropertyChange(MESSAGE_TYPE_PROPERTY, oldType, messageType);
    }

    /**
     * Returns the message type.
     *
     * @return an integer specifying the message type
     *
     * @see #setMessageType
     */
    public int getMessageType() {
        return messageType;
    }

    /**
     * Sets the options to display.
     * The option type is used by the Look and Feel to
     * determine what buttons to show (unless options are supplied).
     * @param newType an integer specifying the options the {@literal L&amp;F} is to display:
     *                  &lt;code&gt;DEFAULT_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_OPTION&lt;/code&gt;,
     *                  &lt;code&gt;YES_NO_CANCEL_OPTION&lt;/code&gt;,
     *                  or &lt;code&gt;OK_CANCEL_OPTION&lt;/code&gt;
     * @exception RuntimeException if &lt;code&gt;newType&lt;/code&gt; is not one of
     *          the legal values listed above
     *
     * @see #getOptionType
     * @see #setOptions
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's option type.
      */
    public void setOptionType(int newType) {
        if(newType != DEFAULT_OPTION &amp;&amp; newType != YES_NO_OPTION &amp;&amp;
           newType != YES_NO_CANCEL_OPTION &amp;&amp; newType != OK_CANCEL_OPTION)
            throw new RuntimeException(&quot;JOptionPane: option type must be one of JOptionPane.DEFAULT_OPTION, JOptionPane.YES_NO_OPTION, JOptionPane.YES_NO_CANCEL_OPTION or JOptionPane.OK_CANCEL_OPTION&quot;);

        int            oldType = optionType;

        optionType = newType;
        firePropertyChange(OPTION_TYPE_PROPERTY, oldType, optionType);
    }

    /**
     * Returns the type of options that are displayed.
     *
     * @return an integer specifying the user-selectable options
     *
     * @see #setOptionType
     */
    public int getOptionType() {
        return optionType;
    }

    /**
     * Sets the input selection values for a pane that provides the user
     * with a list of items to choose from. (The UI provides a widget
     * for choosing one of the values.)  A &lt;code&gt;null&lt;/code&gt; value
     * implies the user can input whatever they wish, usually by means
     * of a &lt;code&gt;JTextField&lt;/code&gt;.
     * &lt;p&gt;
     * Sets &lt;code&gt;wantsInput&lt;/code&gt; to true. Use
     * &lt;code&gt;setInitialSelectionValue&lt;/code&gt; to specify the initially-chosen
     * value. After the pane as been enabled, &lt;code&gt;inputValue&lt;/code&gt; is
     * set to the value the user has selected.
     * @param newValues an array of &lt;code&gt;Objects&lt;/code&gt; the user to be
     *                  displayed
     *                  (usually in a list or combo-box) from which
     *                  the user can make a selection
     * @see #setWantsInput
     * @see #setInitialSelectionValue
     * @see #getSelectionValues
     * @beaninfo
     *       bound: true
     * description: The option pane's selection values.
     */
    public void setSelectionValues(Object[] newValues) {
        Object[]           oldValues = selectionValues;

        selectionValues = newValues;
        firePropertyChange(SELECTION_VALUES_PROPERTY, oldValues, newValues);
        if(selectionValues != null)
            setWantsInput(true);
    }

    /**
     * Returns the input selection values.
     *
     * @return the array of &lt;code&gt;Objects&lt;/code&gt; the user can select
     * @see #setSelectionValues
     */
    public Object[] getSelectionValues() {
        return selectionValues;
    }

    /**
     * Sets the input value that is initially displayed as selected to the user.
     * Only used if &lt;code&gt;wantsInput&lt;/code&gt; is true.
     * @param newValue the initially selected value
     * @see #setSelectionValues
     * @see #getInitialSelectionValue
     * @beaninfo
     *       bound: true
     * description: The option pane's initial selection value object.
     */
    public void setInitialSelectionValue(Object newValue) {
        Object          oldValue = initialSelectionValue;

        initialSelectionValue = newValue;
        firePropertyChange(INITIAL_SELECTION_VALUE_PROPERTY, oldValue,
                           newValue);
    }

    /**
     * Returns the input value that is displayed as initially selected to the user.
     *
     * @return the initially selected value
     * @see #setInitialSelectionValue
     * @see #setSelectionValues
     */
    public Object getInitialSelectionValue() {
        return initialSelectionValue;
    }

    /**
     * Sets the input value that was selected or input by the user.
     * Only used if &lt;code&gt;wantsInput&lt;/code&gt; is true.  Note that this method
     * is invoked internally by the option pane (in response to user action)
     * and should generally not be called by client programs.  To set the
     * input value initially displayed as selected to the user, use
     * &lt;code&gt;setInitialSelectionValue&lt;/code&gt;.
     *
     * @param newValue the &lt;code&gt;Object&lt;/code&gt; used to set the
     *          value that the user specified (usually in a text field)
     * @see #setSelectionValues
     * @see #setInitialSelectionValue
     * @see #setWantsInput
     * @see #getInputValue
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: The option pane's input value object.
     */
    public void setInputValue(Object newValue) {
        Object              oldValue = inputValue;

        inputValue = newValue;
        firePropertyChange(INPUT_VALUE_PROPERTY, oldValue, newValue);
    }

    /**
     * Returns the value the user has input, if &lt;code&gt;wantsInput&lt;/code&gt;
     * is true.
     *
     * @return the &lt;code&gt;Object&lt;/code&gt; the user specified,
     *          if it was one of the objects, or a
     *          &lt;code&gt;String&lt;/code&gt; if it was a value typed into a
     *          field
     * @see #setSelectionValues
     * @see #setWantsInput
     * @see #setInputValue
     */
    public Object getInputValue() {
        return inputValue;
    }

    /**
     * Returns the maximum number of characters to place on a line in a
     * message. Default is to return &lt;code&gt;Integer.MAX_VALUE&lt;/code&gt;.
     * The value can be
     * changed by overriding this method in a subclass.
     *
     * @return an integer giving the maximum number of characters on a line
     */
    public int getMaxCharactersPerLineCount() {
        return Integer.MAX_VALUE;
    }

    /**
     * Sets the &lt;code&gt;wantsInput&lt;/code&gt; property.
     * If &lt;code&gt;newValue&lt;/code&gt; is true, an input component
     * (such as a text field or combo box) whose parent is
     * &lt;code&gt;parentComponent&lt;/code&gt; is provided to
     * allow the user to input a value. If &lt;code&gt;getSelectionValues&lt;/code&gt;
     * returns a non-&lt;code&gt;null&lt;/code&gt; array, the input value is one of the
     * objects in that array. Otherwise the input value is whatever
     * the user inputs.
     * &lt;p&gt;
     * This is a bound property.
     *
     * @see #setSelectionValues
     * @see #setInputValue
     * @beaninfo
     *   preferred: true
     *       bound: true
     * description: Flag which allows the user to input a value.
     */
    public void setWantsInput(boolean newValue) {
        boolean            oldValue = wantsInput;

        wantsInput = newValue;
        firePropertyChange(WANTS_INPUT_PROPERTY, oldValue, newValue);
    }

    /**
     * Returns the value of the &lt;code&gt;wantsInput&lt;/code&gt; property.
     *
     * @return true if an input component will be provided
     * @see #setWantsInput
     */
    public boolean getWantsInput() {
        return wantsInput;
    }

    /**
     * Requests that the initial value be selected, which will set
     * focus to the initial value. This method
     * should be invoked after the window containing the option pane
     * is made visible.
     */
    public void selectInitialValue() {
        OptionPaneUI         ui = getUI();
        if (ui != null) {
            ui.selectInitialValue(this);
        }
    }


    private static int styleFromMessageType(int messageType) {
        switch (messageType) {
        case ERROR_MESSAGE:
            return JRootPane.ERROR_DIALOG;
        case QUESTION_MESSAGE:
            return JRootPane.QUESTION_DIALOG;
        case WARNING_MESSAGE:
            return JRootPane.WARNING_DIALOG;
        case INFORMATION_MESSAGE:
            return JRootPane.INFORMATION_DIALOG;
        case PLAIN_MESSAGE:
        default:
            return JRootPane.PLAIN_DIALOG;
        }
    }

    // Serialization support.
    private void writeObject(ObjectOutputStream s) throws IOException {
        Vector&lt;Object&gt; values = new Vector&lt;Object&gt;();

        s.defaultWriteObject();
        // Save the icon, if its Serializable.
        if(icon != null &amp;&amp; icon instanceof Serializable) {
            values.addElement(&quot;icon&quot;);
            values.addElement(icon);
        }
        // Save the message, if its Serializable.
        if(message != null &amp;&amp; message instanceof Serializable) {
            values.addElement(&quot;message&quot;);
            values.addElement(message);
        }
        // Save the treeModel, if its Serializable.
        if(options != null) {
            Vector&lt;Object&gt; serOptions = new Vector&lt;Object&gt;();

            for(int counter = 0, maxCounter = options.length;
                counter &lt; maxCounter; counter++)
                if(options[counter] instanceof Serializable)
                    serOptions.addElement(options[counter]);
            if(serOptions.size() &gt; 0) {
                int             optionCount = serOptions.size();
                Object[]        arrayOptions = new Object[optionCount];

                serOptions.copyInto(arrayOptions);
                values.addElement(&quot;options&quot;);
                values.addElement(arrayOptions);
            }
        }
        // Save the initialValue, if its Serializable.
        if(initialValue != null &amp;&amp; initialValue instanceof Serializable) {
            values.addElement(&quot;initialValue&quot;);
            values.addElement(initialValue);
        }
        // Save the value, if its Serializable.
        if(value != null &amp;&amp; value instanceof Serializable) {
            values.addElement(&quot;value&quot;);
            values.addElement(value);
        }
        // Save the selectionValues, if its Serializable.
        if(selectionValues != null) {
            boolean            serialize = true;

            for(int counter = 0, maxCounter = selectionValues.length;
                counter &lt; maxCounter; counter++) {
                if(selectionValues[counter] != null &amp;&amp;
                   !(selectionValues[counter] instanceof Serializable)) {
                    serialize = false;
                    break;
                }
            }
            if(serialize) {
                values.addElement(&quot;selectionValues&quot;);
                values.addElement(selectionValues);
            }
        }
        // Save the inputValue, if its Serializable.
        if(inputValue != null &amp;&amp; inputValue instanceof Serializable) {
            values.addElement(&quot;inputValue&quot;);
            values.addElement(inputValue);
        }
        // Save the initialSelectionValue, if its Serializable.
        if(initialSelectionValue != null &amp;&amp;
           initialSelectionValue instanceof Serializable) {
            values.addElement(&quot;initialSelectionValue&quot;);
            values.addElement(initialSelectionValue);
        }
        s.writeObject(values);
    }

    private void readObject(ObjectInputStream s)
        throws IOException, ClassNotFoundException {
        s.defaultReadObject();

        Vector          values = (Vector)s.readObject();
        int             indexCounter = 0;
        int             maxCounter = values.size();

        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;icon&quot;)) {
            icon = (Icon)values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;message&quot;)) {
            message = values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;options&quot;)) {
            options = (Object[])values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;initialValue&quot;)) {
            initialValue = values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;value&quot;)) {
            value = values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;selectionValues&quot;)) {
            selectionValues = (Object[])values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;inputValue&quot;)) {
            inputValue = values.elementAt(++indexCounter);
            indexCounter++;
        }
        if(indexCounter &lt; maxCounter &amp;&amp; values.elementAt(indexCounter).
           equals(&quot;initialSelectionValue&quot;)) {
            initialSelectionValue = values.elementAt(++indexCounter);
            indexCounter++;
        }
        if (getUIClassID().equals(uiClassID)) {
            byte count = JComponent.getWriteObjCounter(this);
            JComponent.setWriteObjCounter(this, --count);
            if (count == 0 &amp;&amp; ui != null) {
                ui.installUI(this);
            }
        }
    }


    /**
     * Returns a string representation of this &lt;code&gt;JOptionPane&lt;/code&gt;.
     * This method
     * is intended to be used only for debugging purposes, and the
     * content and format of the returned string may vary between
     * implementations. The returned string may be empty but may not
     * be &lt;code&gt;null&lt;/code&gt;.
     *
     * @return  a string representation of this &lt;code&gt;JOptionPane&lt;/code&gt;
     */
    protected String paramString() {
        String iconString = (icon != null ?
                             icon.toString() : &quot;&quot;);
        String initialValueString = (initialValue != null ?
                                     initialValue.toString() : &quot;&quot;);
        String messageString = (message != null ?
                                message.toString() : &quot;&quot;);
        String messageTypeString;
        if (messageType == ERROR_MESSAGE) {
            messageTypeString = &quot;ERROR_MESSAGE&quot;;
        } else if (messageType == INFORMATION_MESSAGE) {
            messageTypeString = &quot;INFORMATION_MESSAGE&quot;;
        } else if (messageType == WARNING_MESSAGE) {
            messageTypeString = &quot;WARNING_MESSAGE&quot;;
        } else if (messageType == QUESTION_MESSAGE) {
            messageTypeString = &quot;QUESTION_MESSAGE&quot;;
        } else if (messageType == PLAIN_MESSAGE)  {
            messageTypeString = &quot;PLAIN_MESSAGE&quot;;
        } else messageTypeString = &quot;&quot;;
        String optionTypeString;
        if (optionType == DEFAULT_OPTION) {
            optionTypeString = &quot;DEFAULT_OPTION&quot;;
        } else if (optionType == YES_NO_OPTION) {
            optionTypeString = &quot;YES_NO_OPTION&quot;;
        } else if (optionType == YES_NO_CANCEL_OPTION) {
            optionTypeString = &quot;YES_NO_CANCEL_OPTION&quot;;
        } else if (optionType == OK_CANCEL_OPTION) {
            optionTypeString = &quot;OK_CANCEL_OPTION&quot;;
        } else optionTypeString = &quot;&quot;;
        String wantsInputString = (wantsInput ?
                                   &quot;true&quot; : &quot;false&quot;);

        return super.paramString() +
        &quot;,icon=&quot; + iconString +
        &quot;,initialValue=&quot; + initialValueString +
        &quot;,message=&quot; + messageString +
        &quot;,messageType=&quot; + messageTypeString +
        &quot;,optionType=&quot; + optionTypeString +
        &quot;,wantsInput=&quot; + wantsInputString;
    }

    /**
     * Retrieves a method from the provided class and makes it accessible.
     */
    private static class ModalPrivilegedAction implements PrivilegedAction&lt;Method&gt; {
        private Class&lt;?&gt; clazz;
        private String methodName;

        public ModalPrivilegedAction(Class&lt;?&gt; clazz, String methodName) {
            this.clazz = clazz;
            this.methodName = methodName;
        }

        public Method run() {
            Method method = null;
            try {
                method = clazz.getDeclaredMethod(methodName, (Class[])null);
            } catch (NoSuchMethodException ex) {
            }
            if (method != null) {
                method.setAccessible(true);
            }
            return method;
        }
    }



///////////////////
// Accessibility support
///////////////////

    /**
     * Returns the &lt;code&gt;AccessibleContext&lt;/code&gt; associated with this JOptionPane.
     * For option panes, the &lt;code&gt;AccessibleContext&lt;/code&gt; takes the form of an
     * &lt;code&gt;AccessibleJOptionPane&lt;/code&gt;.
     * A new &lt;code&gt;AccessibleJOptionPane&lt;/code&gt; instance is created if necessary.
     *
     * @return an AccessibleJOptionPane that serves as the
     *         AccessibleContext of this AccessibleJOptionPane
     * @beaninfo
     *       expert: true
     *  description: The AccessibleContext associated with this option pane
     */
    public AccessibleContext getAccessibleContext() {
        if (accessibleContext == null) {
            accessibleContext = new AccessibleJOptionPane();
        }
        return accessibleContext;
    }

    /**
     * This class implements accessibility support for the
     * &lt;code&gt;JOptionPane&lt;/code&gt; class.  It provides an implementation of the
     * Java Accessibility API appropriate to option pane user-interface
     * elements.
     * &lt;p&gt;
     * &lt;strong&gt;Warning:&lt;/strong&gt;
     * Serialized objects of this class will not be compatible with
     * future Swing releases. The current serialization support is
     * appropriate for short term storage or RMI between applications running
     * the same version of Swing.  As of 1.4, support for long term storage
     * of all JavaBeans&amp;trade;
     * has been added to the &lt;code&gt;java.beans&lt;/code&gt; package.
     * Please see {@link java.beans.XMLEncoder}.
     */
    protected class AccessibleJOptionPane extends AccessibleJComponent {

        /**
         * Get the role of this object.
         *
         * @return an instance of AccessibleRole describing the role of the object
         * @see AccessibleRole
         */
        public AccessibleRole getAccessibleRole() {
            switch (messageType) {
            case ERROR_MESSAGE:
            case INFORMATION_MESSAGE:
            case WARNING_MESSAGE:
                return AccessibleRole.ALERT;

            default:
                return AccessibleRole.OPTION_PANE;
            }
        }

    } // inner class AccessibleJOptionPane
}
</pre>
</body>
</html>
