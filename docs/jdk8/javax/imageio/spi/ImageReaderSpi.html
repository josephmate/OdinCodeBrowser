<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
    </head>
<body>
<pre class="code">
/*
 * Copyright (c) 1999, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

package javax.imageio.spi;

import java.io.IOException;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;

/**
 * The service provider interface (SPI) for &lt;code&gt;ImageReader&lt;/code&gt;s.
 * For more information on service provider classes, see the class comment
 * for the &lt;code&gt;IIORegistry&lt;/code&gt; class.
 *
 * &lt;p&gt; Each &lt;code&gt;ImageReaderSpi&lt;/code&gt; provides several types of information
 * about the &lt;code&gt;ImageReader&lt;/code&gt; class with which it is associated.
 *
 * &lt;p&gt; The name of the vendor who defined the SPI class and a
 * brief description of the class are available via the
 * &lt;code&gt;getVendorName&lt;/code&gt;, &lt;code&gt;getDescription&lt;/code&gt;,
 * and &lt;code&gt;getVersion&lt;/code&gt; methods.
 * These methods may be internationalized to provide locale-specific
 * output.  These methods are intended mainly to provide short,
 * human-readable information that might be used to organize a pop-up
 * menu or other list.
 *
 * &lt;p&gt; Lists of format names, file suffixes, and MIME types associated
 * with the service may be obtained by means of the
 * &lt;code&gt;getFormatNames&lt;/code&gt;, &lt;code&gt;getFileSuffixes&lt;/code&gt;, and
 * &lt;code&gt;getMIMETypes&lt;/code&gt; methods.  These methods may be used to
 * identify candidate &lt;code&gt;ImageReader&lt;/code&gt;s for decoding a
 * particular file or stream based on manual format selection, file
 * naming, or MIME associations (for example, when accessing a file
 * over HTTP or as an email attachment).
 *
 * &lt;p&gt; A more reliable way to determine which &lt;code&gt;ImageReader&lt;/code&gt;s
 * are likely to be able to parse a particular data stream is provided
 * by the &lt;code&gt;canDecodeInput&lt;/code&gt; method.  This methods allows the
 * service provider to inspect the actual stream contents.
 *
 * &lt;p&gt; Finally, an instance of the &lt;code&gt;ImageReader&lt;/code&gt; class
 * associated with this service provider may be obtained by calling
 * the &lt;code&gt;createReaderInstance&lt;/code&gt; method.  Any heavyweight
 * initialization, such as the loading of native libraries or creation
 * of large tables, should be deferred at least until the first
 * invocation of this method.
 *
 * @see IIORegistry
 * @see javax.imageio.ImageReader
 *
 */
public abstract class ImageReaderSpi extends ImageReaderWriterSpi {

    /**
     * A single-element array, initially containing
     * &lt;code&gt;ImageInputStream.class&lt;/code&gt;, to be returned from
     * &lt;code&gt;getInputTypes&lt;/code&gt;.
     * @deprecated Instead of using this field, directly create
     * the equivalent array &lt;code&gt;{ ImageInputStream.class }&lt;/code&gt;.
     */
    @Deprecated
    public static final Class[] STANDARD_INPUT_TYPE =
        { ImageInputStream.class };

    /**
     * An array of &lt;code&gt;Class&lt;/code&gt; objects to be returned from
     * &lt;code&gt;getInputTypes&lt;/code&gt;, initially &lt;code&gt;null&lt;/code&gt;.
     */
    protected Class[] inputTypes = null;

    /**
     * An array of strings to be returned from
     * &lt;code&gt;getImageWriterSpiNames&lt;/code&gt;, initially
     * &lt;code&gt;null&lt;/code&gt;.
     */
    protected String[] writerSpiNames = null;

    /**
     * The &lt;code&gt;Class&lt;/code&gt; of the reader, initially
     * &lt;code&gt;null&lt;/code&gt;.
     */
    private Class readerClass = null;

    /**
     * Constructs a blank &lt;code&gt;ImageReaderSpi&lt;/code&gt;.  It is up to
     * the subclass to initialize instance variables and/or override
     * method implementations in order to provide working versions of
     * all methods.
     */
    protected ImageReaderSpi() {
    }

    /**
     * Constructs an &lt;code&gt;ImageReaderSpi&lt;/code&gt; with a given
     * set of values.
     *
     * @param vendorName the vendor name, as a non-&lt;code&gt;null&lt;/code&gt;
     * &lt;code&gt;String&lt;/code&gt;.
     * @param version a version identifier, as a non-&lt;code&gt;null&lt;/code&gt;
     * &lt;code&gt;String&lt;/code&gt;.
     * @param names a non-&lt;code&gt;null&lt;/code&gt; array of
     * &lt;code&gt;String&lt;/code&gt;s indicating the format names.  At least one
     * entry must be present.
     * @param suffixes an array of &lt;code&gt;String&lt;/code&gt;s indicating the
     * common file suffixes.  If no suffixes are defined,
     * &lt;code&gt;null&lt;/code&gt; should be supplied.  An array of length 0
     * will be normalized to &lt;code&gt;null&lt;/code&gt;.
     * @param MIMETypes an array of &lt;code&gt;String&lt;/code&gt;s indicating
     * the format's MIME types.  If no MIME types are defined,
     * &lt;code&gt;null&lt;/code&gt; should be supplied.  An array of length 0
     * will be normalized to &lt;code&gt;null&lt;/code&gt;.
     * @param readerClassName the fully-qualified name of the
     * associated &lt;code&gt;ImageReader&lt;/code&gt; class, as a
     * non-&lt;code&gt;null&lt;/code&gt; &lt;code&gt;String&lt;/code&gt;.
     * @param inputTypes a non-&lt;code&gt;null&lt;/code&gt; array of
     * &lt;code&gt;Class&lt;/code&gt; objects of length at least 1 indicating the
     * legal input types.
     * @param writerSpiNames an array &lt;code&gt;String&lt;/code&gt;s naming the
     * classes of all associated &lt;code&gt;ImageWriter&lt;/code&gt;s, or
     * &lt;code&gt;null&lt;/code&gt;.  An array of length 0 is normalized to
     * &lt;code&gt;null&lt;/code&gt;.
     * @param supportsStandardStreamMetadataFormat a
     * &lt;code&gt;boolean&lt;/code&gt; that indicates whether a stream metadata
     * object can use trees described by the standard metadata format.
     * @param nativeStreamMetadataFormatName a
     * &lt;code&gt;String&lt;/code&gt;, or &lt;code&gt;null&lt;/code&gt;, to be returned from
     * &lt;code&gt;getNativeStreamMetadataFormatName&lt;/code&gt;.
     * @param nativeStreamMetadataFormatClassName a
     * &lt;code&gt;String&lt;/code&gt;, or &lt;code&gt;null&lt;/code&gt;, to be used to instantiate
     * a metadata format object to be returned from
     * &lt;code&gt;getNativeStreamMetadataFormat&lt;/code&gt;.
     * @param extraStreamMetadataFormatNames an array of
     * &lt;code&gt;String&lt;/code&gt;s, or &lt;code&gt;null&lt;/code&gt;, to be returned from
     * &lt;code&gt;getExtraStreamMetadataFormatNames&lt;/code&gt;.  An array of length
     * 0 is normalized to &lt;code&gt;null&lt;/code&gt;.
     * @param extraStreamMetadataFormatClassNames an array of
     * &lt;code&gt;String&lt;/code&gt;s, or &lt;code&gt;null&lt;/code&gt;, to be used to instantiate
     * a metadata format object to be returned from
     * &lt;code&gt;getStreamMetadataFormat&lt;/code&gt;.  An array of length
     * 0 is normalized to &lt;code&gt;null&lt;/code&gt;.
     * @param supportsStandardImageMetadataFormat a
     * &lt;code&gt;boolean&lt;/code&gt; that indicates whether an image metadata
     * object can use trees described by the standard metadata format.
     * @param nativeImageMetadataFormatName a
     * &lt;code&gt;String&lt;/code&gt;, or &lt;code&gt;null&lt;/code&gt;, to be returned from
     * &lt;code&gt;getNativeImageMetadataFormatName&lt;/code&gt;.
     * @param nativeImageMetadataFormatClassName a
     * &lt;code&gt;String&lt;/code&gt;, or &lt;code&gt;null&lt;/code&gt;, to be used to instantiate
     * a metadata format object to be returned from
     * &lt;code&gt;getNativeImageMetadataFormat&lt;/code&gt;.
     * @param extraImageMetadataFormatNames an array of
     * &lt;code&gt;String&lt;/code&gt;s to be returned from
     * &lt;code&gt;getExtraImageMetadataFormatNames&lt;/code&gt;.  An array of length 0
     * is normalized to &lt;code&gt;null&lt;/code&gt;.
     * @param extraImageMetadataFormatClassNames an array of
     * &lt;code&gt;String&lt;/code&gt;s, or &lt;code&gt;null&lt;/code&gt;, to be used to instantiate
     * a metadata format object to be returned from
     * &lt;code&gt;getImageMetadataFormat&lt;/code&gt;.  An array of length
     * 0 is normalized to &lt;code&gt;null&lt;/code&gt;.
     *
     * @exception IllegalArgumentException if &lt;code&gt;vendorName&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt;.
     * @exception IllegalArgumentException if &lt;code&gt;version&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt;.
     * @exception IllegalArgumentException if &lt;code&gt;names&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt; or has length 0.
     * @exception IllegalArgumentException if &lt;code&gt;readerClassName&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt;.
     * @exception IllegalArgumentException if &lt;code&gt;inputTypes&lt;/code&gt;
     * is &lt;code&gt;null&lt;/code&gt; or has length 0.
     */
    public ImageReaderSpi(String vendorName,
                          String version,
                          String[] names,
                          String[] suffixes,
                          String[] MIMETypes,
                          String readerClassName,
                          Class[] inputTypes,
                          String[] writerSpiNames,
                          boolean supportsStandardStreamMetadataFormat,
                          String nativeStreamMetadataFormatName,
                          String nativeStreamMetadataFormatClassName,
                          String[] extraStreamMetadataFormatNames,
                          String[] extraStreamMetadataFormatClassNames,
                          boolean supportsStandardImageMetadataFormat,
                          String nativeImageMetadataFormatName,
                          String nativeImageMetadataFormatClassName,
                          String[] extraImageMetadataFormatNames,
                          String[] extraImageMetadataFormatClassNames) {
        super(vendorName, version,
              names, suffixes, MIMETypes, readerClassName,
              supportsStandardStreamMetadataFormat,
              nativeStreamMetadataFormatName,
              nativeStreamMetadataFormatClassName,
              extraStreamMetadataFormatNames,
              extraStreamMetadataFormatClassNames,
              supportsStandardImageMetadataFormat,
              nativeImageMetadataFormatName,
              nativeImageMetadataFormatClassName,
              extraImageMetadataFormatNames,
              extraImageMetadataFormatClassNames);

        if (inputTypes == null) {
            throw new IllegalArgumentException
                (&quot;inputTypes == null!&quot;);
        }
        if (inputTypes.length == 0) {
            throw new IllegalArgumentException
                (&quot;inputTypes.length == 0!&quot;);
        }

        this.inputTypes = (inputTypes == STANDARD_INPUT_TYPE) ?
            new Class&lt;?&gt;[] { ImageInputStream.class } :
            inputTypes.clone();

        // If length == 0, leave it null
        if (writerSpiNames != null &amp;&amp; writerSpiNames.length &gt; 0) {
            this.writerSpiNames = (String[])writerSpiNames.clone();
        }
    }

    /**
     * Returns an array of &lt;code&gt;Class&lt;/code&gt; objects indicating what
     * types of objects may be used as arguments to the reader's
     * &lt;code&gt;setInput&lt;/code&gt; method.
     *
     * &lt;p&gt; For most readers, which only accept input from an
     * &lt;code&gt;ImageInputStream&lt;/code&gt;, a single-element array
     * containing &lt;code&gt;ImageInputStream.class&lt;/code&gt; should be
     * returned.
     *
     * @return a non-&lt;code&gt;null&lt;/code&gt; array of
     * &lt;code&gt;Class&lt;/code&gt;objects of length at least 1.
     */
    public Class[] getInputTypes() {
        return (Class[])inputTypes.clone();
    }

    /**
     * Returns &lt;code&gt;true&lt;/code&gt; if the supplied source object appears
     * to be of the format supported by this reader.  Returning
     * &lt;code&gt;true&lt;/code&gt; from this method does not guarantee that
     * reading will succeed, only that there appears to be a
     * reasonable chance of success based on a brief inspection of the
     * stream contents.  If the source is an
     * &lt;code&gt;ImageInputStream&lt;/code&gt;, implementations will commonly
     * check the first several bytes of the stream for a &quot;magic
     * number&quot; associated with the format.  Once actual reading has
     * commenced, the reader may still indicate failure at any time
     * prior to the completion of decoding.
     *
     * &lt;p&gt; It is important that the state of the object not be
     * disturbed in order that other &lt;code&gt;ImageReaderSpi&lt;/code&gt;s can
     * properly determine whether they are able to decode the object.
     * In particular, if the source is an
     * &lt;code&gt;ImageInputStream&lt;/code&gt;, a
     * &lt;code&gt;mark&lt;/code&gt;/&lt;code&gt;reset&lt;/code&gt; pair should be used to
     * preserve the stream position.
     *
     * &lt;p&gt; Formats such as &quot;raw,&quot; which can potentially attempt
     * to read nearly any stream, should return &lt;code&gt;false&lt;/code&gt;
     * in order to avoid being invoked in preference to a closer
     * match.
     *
     * &lt;p&gt; If &lt;code&gt;source&lt;/code&gt; is not an instance of one of the
     * classes returned by &lt;code&gt;getInputTypes&lt;/code&gt;, the method
     * should simply return &lt;code&gt;false&lt;/code&gt;.
     *
     * @param source the object (typically an
     * &lt;code&gt;ImageInputStream&lt;/code&gt;) to be decoded.
     *
     * @return &lt;code&gt;true&lt;/code&gt; if it is likely that this stream can
     * be decoded.
     *
     * @exception IllegalArgumentException if &lt;code&gt;source&lt;/code&gt; is
     * &lt;code&gt;null&lt;/code&gt;.
     * @exception IOException if an I/O error occurs while reading the
     * stream.
     */
    public abstract boolean canDecodeInput(Object source) throws IOException;

    /**
     * Returns an instance of the &lt;code&gt;ImageReader&lt;/code&gt;
     * implementation associated with this service provider.
     * The returned object will initially be in an initial state
     * as if its &lt;code&gt;reset&lt;/code&gt; method had been called.
     *
     * &lt;p&gt; The default implementation simply returns
     * &lt;code&gt;createReaderInstance(null)&lt;/code&gt;.
     *
     * @return an &lt;code&gt;ImageReader&lt;/code&gt; instance.
     *
     * @exception IOException if an error occurs during loading,
     * or initialization of the reader class, or during instantiation
     * or initialization of the reader object.
     */
    public ImageReader createReaderInstance() throws IOException {
        return createReaderInstance(null);
    }

    /**
     * Returns an instance of the &lt;code&gt;ImageReader&lt;/code&gt;
     * implementation associated with this service provider.
     * The returned object will initially be in an initial state
     * as if its &lt;code&gt;reset&lt;/code&gt; method had been called.
     *
     * &lt;p&gt; An &lt;code&gt;Object&lt;/code&gt; may be supplied to the plug-in at
     * construction time.  The nature of the object is entirely
     * plug-in specific.
     *
     * &lt;p&gt; Typically, a plug-in will implement this method using code
     * such as &lt;code&gt;return new MyImageReader(this)&lt;/code&gt;.
     *
     * @param extension a plug-in specific extension object, which may
     * be &lt;code&gt;null&lt;/code&gt;.
     *
     * @return an &lt;code&gt;ImageReader&lt;/code&gt; instance.
     *
     * @exception IOException if the attempt to instantiate
     * the reader fails.
     * @exception IllegalArgumentException if the
     * &lt;code&gt;ImageReader&lt;/code&gt;'s constructor throws an
     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; to indicate that the
     * extension object is unsuitable.
     */
    public abstract ImageReader createReaderInstance(Object extension)
        throws IOException;

    /**
     * Returns &lt;code&gt;true&lt;/code&gt; if the &lt;code&gt;ImageReader&lt;/code&gt; object
     * passed in is an instance of the &lt;code&gt;ImageReader&lt;/code&gt;
     * associated with this service provider.
     *
     * &lt;p&gt; The default implementation compares the fully-qualified
     * class name of the &lt;code&gt;reader&lt;/code&gt; argument with the class
     * name passed into the constructor.  This method may be overridden
     * if more sophisticated checking is required.
     *
     * @param reader an &lt;code&gt;ImageReader&lt;/code&gt; instance.
     *
     * @return &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;reader&lt;/code&gt; is recognized.
     *
     * @exception IllegalArgumentException if &lt;code&gt;reader&lt;/code&gt; is
     * &lt;code&gt;null&lt;/code&gt;.
     */
    public boolean isOwnReader(ImageReader reader) {
        if (reader == null) {
            throw new IllegalArgumentException(&quot;reader == null!&quot;);
        }
        String name = reader.getClass().getName();
        return name.equals(pluginClassName);
    }

    /**
     * Returns an array of &lt;code&gt;String&lt;/code&gt;s containing the fully
     * qualified names of all the &lt;code&gt;ImageWriterSpi&lt;/code&gt; classes
     * that can understand the internal metadata representation used
     * by the &lt;code&gt;ImageReader&lt;/code&gt; associated with this service
     * provider, or &lt;code&gt;null&lt;/code&gt; if there are no such
     * &lt;code&gt;ImageWriter&lt;/code&gt;s specified.  If a
     * non-&lt;code&gt;null&lt;/code&gt; value is returned, it must have non-zero
     * length.
     *
     * &lt;p&gt; The first item in the array must be the name of the service
     * provider for the &quot;preferred&quot; writer, as it will be used to
     * instantiate the &lt;code&gt;ImageWriter&lt;/code&gt; returned by
     * &lt;code&gt;ImageIO.getImageWriter(ImageReader)&lt;/code&gt;.
     *
     * &lt;p&gt; This mechanism may be used to obtain
     * &lt;code&gt;ImageWriters&lt;/code&gt; that will understand the internal
     * structure of non-pixel meta-data (see
     * &lt;code&gt;IIOTreeInfo&lt;/code&gt;) generated by an
     * &lt;code&gt;ImageReader&lt;/code&gt;.  By obtaining this data from the
     * &lt;code&gt;ImageReader&lt;/code&gt; and passing it on to one of the
     * &lt;code&gt;ImageWriters&lt;/code&gt; obtained with this method, a client
     * program can read an image, modify it in some way, and write it
     * back out while preserving all meta-data, without having to
     * understand anything about the internal structure of the
     * meta-data, or even about the image format.
     *
     * @return an array of &lt;code&gt;String&lt;/code&gt;s of length at least 1
     * containing names of &lt;code&gt;ImageWriterSpi&lt;/code&gt;, or
     * &lt;code&gt;null&lt;/code&gt;.
     *
     * @see javax.imageio.ImageIO#getImageWriter(ImageReader)
     */
    public String[] getImageWriterSpiNames() {
        return writerSpiNames == null ?
            null : (String[])writerSpiNames.clone();
    }
}
</pre>
</body>
</html>
