<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
    </head>
<body>
<pre class="code">
/*
 * reserved comment block
 * DO NOT REMOVE OR ALTER!
 */
/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements. See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance
 * with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
package com.sun.org.apache.xml.internal.security.encryption;

import java.util.Iterator;
import com.sun.org.apache.xml.internal.security.keys.KeyInfo;
import org.w3c.dom.Element;

/**
 * A Key Agreement algorithm provides for the derivation of a shared secret key
 * based on a shared secret computed from certain types of compatible public
 * keys from both the sender and the recipient. Information from the originator
 * to determine the secret is indicated by an optional OriginatorKeyInfo
 * parameter child of an &lt;code&gt;AgreementMethod&lt;/code&gt; element while that
 * associated with the recipient is indicated by an optional RecipientKeyInfo. A
 * shared key is derived from this shared secret by a method determined by the
 * Key Agreement algorithm.
 * &lt;p&gt;
 * &lt;b&gt;Note:&lt;/b&gt; XML Encryption does not provide an on-line key agreement
 * negotiation protocol. The &lt;code&gt;AgreementMethod&lt;/code&gt; element can be used by
 * the originator to identify the keys and computational procedure that were
 * used to obtain a shared encryption key. The method used to obtain or select
 * the keys or algorithm used for the agreement computation is beyond the scope
 * of this specification.
 * &lt;p&gt;
 * The &lt;code&gt;AgreementMethod&lt;/code&gt; element appears as the content of a
 * &lt;code&gt;ds:KeyInfo&lt;/code&gt; since, like other &lt;code&gt;ds:KeyInfo&lt;/code&gt; children,
 * it yields a key. This &lt;code&gt;ds:KeyInfo&lt;/code&gt; is in turn a child of an
 * &lt;code&gt;EncryptedData&lt;/code&gt; or &lt;code&gt;EncryptedKey&lt;/code&gt; element. The
 * Algorithm attribute and KeySize child of the &lt;code&gt;EncryptionMethod&lt;/code&gt;
 * element under this &lt;code&gt;EncryptedData&lt;/code&gt; or &lt;code&gt;EncryptedKey&lt;/code&gt;
 * element are implicit parameters to the key agreement computation. In cases
 * where this &lt;code&gt;EncryptionMethod&lt;/code&gt; algorithm &lt;code&gt;URI&lt;/code&gt; is
 * insufficient to determine the key length, a KeySize MUST have been included.
 * In addition, the sender may place a KA-Nonce element under
 * &lt;code&gt;AgreementMethod&lt;/code&gt; to assure that different keying material is
 * generated even for repeated agreements using the same sender and recipient
 * public keys.
 * &lt;p&gt;
 * If the agreed key is being used to wrap a key, then
 * &lt;code&gt;AgreementMethod&lt;/code&gt; would appear inside a &lt;code&gt;ds:KeyInfo&lt;/code&gt;
 * inside an &lt;code&gt;EncryptedKey&lt;/code&gt; element.
 * &lt;p&gt;
 * The Schema for AgreementMethod is as follows:
 * &lt;xmp&gt;
 * &lt;element name=&quot;AgreementMethod&quot; type=&quot;xenc:AgreementMethodType&quot;/&gt;
 * &lt;complexType name=&quot;AgreementMethodType&quot; mixed=&quot;true&quot;&gt;
 *     &lt;sequence&gt;
 *         &lt;element name=&quot;KA-Nonce&quot; minOccurs=&quot;0&quot; type=&quot;base64Binary&quot;/&gt;
 *         &lt;!-- &lt;element ref=&quot;ds:DigestMethod&quot; minOccurs=&quot;0&quot;/&gt; --&gt;
 *         &lt;any namespace=&quot;##other&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
 *         &lt;element name=&quot;OriginatorKeyInfo&quot; minOccurs=&quot;0&quot; type=&quot;ds:KeyInfoType&quot;/&gt;
 *         &lt;element name=&quot;RecipientKeyInfo&quot; minOccurs=&quot;0&quot; type=&quot;ds:KeyInfoType&quot;/&gt;
 *     &lt;/sequence&gt;
 *     &lt;attribute name=&quot;Algorithm&quot; type=&quot;anyURI&quot; use=&quot;required&quot;/&gt;
 * &lt;/complexType&gt;
 * &lt;/xmp&gt;
 *
 * @author Axl Mattheus
 */
public interface AgreementMethod {

    /**
     * Returns a &lt;code&gt;byte&lt;/code&gt; array.
     * @return a &lt;code&gt;byte&lt;/code&gt; array.
     */
    byte[] getKANonce();

    /**
     * Sets the KANonce.jj
     * @param kanonce
     */
    void setKANonce(byte[] kanonce);

    /**
     * Returns additional information regarding the &lt;code&gt;AgreementMethod&lt;/code&gt;.
     * @return additional information regarding the &lt;code&gt;AgreementMethod&lt;/code&gt;.
     */
    Iterator&lt;Element&gt; getAgreementMethodInformation();

    /**
     * Adds additional &lt;code&gt;AgreementMethod&lt;/code&gt; information.
     *
     * @param info a &lt;code&gt;Element&lt;/code&gt; that represents additional information
     * specified by
     *   &lt;xmp&gt;
     *     &lt;any namespace=&quot;##other&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
     *   &lt;/xmp&gt;
     */
    void addAgreementMethodInformation(Element info);

    /**
     * Removes additional &lt;code&gt;AgreementMethod&lt;/code&gt; information.
     *
     * @param info a &lt;code&gt;Element&lt;/code&gt; that represents additional information
     * specified by
     *   &lt;xmp&gt;
     *     &lt;any namespace=&quot;##other&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;/&gt;
     *   &lt;/xmp&gt;
     */
    void revoveAgreementMethodInformation(Element info);

    /**
     * Returns information relating to the originator's shared secret.
     *
     * @return information relating to the originator's shared secret.
     */
    KeyInfo getOriginatorKeyInfo();

    /**
     * Sets the information relating to the originator's shared secret.
     *
     * @param keyInfo information relating to the originator's shared secret.
     */
    void setOriginatorKeyInfo(KeyInfo keyInfo);

    /**
     * Returns information relating to the recipient's shared secret.
     *
     * @return information relating to the recipient's shared secret.
     */
    KeyInfo getRecipientKeyInfo();

    /**
     * Sets the information relating to the recipient's shared secret.
     *
     * @param keyInfo information relating to the recipient's shared secret.
     */
    void setRecipientKeyInfo(KeyInfo keyInfo);

    /**
     * Returns the algorithm URI of this &lt;code&gt;CryptographicMethod&lt;/code&gt;.
     *
     * @return the algorithm URI of this &lt;code&gt;CryptographicMethod&lt;/code&gt;
     */
    String getAlgorithm();
}
</pre>
</body>
</html>
