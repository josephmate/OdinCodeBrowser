<html>
    <head>
        <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
    </head>
<body>
<pre class="code">
/*
 * Copyright (c) 1997, 2013, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 *
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 * or visit www.oracle.com if you need additional information or have any
 * questions.
 */

/*
 * &lt;p&gt;These classes are designed to be used while the
 * corresponding &lt;code&gt;LookAndFeel&lt;/code&gt; class has been installed
 * (&lt;code&gt;UIManager.setLookAndFeel(new &lt;i&gt;XXX&lt;/i&gt;LookAndFeel())&lt;/code&gt;).
 * Using them while a different &lt;code&gt;LookAndFeel&lt;/code&gt; is installed
 * may produce unexpected results, including exceptions.
 * Additionally, changing the &lt;code&gt;LookAndFeel&lt;/code&gt;
 * maintained by the &lt;code&gt;UIManager&lt;/code&gt; without updating the
 * corresponding &lt;code&gt;ComponentUI&lt;/code&gt; of any
 * &lt;code&gt;JComponent&lt;/code&gt;s may also produce unexpected results,
 * such as the wrong colors showing up, and is generally not
 * encouraged.
 *
 */

package com.sun.java.swing.plaf.windows;

import java.awt.*;
import java.awt.image.BufferedImage;
import java.awt.image.ImageFilter;
import java.awt.image.ImageProducer;
import java.awt.image.FilteredImageSource;
import java.awt.image.RGBImageFilter;

import javax.swing.plaf.*;
import javax.swing.*;
import javax.swing.plaf.basic.*;
import javax.swing.border.*;
import javax.swing.text.DefaultEditorKit;

import java.awt.Font;
import java.awt.Color;
import java.awt.event.ActionEvent;

import java.security.AccessController;

import sun.awt.SunToolkit;
import sun.awt.OSInfo;
import sun.awt.shell.ShellFolder;
import sun.font.FontUtilities;
import sun.security.action.GetPropertyAction;

import sun.swing.DefaultLayoutStyle;
import sun.swing.ImageIconUIResource;
import sun.swing.SwingLazyValue;
import sun.swing.SwingUtilities2;
import sun.swing.StringUIClientPropertyKey;

import static com.sun.java.swing.plaf.windows.TMSchema.*;
import static com.sun.java.swing.plaf.windows.XPStyle.Skin;

import com.sun.java.swing.plaf.windows.WindowsIconFactory.VistaMenuItemCheckIconFactory;

/**
 * Implements the Windows95/98/NT/2000 Look and Feel.
 * UI classes not implemented specifically for Windows will
 * default to those implemented in Basic.
 * &lt;p&gt;
 * &lt;strong&gt;Warning:&lt;/strong&gt;
 * Serialized objects of this class will not be compatible with
 * future Swing releases.  The current serialization support is appropriate
 * for short term storage or RMI between applications running the same
 * version of Swing.  A future release of Swing will provide support for
 * long term persistence.
 *
 * @author unattributed
 */
public class WindowsLookAndFeel extends BasicLookAndFeel
{
    /**
     * A client property that can be used with any JComponent that will end up
     * calling the LookAndFeel.getDisabledIcon method. This client property,
     * when set to Boolean.TRUE, will cause getDisabledIcon to use an
     * alternate algorithm for creating disabled icons to produce icons
     * that appear similar to the native Windows file chooser
     */
    static final Object HI_RES_DISABLED_ICON_CLIENT_KEY =
        new StringUIClientPropertyKey(
            &quot;WindowsLookAndFeel.generateHiResDisabledIcon&quot;);

    private boolean updatePending = false;

    private boolean useSystemFontSettings = true;
    private boolean useSystemFontSizeSettings;

    // These properties are not used directly, but are kept as
    // private members to avoid being GC'd.
    private DesktopProperty themeActive, dllName, colorName, sizeName;
    private DesktopProperty aaSettings;

    private transient LayoutStyle style;

    /**
     * Base dialog units along the horizontal axis.
     */
    private int baseUnitX;

    /**
     * Base dialog units along the vertical axis.
     */
    private int baseUnitY;

    public String getName() {
        return &quot;Windows&quot;;
    }

    public String getDescription() {
        return &quot;The Microsoft Windows Look and Feel&quot;;
    }

    public String getID() {
        return &quot;Windows&quot;;
    }

    public boolean isNativeLookAndFeel() {
        return OSInfo.getOSType() == OSInfo.OSType.WINDOWS;
    }

    public boolean isSupportedLookAndFeel() {
        return isNativeLookAndFeel();
    }

    public void initialize() {
        super.initialize();

        // Set the flag which determines which version of Windows should
        // be rendered. This flag only need to be set once.
        // if version &lt;= 4.0 then the classic LAF should be loaded.
        if (OSInfo.getWindowsVersion().compareTo(OSInfo.WINDOWS_95) &lt;= 0) {
            isClassicWindows = true;
        } else {
            isClassicWindows = false;
            XPStyle.invalidateStyle();
        }

        // Using the fonts set by the user can potentially cause
        // performance and compatibility issues, so allow this feature
        // to be switched off either at runtime or programmatically
        //
        String systemFonts = java.security.AccessController.doPrivileged(
               new GetPropertyAction(&quot;swing.useSystemFontSettings&quot;));
        useSystemFontSettings = (systemFonts == null ||
                                 Boolean.valueOf(systemFonts).booleanValue());

        if (useSystemFontSettings) {
            Object value = UIManager.get(&quot;Application.useSystemFontSettings&quot;);

            useSystemFontSettings = (value == null ||
                                     Boolean.TRUE.equals(value));
        }
        KeyboardFocusManager.getCurrentKeyboardFocusManager().
            addKeyEventPostProcessor(WindowsRootPaneUI.altProcessor);

    }

    /**
     * Initialize the uiClassID to BasicComponentUI mapping.
     * The JComponent classes define their own uiClassID constants
     * (see AbstractComponent.getUIClassID).  This table must
     * map those constants to a BasicComponentUI class of the
     * appropriate type.
     *
     * @see BasicLookAndFeel#getDefaults
     */
    protected void initClassDefaults(UIDefaults table)
    {
        super.initClassDefaults(table);

        final String windowsPackageName = &quot;com.sun.java.swing.plaf.windows.&quot;;

        Object[] uiDefaults = {
              &quot;ButtonUI&quot;, windowsPackageName + &quot;WindowsButtonUI&quot;,
            &quot;CheckBoxUI&quot;, windowsPackageName + &quot;WindowsCheckBoxUI&quot;,
    &quot;CheckBoxMenuItemUI&quot;, windowsPackageName + &quot;WindowsCheckBoxMenuItemUI&quot;,
               &quot;LabelUI&quot;, windowsPackageName + &quot;WindowsLabelUI&quot;,
         &quot;RadioButtonUI&quot;, windowsPackageName + &quot;WindowsRadioButtonUI&quot;,
 &quot;RadioButtonMenuItemUI&quot;, windowsPackageName + &quot;WindowsRadioButtonMenuItemUI&quot;,
        &quot;ToggleButtonUI&quot;, windowsPackageName + &quot;WindowsToggleButtonUI&quot;,
         &quot;ProgressBarUI&quot;, windowsPackageName + &quot;WindowsProgressBarUI&quot;,
              &quot;SliderUI&quot;, windowsPackageName + &quot;WindowsSliderUI&quot;,
           &quot;SeparatorUI&quot;, windowsPackageName + &quot;WindowsSeparatorUI&quot;,
           &quot;SplitPaneUI&quot;, windowsPackageName + &quot;WindowsSplitPaneUI&quot;,
             &quot;SpinnerUI&quot;, windowsPackageName + &quot;WindowsSpinnerUI&quot;,
          &quot;TabbedPaneUI&quot;, windowsPackageName + &quot;WindowsTabbedPaneUI&quot;,
            &quot;TextAreaUI&quot;, windowsPackageName + &quot;WindowsTextAreaUI&quot;,
           &quot;TextFieldUI&quot;, windowsPackageName + &quot;WindowsTextFieldUI&quot;,
       &quot;PasswordFieldUI&quot;, windowsPackageName + &quot;WindowsPasswordFieldUI&quot;,
            &quot;TextPaneUI&quot;, windowsPackageName + &quot;WindowsTextPaneUI&quot;,
          &quot;EditorPaneUI&quot;, windowsPackageName + &quot;WindowsEditorPaneUI&quot;,
                &quot;TreeUI&quot;, windowsPackageName + &quot;WindowsTreeUI&quot;,
             &quot;ToolBarUI&quot;, windowsPackageName + &quot;WindowsToolBarUI&quot;,
    &quot;ToolBarSeparatorUI&quot;, windowsPackageName + &quot;WindowsToolBarSeparatorUI&quot;,
            &quot;ComboBoxUI&quot;, windowsPackageName + &quot;WindowsComboBoxUI&quot;,
         &quot;TableHeaderUI&quot;, windowsPackageName + &quot;WindowsTableHeaderUI&quot;,
       &quot;InternalFrameUI&quot;, windowsPackageName + &quot;WindowsInternalFrameUI&quot;,
         &quot;DesktopPaneUI&quot;, windowsPackageName + &quot;WindowsDesktopPaneUI&quot;,
         &quot;DesktopIconUI&quot;, windowsPackageName + &quot;WindowsDesktopIconUI&quot;,
         &quot;FileChooserUI&quot;, windowsPackageName + &quot;WindowsFileChooserUI&quot;,
                &quot;MenuUI&quot;, windowsPackageName + &quot;WindowsMenuUI&quot;,
            &quot;MenuItemUI&quot;, windowsPackageName + &quot;WindowsMenuItemUI&quot;,
             &quot;MenuBarUI&quot;, windowsPackageName + &quot;WindowsMenuBarUI&quot;,
           &quot;PopupMenuUI&quot;, windowsPackageName + &quot;WindowsPopupMenuUI&quot;,
  &quot;PopupMenuSeparatorUI&quot;, windowsPackageName + &quot;WindowsPopupMenuSeparatorUI&quot;,
           &quot;ScrollBarUI&quot;, windowsPackageName + &quot;WindowsScrollBarUI&quot;,
            &quot;RootPaneUI&quot;, windowsPackageName + &quot;WindowsRootPaneUI&quot;
        };

        table.putDefaults(uiDefaults);
    }

    /**
     * Load the SystemColors into the defaults table.  The keys
     * for SystemColor defaults are the same as the names of
     * the public fields in SystemColor.  If the table is being
     * created on a native Windows platform we use the SystemColor
     * values, otherwise we create color objects whose values match
     * the defaults Windows95 colors.
     */
    protected void initSystemColorDefaults(UIDefaults table)
    {
        String[] defaultSystemColors = {
                &quot;desktop&quot;, &quot;#005C5C&quot;, /* Color of the desktop background */
          &quot;activeCaption&quot;, &quot;#000080&quot;, /* Color for captions (title bars) when they are active. */
      &quot;activeCaptionText&quot;, &quot;#FFFFFF&quot;, /* Text color for text in captions (title bars). */
    &quot;activeCaptionBorder&quot;, &quot;#C0C0C0&quot;, /* Border color for caption (title bar) window borders. */
        &quot;inactiveCaption&quot;, &quot;#808080&quot;, /* Color for captions (title bars) when not active. */
    &quot;inactiveCaptionText&quot;, &quot;#C0C0C0&quot;, /* Text color for text in inactive captions (title bars). */
  &quot;inactiveCaptionBorder&quot;, &quot;#C0C0C0&quot;, /* Border color for inactive caption (title bar) window borders. */
                 &quot;window&quot;, &quot;#FFFFFF&quot;, /* Default color for the interior of windows */
           &quot;windowBorder&quot;, &quot;#000000&quot;, /* ??? */
             &quot;windowText&quot;, &quot;#000000&quot;, /* ??? */
                   &quot;menu&quot;, &quot;#C0C0C0&quot;, /* Background color for menus */
       &quot;menuPressedItemB&quot;, &quot;#000080&quot;, /* LightShadow of menubutton highlight */
       &quot;menuPressedItemF&quot;, &quot;#FFFFFF&quot;, /* Default color for foreground &quot;text&quot; in menu item */
               &quot;menuText&quot;, &quot;#000000&quot;, /* Text color for menus  */
                   &quot;text&quot;, &quot;#C0C0C0&quot;, /* Text background color */
               &quot;textText&quot;, &quot;#000000&quot;, /* Text foreground color */
          &quot;textHighlight&quot;, &quot;#000080&quot;, /* Text background color when selected */
      &quot;textHighlightText&quot;, &quot;#FFFFFF&quot;, /* Text color when selected */
       &quot;textInactiveText&quot;, &quot;#808080&quot;, /* Text color when disabled */
                &quot;control&quot;, &quot;#C0C0C0&quot;, /* Default color for controls (buttons, sliders, etc) */
            &quot;controlText&quot;, &quot;#000000&quot;, /* Default color for text in controls */
       &quot;controlHighlight&quot;, &quot;#C0C0C0&quot;,

  /*&quot;controlHighlight&quot;, &quot;#E0E0E0&quot;,*/ /* Specular highlight (opposite of the shadow) */
     &quot;controlLtHighlight&quot;, &quot;#FFFFFF&quot;, /* Highlight color for controls */
          &quot;controlShadow&quot;, &quot;#808080&quot;, /* Shadow color for controls */
        &quot;controlDkShadow&quot;, &quot;#000000&quot;, /* Dark shadow color for controls */
              &quot;scrollbar&quot;, &quot;#E0E0E0&quot;, /* Scrollbar background (usually the &quot;track&quot;) */
                   &quot;info&quot;, &quot;#FFFFE1&quot;, /* ??? */
               &quot;infoText&quot;, &quot;#000000&quot;  /* ??? */
        };

        loadSystemColors(table, defaultSystemColors, isNativeLookAndFeel());
    }

   /**
     * Initialize the defaults table with the name of the ResourceBundle
     * used for getting localized defaults.
     */
    private void initResourceBundle(UIDefaults table) {
        table.addResourceBundle( &quot;com.sun.java.swing.plaf.windows.resources.windows&quot; );
    }

    // XXX - there are probably a lot of redundant values that could be removed.
    // ie. Take a look at RadioButtonBorder, etc...
    protected void initComponentDefaults(UIDefaults table)
    {
        super.initComponentDefaults( table );

        initResourceBundle(table);

        // *** Shared Fonts
        Integer twelve = Integer.valueOf(12);
        Integer fontPlain = Integer.valueOf(Font.PLAIN);
        Integer fontBold = Integer.valueOf(Font.BOLD);

        Object dialogPlain12 = new SwingLazyValue(
                               &quot;javax.swing.plaf.FontUIResource&quot;,
                               null,
                               new Object[] {Font.DIALOG, fontPlain, twelve});

        Object sansSerifPlain12 =  new SwingLazyValue(
                          &quot;javax.swing.plaf.FontUIResource&quot;,
                          null,
                          new Object[] {Font.SANS_SERIF, fontPlain, twelve});
        Object monospacedPlain12 = new SwingLazyValue(
                          &quot;javax.swing.plaf.FontUIResource&quot;,
                          null,
                          new Object[] {Font.MONOSPACED, fontPlain, twelve});
        Object dialogBold12 = new SwingLazyValue(
                          &quot;javax.swing.plaf.FontUIResource&quot;,
                          null,
                          new Object[] {Font.DIALOG, fontBold, twelve});

        // *** Colors
        // XXX - some of these doens't seem to be used
        ColorUIResource red = new ColorUIResource(Color.red);
        ColorUIResource black = new ColorUIResource(Color.black);
        ColorUIResource white = new ColorUIResource(Color.white);
        ColorUIResource gray = new ColorUIResource(Color.gray);
        ColorUIResource darkGray = new ColorUIResource(Color.darkGray);
        ColorUIResource scrollBarTrackHighlight = darkGray;

        // Set the flag which determines which version of Windows should
        // be rendered. This flag only need to be set once.
        // if version &lt;= 4.0 then the classic LAF should be loaded.
        isClassicWindows = OSInfo.getWindowsVersion().compareTo(OSInfo.WINDOWS_95) &lt;= 0;

        // *** Tree
        Object treeExpandedIcon = WindowsTreeUI.ExpandedIcon.createExpandedIcon();

        Object treeCollapsedIcon = WindowsTreeUI.CollapsedIcon.createCollapsedIcon();


        // *** Text
        Object fieldInputMap = new UIDefaults.LazyInputMap(new Object[] {
                      &quot;control C&quot;, DefaultEditorKit.copyAction,
                      &quot;control V&quot;, DefaultEditorKit.pasteAction,
                      &quot;control X&quot;, DefaultEditorKit.cutAction,
                           &quot;COPY&quot;, DefaultEditorKit.copyAction,
                          &quot;PASTE&quot;, DefaultEditorKit.pasteAction,
                            &quot;CUT&quot;, DefaultEditorKit.cutAction,
                 &quot;control INSERT&quot;, DefaultEditorKit.copyAction,
                   &quot;shift INSERT&quot;, DefaultEditorKit.pasteAction,
                   &quot;shift DELETE&quot;, DefaultEditorKit.cutAction,
                      &quot;control A&quot;, DefaultEditorKit.selectAllAction,
             &quot;control BACK_SLASH&quot;, &quot;unselect&quot;/*DefaultEditorKit.unselectAction*/,
                     &quot;shift LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
                    &quot;shift RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
                   &quot;control LEFT&quot;, DefaultEditorKit.previousWordAction,
                  &quot;control RIGHT&quot;, DefaultEditorKit.nextWordAction,
             &quot;control shift LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
            &quot;control shift RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
                           &quot;HOME&quot;, DefaultEditorKit.beginLineAction,
                            &quot;END&quot;, DefaultEditorKit.endLineAction,
                     &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginLineAction,
                      &quot;shift END&quot;, DefaultEditorKit.selectionEndLineAction,
                     &quot;BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
               &quot;shift BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;ctrl H&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;DELETE&quot;, DefaultEditorKit.deleteNextCharAction,
                    &quot;ctrl DELETE&quot;, DefaultEditorKit.deleteNextWordAction,
                &quot;ctrl BACK_SPACE&quot;, DefaultEditorKit.deletePrevWordAction,
                          &quot;RIGHT&quot;, DefaultEditorKit.forwardAction,
                           &quot;LEFT&quot;, DefaultEditorKit.backwardAction,
                       &quot;KP_RIGHT&quot;, DefaultEditorKit.forwardAction,
                        &quot;KP_LEFT&quot;, DefaultEditorKit.backwardAction,
                          &quot;ENTER&quot;, JTextField.notifyAction,
                &quot;control shift O&quot;, &quot;toggle-componentOrientation&quot;/*DefaultEditorKit.toggleComponentOrientation*/
        });

        Object passwordInputMap = new UIDefaults.LazyInputMap(new Object[] {
                      &quot;control C&quot;, DefaultEditorKit.copyAction,
                      &quot;control V&quot;, DefaultEditorKit.pasteAction,
                      &quot;control X&quot;, DefaultEditorKit.cutAction,
                           &quot;COPY&quot;, DefaultEditorKit.copyAction,
                          &quot;PASTE&quot;, DefaultEditorKit.pasteAction,
                            &quot;CUT&quot;, DefaultEditorKit.cutAction,
                 &quot;control INSERT&quot;, DefaultEditorKit.copyAction,
                   &quot;shift INSERT&quot;, DefaultEditorKit.pasteAction,
                   &quot;shift DELETE&quot;, DefaultEditorKit.cutAction,
                      &quot;control A&quot;, DefaultEditorKit.selectAllAction,
             &quot;control BACK_SLASH&quot;, &quot;unselect&quot;/*DefaultEditorKit.unselectAction*/,
                     &quot;shift LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
                    &quot;shift RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
                   &quot;control LEFT&quot;, DefaultEditorKit.beginLineAction,
                  &quot;control RIGHT&quot;, DefaultEditorKit.endLineAction,
             &quot;control shift LEFT&quot;, DefaultEditorKit.selectionBeginLineAction,
            &quot;control shift RIGHT&quot;, DefaultEditorKit.selectionEndLineAction,
                           &quot;HOME&quot;, DefaultEditorKit.beginLineAction,
                            &quot;END&quot;, DefaultEditorKit.endLineAction,
                     &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginLineAction,
                      &quot;shift END&quot;, DefaultEditorKit.selectionEndLineAction,
                     &quot;BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
               &quot;shift BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;ctrl H&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;DELETE&quot;, DefaultEditorKit.deleteNextCharAction,
                          &quot;RIGHT&quot;, DefaultEditorKit.forwardAction,
                           &quot;LEFT&quot;, DefaultEditorKit.backwardAction,
                       &quot;KP_RIGHT&quot;, DefaultEditorKit.forwardAction,
                        &quot;KP_LEFT&quot;, DefaultEditorKit.backwardAction,
                          &quot;ENTER&quot;, JTextField.notifyAction,
                &quot;control shift O&quot;, &quot;toggle-componentOrientation&quot;/*DefaultEditorKit.toggleComponentOrientation*/
        });

        Object multilineInputMap = new UIDefaults.LazyInputMap(new Object[] {
                      &quot;control C&quot;, DefaultEditorKit.copyAction,
                      &quot;control V&quot;, DefaultEditorKit.pasteAction,
                      &quot;control X&quot;, DefaultEditorKit.cutAction,
                           &quot;COPY&quot;, DefaultEditorKit.copyAction,
                          &quot;PASTE&quot;, DefaultEditorKit.pasteAction,
                            &quot;CUT&quot;, DefaultEditorKit.cutAction,
                 &quot;control INSERT&quot;, DefaultEditorKit.copyAction,
                   &quot;shift INSERT&quot;, DefaultEditorKit.pasteAction,
                   &quot;shift DELETE&quot;, DefaultEditorKit.cutAction,
                     &quot;shift LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
                    &quot;shift RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
                   &quot;control LEFT&quot;, DefaultEditorKit.previousWordAction,
                  &quot;control RIGHT&quot;, DefaultEditorKit.nextWordAction,
             &quot;control shift LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
            &quot;control shift RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
                      &quot;control A&quot;, DefaultEditorKit.selectAllAction,
             &quot;control BACK_SLASH&quot;, &quot;unselect&quot;/*DefaultEditorKit.unselectAction*/,
                           &quot;HOME&quot;, DefaultEditorKit.beginLineAction,
                            &quot;END&quot;, DefaultEditorKit.endLineAction,
                     &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginLineAction,
                      &quot;shift END&quot;, DefaultEditorKit.selectionEndLineAction,
                   &quot;control HOME&quot;, DefaultEditorKit.beginAction,
                    &quot;control END&quot;, DefaultEditorKit.endAction,
             &quot;control shift HOME&quot;, DefaultEditorKit.selectionBeginAction,
              &quot;control shift END&quot;, DefaultEditorKit.selectionEndAction,
                             &quot;UP&quot;, DefaultEditorKit.upAction,
                           &quot;DOWN&quot;, DefaultEditorKit.downAction,
                     &quot;BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
               &quot;shift BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;ctrl H&quot;, DefaultEditorKit.deletePrevCharAction,
                         &quot;DELETE&quot;, DefaultEditorKit.deleteNextCharAction,
                    &quot;ctrl DELETE&quot;, DefaultEditorKit.deleteNextWordAction,
                &quot;ctrl BACK_SPACE&quot;, DefaultEditorKit.deletePrevWordAction,
                          &quot;RIGHT&quot;, DefaultEditorKit.forwardAction,
                           &quot;LEFT&quot;, DefaultEditorKit.backwardAction,
                       &quot;KP_RIGHT&quot;, DefaultEditorKit.forwardAction,
                        &quot;KP_LEFT&quot;, DefaultEditorKit.backwardAction,
                        &quot;PAGE_UP&quot;, DefaultEditorKit.pageUpAction,
                      &quot;PAGE_DOWN&quot;, DefaultEditorKit.pageDownAction,
                  &quot;shift PAGE_UP&quot;, &quot;selection-page-up&quot;,
                &quot;shift PAGE_DOWN&quot;, &quot;selection-page-down&quot;,
             &quot;ctrl shift PAGE_UP&quot;, &quot;selection-page-left&quot;,
           &quot;ctrl shift PAGE_DOWN&quot;, &quot;selection-page-right&quot;,
                       &quot;shift UP&quot;, DefaultEditorKit.selectionUpAction,
                     &quot;shift DOWN&quot;, DefaultEditorKit.selectionDownAction,
                          &quot;ENTER&quot;, DefaultEditorKit.insertBreakAction,
                            &quot;TAB&quot;, DefaultEditorKit.insertTabAction,
                      &quot;control T&quot;, &quot;next-link-action&quot;,
                &quot;control shift T&quot;, &quot;previous-link-action&quot;,
                  &quot;control SPACE&quot;, &quot;activate-link-action&quot;,
                &quot;control shift O&quot;, &quot;toggle-componentOrientation&quot;/*DefaultEditorKit.toggleComponentOrientation*/
        });

        Object menuItemAcceleratorDelimiter = &quot;+&quot;;

        Object ControlBackgroundColor = new DesktopProperty(
                                                       &quot;win.3d.backgroundColor&quot;,
                                                        table.get(&quot;control&quot;));
        Object ControlLightColor      = new DesktopProperty(
                                                       &quot;win.3d.lightColor&quot;,
                                                        table.get(&quot;controlHighlight&quot;));
        Object ControlHighlightColor  = new DesktopProperty(
                                                       &quot;win.3d.highlightColor&quot;,
                                                        table.get(&quot;controlLtHighlight&quot;));
        Object ControlShadowColor     = new DesktopProperty(
                                                       &quot;win.3d.shadowColor&quot;,
                                                        table.get(&quot;controlShadow&quot;));
        Object ControlDarkShadowColor = new DesktopProperty(
                                                       &quot;win.3d.darkShadowColor&quot;,
                                                        table.get(&quot;controlDkShadow&quot;));
        Object ControlTextColor       = new DesktopProperty(
                                                       &quot;win.button.textColor&quot;,
                                                        table.get(&quot;controlText&quot;));
        Object MenuBackgroundColor    = new DesktopProperty(
                                                       &quot;win.menu.backgroundColor&quot;,
                                                        table.get(&quot;menu&quot;));
        Object MenuBarBackgroundColor = new DesktopProperty(
                                                       &quot;win.menubar.backgroundColor&quot;,
                                                        table.get(&quot;menu&quot;));
        Object MenuTextColor          = new DesktopProperty(
                                                       &quot;win.menu.textColor&quot;,
                                                        table.get(&quot;menuText&quot;));
        Object SelectionBackgroundColor = new DesktopProperty(
                                                       &quot;win.item.highlightColor&quot;,
                                                        table.get(&quot;textHighlight&quot;));
        Object SelectionTextColor     = new DesktopProperty(
                                                       &quot;win.item.highlightTextColor&quot;,
                                                        table.get(&quot;textHighlightText&quot;));
        Object WindowBackgroundColor  = new DesktopProperty(
                                                       &quot;win.frame.backgroundColor&quot;,
                                                        table.get(&quot;window&quot;));
        Object WindowTextColor        = new DesktopProperty(
                                                       &quot;win.frame.textColor&quot;,
                                                        table.get(&quot;windowText&quot;));
        Object WindowBorderWidth      = new DesktopProperty(
                                                       &quot;win.frame.sizingBorderWidth&quot;,
                                                       Integer.valueOf(1));
        Object TitlePaneHeight        = new DesktopProperty(
                                                       &quot;win.frame.captionHeight&quot;,
                                                       Integer.valueOf(18));
        Object TitleButtonWidth       = new DesktopProperty(
                                                       &quot;win.frame.captionButtonWidth&quot;,
                                                       Integer.valueOf(16));
        Object TitleButtonHeight      = new DesktopProperty(
                                                       &quot;win.frame.captionButtonHeight&quot;,
                                                       Integer.valueOf(16));
        Object InactiveTextColor      = new DesktopProperty(
                                                       &quot;win.text.grayedTextColor&quot;,
                                                        table.get(&quot;textInactiveText&quot;));
        Object ScrollbarBackgroundColor = new DesktopProperty(
                                                       &quot;win.scrollbar.backgroundColor&quot;,
                                                        table.get(&quot;scrollbar&quot;));
        Object buttonFocusColor = new FocusColorProperty();

        Object TextBackground         = new XPColorValue(Part.EP_EDIT, null, Prop.FILLCOLOR,
                                                         WindowBackgroundColor);
        //The following four lines were commented out as part of bug 4991597
        //This code *is* correct, however it differs from WindowsXP and is, apparently
        //a Windows XP bug. Until Windows fixes this bug, we shall also exhibit the same
        //behavior
        //Object ReadOnlyTextBackground = new XPColorValue(Part.EP_EDITTEXT, State.READONLY, Prop.FILLCOLOR,
        //                                                 ControlBackgroundColor);
        //Object DisabledTextBackground = new XPColorValue(Part.EP_EDITTEXT, State.DISABLED, Prop.FILLCOLOR,
        //                                                 ControlBackgroundColor);
        Object ReadOnlyTextBackground = ControlBackgroundColor;
        Object DisabledTextBackground = ControlBackgroundColor;

        Object MenuFont = dialogPlain12;
        Object FixedControlFont = monospacedPlain12;
        Object ControlFont = dialogPlain12;
        Object MessageFont = dialogPlain12;
        Object WindowFont = dialogBold12;
        Object ToolTipFont = sansSerifPlain12;
        Object IconFont = ControlFont;

        Object scrollBarWidth = new DesktopProperty(&quot;win.scrollbar.width&quot;, Integer.valueOf(16));

        Object menuBarHeight = new DesktopProperty(&quot;win.menu.height&quot;, null);

        Object hotTrackingOn = new DesktopProperty(&quot;win.item.hotTrackingOn&quot;, true);

        Object showMnemonics = new DesktopProperty(&quot;win.menu.keyboardCuesOn&quot;, Boolean.TRUE);

        if (useSystemFontSettings) {
            MenuFont = getDesktopFontValue(&quot;win.menu.font&quot;, MenuFont);
            FixedControlFont = getDesktopFontValue(&quot;win.ansiFixed.font&quot;, FixedControlFont);
            ControlFont = getDesktopFontValue(&quot;win.defaultGUI.font&quot;, ControlFont);
            MessageFont = getDesktopFontValue(&quot;win.messagebox.font&quot;, MessageFont);
            WindowFont = getDesktopFontValue(&quot;win.frame.captionFont&quot;, WindowFont);
            IconFont    = getDesktopFontValue(&quot;win.icon.font&quot;, IconFont);
            ToolTipFont = getDesktopFontValue(&quot;win.tooltip.font&quot;, ToolTipFont);

            /* Put the desktop AA settings in the defaults.
             * JComponent.setUI() retrieves this and makes it available
             * as a client property on the JComponent. Use the same key name
             * for both client property and UIDefaults.
             * Also need to set up listeners for changes in these settings.
             */
            Object aaTextInfo = SwingUtilities2.AATextInfo.getAATextInfo(true);
            table.put(SwingUtilities2.AA_TEXT_PROPERTY_KEY, aaTextInfo);
            this.aaSettings =
                new FontDesktopProperty(SunToolkit.DESKTOPFONTHINTS);
        }
        if (useSystemFontSizeSettings) {
            MenuFont = new WindowsFontSizeProperty(&quot;win.menu.font.height&quot;, Font.DIALOG, Font.PLAIN, 12);
            FixedControlFont = new WindowsFontSizeProperty(&quot;win.ansiFixed.font.height&quot;, Font.MONOSPACED,
                       Font.PLAIN, 12);
            ControlFont = new WindowsFontSizeProperty(&quot;win.defaultGUI.font.height&quot;, Font.DIALOG, Font.PLAIN, 12);
            MessageFont = new WindowsFontSizeProperty(&quot;win.messagebox.font.height&quot;, Font.DIALOG, Font.PLAIN, 12);
            WindowFont = new WindowsFontSizeProperty(&quot;win.frame.captionFont.height&quot;, Font.DIALOG, Font.BOLD, 12);
            ToolTipFont = new WindowsFontSizeProperty(&quot;win.tooltip.font.height&quot;, Font.SANS_SERIF, Font.PLAIN, 12);
            IconFont    = new WindowsFontSizeProperty(&quot;win.icon.font.height&quot;, Font.DIALOG, Font.PLAIN, 12);
        }


        if (!(this instanceof WindowsClassicLookAndFeel) &amp;&amp;
            (OSInfo.getOSType() == OSInfo.OSType.WINDOWS &amp;&amp;
             OSInfo.getWindowsVersion().compareTo(OSInfo.WINDOWS_XP) &gt;= 0) &amp;&amp;
            AccessController.doPrivileged(new GetPropertyAction(&quot;swing.noxp&quot;)) == null) {

            // These desktop properties are not used directly, but are needed to
            // trigger realoading of UI's.
            this.themeActive = new TriggerDesktopProperty(&quot;win.xpstyle.themeActive&quot;);
            this.dllName     = new TriggerDesktopProperty(&quot;win.xpstyle.dllName&quot;);
            this.colorName   = new TriggerDesktopProperty(&quot;win.xpstyle.colorName&quot;);
            this.sizeName    = new TriggerDesktopProperty(&quot;win.xpstyle.sizeName&quot;);
        }


        Object[] defaults = {
            // *** Auditory Feedback
            // this key defines which of the various cues to render
            // Overridden from BasicL&amp;F. This L&amp;F should play all sounds
            // all the time. The infrastructure decides what to play.
            // This is disabled until sound bugs can be resolved.
            &quot;AuditoryCues.playList&quot;, null, // table.get(&quot;AuditoryCues.cueList&quot;),

            &quot;Application.useSystemFontSettings&quot;, Boolean.valueOf(useSystemFontSettings),

            &quot;TextField.focusInputMap&quot;, fieldInputMap,
            &quot;PasswordField.focusInputMap&quot;, passwordInputMap,
            &quot;TextArea.focusInputMap&quot;, multilineInputMap,
            &quot;TextPane.focusInputMap&quot;, multilineInputMap,
            &quot;EditorPane.focusInputMap&quot;, multilineInputMap,

            // Buttons
            &quot;Button.font&quot;, ControlFont,
            &quot;Button.background&quot;, ControlBackgroundColor,
            // Button.foreground, Button.shadow, Button.darkShadow,
            // Button.disabledForground, and Button.disabledShadow are only
            // used for Windows Classic. Windows XP will use colors
            // from the current visual style.
            &quot;Button.foreground&quot;, ControlTextColor,
            &quot;Button.shadow&quot;, ControlShadowColor,
            &quot;Button.darkShadow&quot;, ControlDarkShadowColor,
            &quot;Button.light&quot;, ControlLightColor,
            &quot;Button.highlight&quot;, ControlHighlightColor,
            &quot;Button.disabledForeground&quot;, InactiveTextColor,
            &quot;Button.disabledShadow&quot;, ControlHighlightColor,
            &quot;Button.focus&quot;, buttonFocusColor,
            &quot;Button.dashedRectGapX&quot;, new XPValue(Integer.valueOf(3), Integer.valueOf(5)),
            &quot;Button.dashedRectGapY&quot;, new XPValue(Integer.valueOf(3), Integer.valueOf(4)),
            &quot;Button.dashedRectGapWidth&quot;, new XPValue(Integer.valueOf(6), Integer.valueOf(10)),
            &quot;Button.dashedRectGapHeight&quot;, new XPValue(Integer.valueOf(6), Integer.valueOf(8)),
            &quot;Button.textShiftOffset&quot;, new XPValue(Integer.valueOf(0),
                                                  Integer.valueOf(1)),
            // W2K keyboard navigation hidding.
            &quot;Button.showMnemonics&quot;, showMnemonics,
            &quot;Button.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                            &quot;SPACE&quot;, &quot;pressed&quot;,
                   &quot;released SPACE&quot;, &quot;released&quot;
                 }),

            &quot;Caret.width&quot;,
                  new DesktopProperty(&quot;win.caret.width&quot;, null),

            &quot;CheckBox.font&quot;, ControlFont,
            &quot;CheckBox.interiorBackground&quot;, WindowBackgroundColor,
            &quot;CheckBox.background&quot;, ControlBackgroundColor,
            &quot;CheckBox.foreground&quot;, WindowTextColor,
            &quot;CheckBox.shadow&quot;, ControlShadowColor,
            &quot;CheckBox.darkShadow&quot;, ControlDarkShadowColor,
            &quot;CheckBox.light&quot;, ControlLightColor,
            &quot;CheckBox.highlight&quot;, ControlHighlightColor,
            &quot;CheckBox.focus&quot;, buttonFocusColor,
            &quot;CheckBox.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                            &quot;SPACE&quot;, &quot;pressed&quot;,
                   &quot;released SPACE&quot;, &quot;released&quot;
                 }),
            // margin is 2 all the way around, BasicBorders.RadioButtonBorder
            // (checkbox uses RadioButtonBorder) is 2 all the way around too.
            &quot;CheckBox.totalInsets&quot;, new Insets(4, 4, 4, 4),

            &quot;CheckBoxMenuItem.font&quot;, MenuFont,
            &quot;CheckBoxMenuItem.background&quot;, MenuBackgroundColor,
            &quot;CheckBoxMenuItem.foreground&quot;, MenuTextColor,
            &quot;CheckBoxMenuItem.selectionForeground&quot;, SelectionTextColor,
            &quot;CheckBoxMenuItem.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;CheckBoxMenuItem.acceleratorForeground&quot;, MenuTextColor,
            &quot;CheckBoxMenuItem.acceleratorSelectionForeground&quot;, SelectionTextColor,
            &quot;CheckBoxMenuItem.commandSound&quot;, &quot;win.sound.menuCommand&quot;,

            &quot;ComboBox.font&quot;, ControlFont,
            &quot;ComboBox.background&quot;, WindowBackgroundColor,
            &quot;ComboBox.foreground&quot;, WindowTextColor,
            &quot;ComboBox.buttonBackground&quot;, ControlBackgroundColor,
            &quot;ComboBox.buttonShadow&quot;, ControlShadowColor,
            &quot;ComboBox.buttonDarkShadow&quot;, ControlDarkShadowColor,
            &quot;ComboBox.buttonHighlight&quot;, ControlHighlightColor,
            &quot;ComboBox.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;ComboBox.selectionForeground&quot;, SelectionTextColor,
            &quot;ComboBox.editorBorder&quot;, new XPValue(new EmptyBorder(1,2,1,1),
                                                 new EmptyBorder(1,4,1,4)),
            &quot;ComboBox.disabledBackground&quot;,
                        new XPColorValue(Part.CP_COMBOBOX, State.DISABLED,
                        Prop.FILLCOLOR, DisabledTextBackground),
            &quot;ComboBox.disabledForeground&quot;,
                        new XPColorValue(Part.CP_COMBOBOX, State.DISABLED,
                        Prop.TEXTCOLOR, InactiveTextColor),
            &quot;ComboBox.ancestorInputMap&quot;, new UIDefaults.LazyInputMap(new Object[] {
                   &quot;ESCAPE&quot;, &quot;hidePopup&quot;,
                  &quot;PAGE_UP&quot;, &quot;pageUpPassThrough&quot;,
                &quot;PAGE_DOWN&quot;, &quot;pageDownPassThrough&quot;,
                     &quot;HOME&quot;, &quot;homePassThrough&quot;,
                      &quot;END&quot;, &quot;endPassThrough&quot;,
                     &quot;DOWN&quot;, &quot;selectNext2&quot;,
                  &quot;KP_DOWN&quot;, &quot;selectNext2&quot;,
                       &quot;UP&quot;, &quot;selectPrevious2&quot;,
                    &quot;KP_UP&quot;, &quot;selectPrevious2&quot;,
                    &quot;ENTER&quot;, &quot;enterPressed&quot;,
                       &quot;F4&quot;, &quot;togglePopup&quot;,
                 &quot;alt DOWN&quot;, &quot;togglePopup&quot;,
              &quot;alt KP_DOWN&quot;, &quot;togglePopup&quot;,
                   &quot;alt UP&quot;, &quot;togglePopup&quot;,
                &quot;alt KP_UP&quot;, &quot;togglePopup&quot;
              }),

            // DeskTop.
            &quot;Desktop.background&quot;, new DesktopProperty(
                                                 &quot;win.desktop.backgroundColor&quot;,
                                                  table.get(&quot;desktop&quot;)),
            &quot;Desktop.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                   &quot;ctrl F5&quot;, &quot;restore&quot;,
                   &quot;ctrl F4&quot;, &quot;close&quot;,
                   &quot;ctrl F7&quot;, &quot;move&quot;,
                   &quot;ctrl F8&quot;, &quot;resize&quot;,
                   &quot;RIGHT&quot;, &quot;right&quot;,
                   &quot;KP_RIGHT&quot;, &quot;right&quot;,
                   &quot;LEFT&quot;, &quot;left&quot;,
                   &quot;KP_LEFT&quot;, &quot;left&quot;,
                   &quot;UP&quot;, &quot;up&quot;,
                   &quot;KP_UP&quot;, &quot;up&quot;,
                   &quot;DOWN&quot;, &quot;down&quot;,
                   &quot;KP_DOWN&quot;, &quot;down&quot;,
                   &quot;ESCAPE&quot;, &quot;escape&quot;,
                   &quot;ctrl F9&quot;, &quot;minimize&quot;,
                   &quot;ctrl F10&quot;, &quot;maximize&quot;,
                   &quot;ctrl F6&quot;, &quot;selectNextFrame&quot;,
                   &quot;ctrl TAB&quot;, &quot;selectNextFrame&quot;,
                   &quot;ctrl alt F6&quot;, &quot;selectNextFrame&quot;,
                   &quot;shift ctrl alt F6&quot;, &quot;selectPreviousFrame&quot;,
                   &quot;ctrl F12&quot;, &quot;navigateNext&quot;,
                   &quot;shift ctrl F12&quot;, &quot;navigatePrevious&quot;
               }),

            // DesktopIcon
            &quot;DesktopIcon.width&quot;, Integer.valueOf(160),

            &quot;EditorPane.font&quot;, ControlFont,
            &quot;EditorPane.background&quot;, WindowBackgroundColor,
            &quot;EditorPane.foreground&quot;, WindowTextColor,
            &quot;EditorPane.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;EditorPane.selectionForeground&quot;, SelectionTextColor,
            &quot;EditorPane.caretForeground&quot;, WindowTextColor,
            &quot;EditorPane.inactiveForeground&quot;, InactiveTextColor,
            &quot;EditorPane.inactiveBackground&quot;, WindowBackgroundColor,
            &quot;EditorPane.disabledBackground&quot;, DisabledTextBackground,

            &quot;FileChooser.homeFolderIcon&quot;,  new LazyWindowsIcon(null,
                                                               &quot;icons/HomeFolder.gif&quot;),
            &quot;FileChooser.listFont&quot;, IconFont,
            &quot;FileChooser.listViewBackground&quot;, new XPColorValue(Part.LVP_LISTVIEW, null, Prop.FILLCOLOR,
                                                               WindowBackgroundColor),
            &quot;FileChooser.listViewBorder&quot;, new XPBorderValue(Part.LVP_LISTVIEW,
                                                  new SwingLazyValue(
                                                        &quot;javax.swing.plaf.BorderUIResource&quot;,
                                                        &quot;getLoweredBevelBorderUIResource&quot;)),
            &quot;FileChooser.listViewIcon&quot;,    new LazyWindowsIcon(&quot;fileChooserIcon ListView&quot;,
                                                               &quot;icons/ListView.gif&quot;),
            &quot;FileChooser.listViewWindowsStyle&quot;, Boolean.TRUE,
            &quot;FileChooser.detailsViewIcon&quot;, new LazyWindowsIcon(&quot;fileChooserIcon DetailsView&quot;,
                                                               &quot;icons/DetailsView.gif&quot;),
            &quot;FileChooser.viewMenuIcon&quot;, new LazyWindowsIcon(&quot;fileChooserIcon ViewMenu&quot;,
                                                            &quot;icons/ListView.gif&quot;),
            &quot;FileChooser.upFolderIcon&quot;,    new LazyWindowsIcon(&quot;fileChooserIcon UpFolder&quot;,
                                                               &quot;icons/UpFolder.gif&quot;),
            &quot;FileChooser.newFolderIcon&quot;,   new LazyWindowsIcon(&quot;fileChooserIcon NewFolder&quot;,
                                                               &quot;icons/NewFolder.gif&quot;),
            &quot;FileChooser.useSystemExtensionHiding&quot;, Boolean.TRUE,

            &quot;FileChooser.usesSingleFilePane&quot;, Boolean.TRUE,
            &quot;FileChooser.noPlacesBar&quot;, new DesktopProperty(&quot;win.comdlg.noPlacesBar&quot;,
                                                           Boolean.FALSE),
            &quot;FileChooser.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                     &quot;ESCAPE&quot;, &quot;cancelSelection&quot;,
                     &quot;F2&quot;, &quot;editFileName&quot;,
                     &quot;F5&quot;, &quot;refresh&quot;,
                     &quot;BACK_SPACE&quot;, &quot;Go Up&quot;
                 }),

            &quot;FileView.directoryIcon&quot;, SwingUtilities2.makeIcon(getClass(),
                                                               WindowsLookAndFeel.class,
                                                               &quot;icons/Directory.gif&quot;),
            &quot;FileView.fileIcon&quot;, SwingUtilities2.makeIcon(getClass(),
                                                          WindowsLookAndFeel.class,
                                                          &quot;icons/File.gif&quot;),
            &quot;FileView.computerIcon&quot;, SwingUtilities2.makeIcon(getClass(),
                                                              WindowsLookAndFeel.class,
                                                              &quot;icons/Computer.gif&quot;),
            &quot;FileView.hardDriveIcon&quot;, SwingUtilities2.makeIcon(getClass(),
                                                               WindowsLookAndFeel.class,
                                                               &quot;icons/HardDrive.gif&quot;),
            &quot;FileView.floppyDriveIcon&quot;, SwingUtilities2.makeIcon(getClass(),
                                                                 WindowsLookAndFeel.class,
                                                                 &quot;icons/FloppyDrive.gif&quot;),

            &quot;FormattedTextField.font&quot;, ControlFont,
            &quot;InternalFrame.titleFont&quot;, WindowFont,
            &quot;InternalFrame.titlePaneHeight&quot;,   TitlePaneHeight,
            &quot;InternalFrame.titleButtonWidth&quot;,  TitleButtonWidth,
            &quot;InternalFrame.titleButtonHeight&quot;, TitleButtonHeight,
            &quot;InternalFrame.titleButtonToolTipsOn&quot;, hotTrackingOn,
            &quot;InternalFrame.borderColor&quot;, ControlBackgroundColor,
            &quot;InternalFrame.borderShadow&quot;, ControlShadowColor,
            &quot;InternalFrame.borderDarkShadow&quot;, ControlDarkShadowColor,
            &quot;InternalFrame.borderHighlight&quot;, ControlHighlightColor,
            &quot;InternalFrame.borderLight&quot;, ControlLightColor,
            &quot;InternalFrame.borderWidth&quot;, WindowBorderWidth,
            &quot;InternalFrame.minimizeIconBackground&quot;, ControlBackgroundColor,
            &quot;InternalFrame.resizeIconHighlight&quot;, ControlLightColor,
            &quot;InternalFrame.resizeIconShadow&quot;, ControlShadowColor,
            &quot;InternalFrame.activeBorderColor&quot;, new DesktopProperty(
                                                       &quot;win.frame.activeBorderColor&quot;,
                                                       table.get(&quot;windowBorder&quot;)),
            &quot;InternalFrame.inactiveBorderColor&quot;, new DesktopProperty(
                                                       &quot;win.frame.inactiveBorderColor&quot;,
                                                       table.get(&quot;windowBorder&quot;)),
            &quot;InternalFrame.activeTitleBackground&quot;, new DesktopProperty(
                                                        &quot;win.frame.activeCaptionColor&quot;,
                                                         table.get(&quot;activeCaption&quot;)),
            &quot;InternalFrame.activeTitleGradient&quot;, new DesktopProperty(
                                                        &quot;win.frame.activeCaptionGradientColor&quot;,
                                                         table.get(&quot;activeCaption&quot;)),
            &quot;InternalFrame.activeTitleForeground&quot;, new DesktopProperty(
                                                        &quot;win.frame.captionTextColor&quot;,
                                                         table.get(&quot;activeCaptionText&quot;)),
            &quot;InternalFrame.inactiveTitleBackground&quot;, new DesktopProperty(
                                                        &quot;win.frame.inactiveCaptionColor&quot;,
                                                         table.get(&quot;inactiveCaption&quot;)),
            &quot;InternalFrame.inactiveTitleGradient&quot;, new DesktopProperty(
                                                        &quot;win.frame.inactiveCaptionGradientColor&quot;,
                                                         table.get(&quot;inactiveCaption&quot;)),
            &quot;InternalFrame.inactiveTitleForeground&quot;, new DesktopProperty(
                                                        &quot;win.frame.inactiveCaptionTextColor&quot;,
                                                         table.get(&quot;inactiveCaptionText&quot;)),

            &quot;InternalFrame.maximizeIcon&quot;,
                WindowsIconFactory.createFrameMaximizeIcon(),
            &quot;InternalFrame.minimizeIcon&quot;,
                WindowsIconFactory.createFrameMinimizeIcon(),
            &quot;InternalFrame.iconifyIcon&quot;,
                WindowsIconFactory.createFrameIconifyIcon(),
            &quot;InternalFrame.closeIcon&quot;,
                WindowsIconFactory.createFrameCloseIcon(),
            &quot;InternalFrame.icon&quot;,
                new SwingLazyValue(
        &quot;com.sun.java.swing.plaf.windows.WindowsInternalFrameTitlePane$ScalableIconUIResource&quot;,
                    // The constructor takes one arg: an array of UIDefaults.LazyValue
                    // representing the icons
                    new Object[][] { {
                        SwingUtilities2.makeIcon(getClass(), BasicLookAndFeel.class, &quot;icons/JavaCup16.png&quot;),
                        SwingUtilities2.makeIcon(getClass(), WindowsLookAndFeel.class, &quot;icons/JavaCup32.png&quot;)
                    } }),

            // Internal Frame Auditory Cue Mappings
            &quot;InternalFrame.closeSound&quot;, &quot;win.sound.close&quot;,
            &quot;InternalFrame.maximizeSound&quot;, &quot;win.sound.maximize&quot;,
            &quot;InternalFrame.minimizeSound&quot;, &quot;win.sound.minimize&quot;,
            &quot;InternalFrame.restoreDownSound&quot;, &quot;win.sound.restoreDown&quot;,
            &quot;InternalFrame.restoreUpSound&quot;, &quot;win.sound.restoreUp&quot;,

            &quot;InternalFrame.windowBindings&quot;, new Object[] {
                &quot;shift ESCAPE&quot;, &quot;showSystemMenu&quot;,
                  &quot;ctrl SPACE&quot;, &quot;showSystemMenu&quot;,
                      &quot;ESCAPE&quot;, &quot;hideSystemMenu&quot;},

            // Label
            &quot;Label.font&quot;, ControlFont,
            &quot;Label.background&quot;, ControlBackgroundColor,
            &quot;Label.foreground&quot;, WindowTextColor,
            &quot;Label.disabledForeground&quot;, InactiveTextColor,
            &quot;Label.disabledShadow&quot;, ControlHighlightColor,

            // List.
            &quot;List.font&quot;, ControlFont,
            &quot;List.background&quot;, WindowBackgroundColor,
            &quot;List.foreground&quot;, WindowTextColor,
            &quot;List.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;List.selectionForeground&quot;, SelectionTextColor,
            &quot;List.lockToPositionOnScroll&quot;, Boolean.TRUE,
            &quot;List.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                           &quot;ctrl C&quot;, &quot;copy&quot;,
                           &quot;ctrl V&quot;, &quot;paste&quot;,
                           &quot;ctrl X&quot;, &quot;cut&quot;,
                             &quot;COPY&quot;, &quot;copy&quot;,
                            &quot;PASTE&quot;, &quot;paste&quot;,
                              &quot;CUT&quot;, &quot;cut&quot;,
                   &quot;control INSERT&quot;, &quot;copy&quot;,
                     &quot;shift INSERT&quot;, &quot;paste&quot;,
                     &quot;shift DELETE&quot;, &quot;cut&quot;,
                               &quot;UP&quot;, &quot;selectPreviousRow&quot;,
                            &quot;KP_UP&quot;, &quot;selectPreviousRow&quot;,
                         &quot;shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                      &quot;shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                    &quot;ctrl shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                 &quot;ctrl shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                          &quot;ctrl UP&quot;, &quot;selectPreviousRowChangeLead&quot;,
                       &quot;ctrl KP_UP&quot;, &quot;selectPreviousRowChangeLead&quot;,
                             &quot;DOWN&quot;, &quot;selectNextRow&quot;,
                          &quot;KP_DOWN&quot;, &quot;selectNextRow&quot;,
                       &quot;shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                    &quot;shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                  &quot;ctrl shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
               &quot;ctrl shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                        &quot;ctrl DOWN&quot;, &quot;selectNextRowChangeLead&quot;,
                     &quot;ctrl KP_DOWN&quot;, &quot;selectNextRowChangeLead&quot;,
                             &quot;LEFT&quot;, &quot;selectPreviousColumn&quot;,
                          &quot;KP_LEFT&quot;, &quot;selectPreviousColumn&quot;,
                       &quot;shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                    &quot;shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                  &quot;ctrl shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
               &quot;ctrl shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                        &quot;ctrl LEFT&quot;, &quot;selectPreviousColumnChangeLead&quot;,
                     &quot;ctrl KP_LEFT&quot;, &quot;selectPreviousColumnChangeLead&quot;,
                            &quot;RIGHT&quot;, &quot;selectNextColumn&quot;,
                         &quot;KP_RIGHT&quot;, &quot;selectNextColumn&quot;,
                      &quot;shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                   &quot;shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                 &quot;ctrl shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
              &quot;ctrl shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                       &quot;ctrl RIGHT&quot;, &quot;selectNextColumnChangeLead&quot;,
                    &quot;ctrl KP_RIGHT&quot;, &quot;selectNextColumnChangeLead&quot;,
                             &quot;HOME&quot;, &quot;selectFirstRow&quot;,
                       &quot;shift HOME&quot;, &quot;selectFirstRowExtendSelection&quot;,
                  &quot;ctrl shift HOME&quot;, &quot;selectFirstRowExtendSelection&quot;,
                        &quot;ctrl HOME&quot;, &quot;selectFirstRowChangeLead&quot;,
                              &quot;END&quot;, &quot;selectLastRow&quot;,
                        &quot;shift END&quot;, &quot;selectLastRowExtendSelection&quot;,
                   &quot;ctrl shift END&quot;, &quot;selectLastRowExtendSelection&quot;,
                         &quot;ctrl END&quot;, &quot;selectLastRowChangeLead&quot;,
                          &quot;PAGE_UP&quot;, &quot;scrollUp&quot;,
                    &quot;shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
               &quot;ctrl shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
                     &quot;ctrl PAGE_UP&quot;, &quot;scrollUpChangeLead&quot;,
                        &quot;PAGE_DOWN&quot;, &quot;scrollDown&quot;,
                  &quot;shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
             &quot;ctrl shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
                   &quot;ctrl PAGE_DOWN&quot;, &quot;scrollDownChangeLead&quot;,
                           &quot;ctrl A&quot;, &quot;selectAll&quot;,
                       &quot;ctrl SLASH&quot;, &quot;selectAll&quot;,
                  &quot;ctrl BACK_SLASH&quot;, &quot;clearSelection&quot;,
                            &quot;SPACE&quot;, &quot;addToSelection&quot;,
                       &quot;ctrl SPACE&quot;, &quot;toggleAndAnchor&quot;,
                      &quot;shift SPACE&quot;, &quot;extendTo&quot;,
                 &quot;ctrl shift SPACE&quot;, &quot;moveSelectionTo&quot;
                 }),

            // PopupMenu
            &quot;PopupMenu.font&quot;, MenuFont,
            &quot;PopupMenu.background&quot;, MenuBackgroundColor,
            &quot;PopupMenu.foreground&quot;, MenuTextColor,
            &quot;PopupMenu.popupSound&quot;, &quot;win.sound.menuPopup&quot;,
            &quot;PopupMenu.consumeEventOnClose&quot;, Boolean.TRUE,

            // Menus
            &quot;Menu.font&quot;, MenuFont,
            &quot;Menu.foreground&quot;, MenuTextColor,
            &quot;Menu.background&quot;, MenuBackgroundColor,
            &quot;Menu.useMenuBarBackgroundForTopLevel&quot;, Boolean.TRUE,
            &quot;Menu.selectionForeground&quot;, SelectionTextColor,
            &quot;Menu.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;Menu.acceleratorForeground&quot;, MenuTextColor,
            &quot;Menu.acceleratorSelectionForeground&quot;, SelectionTextColor,
            &quot;Menu.menuPopupOffsetX&quot;, Integer.valueOf(0),
            &quot;Menu.menuPopupOffsetY&quot;, Integer.valueOf(0),
            &quot;Menu.submenuPopupOffsetX&quot;, Integer.valueOf(-4),
            &quot;Menu.submenuPopupOffsetY&quot;, Integer.valueOf(-3),
            &quot;Menu.crossMenuMnemonic&quot;, Boolean.FALSE,
            &quot;Menu.preserveTopLevelSelection&quot;, Boolean.TRUE,

            // MenuBar.
            &quot;MenuBar.font&quot;, MenuFont,
            &quot;MenuBar.background&quot;, new XPValue(MenuBarBackgroundColor,
                                              MenuBackgroundColor),
            &quot;MenuBar.foreground&quot;, MenuTextColor,
            &quot;MenuBar.shadow&quot;, ControlShadowColor,
            &quot;MenuBar.highlight&quot;, ControlHighlightColor,
            &quot;MenuBar.height&quot;, menuBarHeight,
            &quot;MenuBar.rolloverEnabled&quot;, hotTrackingOn,
            &quot;MenuBar.windowBindings&quot;, new Object[] {
                &quot;F10&quot;, &quot;takeFocus&quot; },

            &quot;MenuItem.font&quot;, MenuFont,
            &quot;MenuItem.acceleratorFont&quot;, MenuFont,
            &quot;MenuItem.foreground&quot;, MenuTextColor,
            &quot;MenuItem.background&quot;, MenuBackgroundColor,
            &quot;MenuItem.selectionForeground&quot;, SelectionTextColor,
            &quot;MenuItem.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;MenuItem.disabledForeground&quot;, InactiveTextColor,
            &quot;MenuItem.acceleratorForeground&quot;, MenuTextColor,
            &quot;MenuItem.acceleratorSelectionForeground&quot;, SelectionTextColor,
            &quot;MenuItem.acceleratorDelimiter&quot;, menuItemAcceleratorDelimiter,
                 // Menu Item Auditory Cue Mapping
            &quot;MenuItem.commandSound&quot;, &quot;win.sound.menuCommand&quot;,
             // indicates that keyboard navigation won't skip disabled menu items
            &quot;MenuItem.disabledAreNavigable&quot;, Boolean.TRUE,

            &quot;RadioButton.font&quot;, ControlFont,
            &quot;RadioButton.interiorBackground&quot;, WindowBackgroundColor,
            &quot;RadioButton.background&quot;, ControlBackgroundColor,
            &quot;RadioButton.foreground&quot;, WindowTextColor,
            &quot;RadioButton.shadow&quot;, ControlShadowColor,
            &quot;RadioButton.darkShadow&quot;, ControlDarkShadowColor,
            &quot;RadioButton.light&quot;, ControlLightColor,
            &quot;RadioButton.highlight&quot;, ControlHighlightColor,
            &quot;RadioButton.focus&quot;, buttonFocusColor,
            &quot;RadioButton.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                          &quot;SPACE&quot;, &quot;pressed&quot;,
                 &quot;released SPACE&quot;, &quot;released&quot;
              }),
            // margin is 2 all the way around, BasicBorders.RadioButtonBorder
            // is 2 all the way around too.
            &quot;RadioButton.totalInsets&quot;, new Insets(4, 4, 4, 4),


            &quot;RadioButtonMenuItem.font&quot;, MenuFont,
            &quot;RadioButtonMenuItem.foreground&quot;, MenuTextColor,
            &quot;RadioButtonMenuItem.background&quot;, MenuBackgroundColor,
            &quot;RadioButtonMenuItem.selectionForeground&quot;, SelectionTextColor,
            &quot;RadioButtonMenuItem.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;RadioButtonMenuItem.disabledForeground&quot;, InactiveTextColor,
            &quot;RadioButtonMenuItem.acceleratorForeground&quot;, MenuTextColor,
            &quot;RadioButtonMenuItem.acceleratorSelectionForeground&quot;, SelectionTextColor,
            &quot;RadioButtonMenuItem.commandSound&quot;, &quot;win.sound.menuCommand&quot;,

            // OptionPane.
            &quot;OptionPane.font&quot;, MessageFont,
            &quot;OptionPane.messageFont&quot;, MessageFont,
            &quot;OptionPane.buttonFont&quot;, MessageFont,
            &quot;OptionPane.background&quot;, ControlBackgroundColor,
            &quot;OptionPane.foreground&quot;, WindowTextColor,
            &quot;OptionPane.buttonMinimumWidth&quot;, new XPDLUValue(50, 50, SwingConstants.EAST),
            &quot;OptionPane.messageForeground&quot;, ControlTextColor,
            &quot;OptionPane.errorIcon&quot;,       new LazyWindowsIcon(&quot;optionPaneIcon Error&quot;,
                                                              &quot;icons/Error.gif&quot;),
            &quot;OptionPane.informationIcon&quot;, new LazyWindowsIcon(&quot;optionPaneIcon Information&quot;,
                                                              &quot;icons/Inform.gif&quot;),
            &quot;OptionPane.questionIcon&quot;,    new LazyWindowsIcon(&quot;optionPaneIcon Question&quot;,
                                                              &quot;icons/Question.gif&quot;),
            &quot;OptionPane.warningIcon&quot;,     new LazyWindowsIcon(&quot;optionPaneIcon Warning&quot;,
                                                              &quot;icons/Warn.gif&quot;),
            &quot;OptionPane.windowBindings&quot;, new Object[] {
                &quot;ESCAPE&quot;, &quot;close&quot; },
                 // Option Pane Auditory Cue Mappings
            &quot;OptionPane.errorSound&quot;, &quot;win.sound.hand&quot;, // Error
            &quot;OptionPane.informationSound&quot;, &quot;win.sound.asterisk&quot;, // Info Plain
            &quot;OptionPane.questionSound&quot;, &quot;win.sound.question&quot;, // Question
            &quot;OptionPane.warningSound&quot;, &quot;win.sound.exclamation&quot;, // Warning

            &quot;FormattedTextField.focusInputMap&quot;,
              new UIDefaults.LazyInputMap(new Object[] {
                           &quot;ctrl C&quot;, DefaultEditorKit.copyAction,
                           &quot;ctrl V&quot;, DefaultEditorKit.pasteAction,
                           &quot;ctrl X&quot;, DefaultEditorKit.cutAction,
                             &quot;COPY&quot;, DefaultEditorKit.copyAction,
                            &quot;PASTE&quot;, DefaultEditorKit.pasteAction,
                              &quot;CUT&quot;, DefaultEditorKit.cutAction,
                   &quot;control INSERT&quot;, DefaultEditorKit.copyAction,
                     &quot;shift INSERT&quot;, DefaultEditorKit.pasteAction,
                     &quot;shift DELETE&quot;, DefaultEditorKit.cutAction,
                       &quot;shift LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
                    &quot;shift KP_LEFT&quot;, DefaultEditorKit.selectionBackwardAction,
                      &quot;shift RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
                   &quot;shift KP_RIGHT&quot;, DefaultEditorKit.selectionForwardAction,
                        &quot;ctrl LEFT&quot;, DefaultEditorKit.previousWordAction,
                     &quot;ctrl KP_LEFT&quot;, DefaultEditorKit.previousWordAction,
                       &quot;ctrl RIGHT&quot;, DefaultEditorKit.nextWordAction,
                    &quot;ctrl KP_RIGHT&quot;, DefaultEditorKit.nextWordAction,
                  &quot;ctrl shift LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
               &quot;ctrl shift KP_LEFT&quot;, DefaultEditorKit.selectionPreviousWordAction,
                 &quot;ctrl shift RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
              &quot;ctrl shift KP_RIGHT&quot;, DefaultEditorKit.selectionNextWordAction,
                           &quot;ctrl A&quot;, DefaultEditorKit.selectAllAction,
                             &quot;HOME&quot;, DefaultEditorKit.beginLineAction,
                              &quot;END&quot;, DefaultEditorKit.endLineAction,
                       &quot;shift HOME&quot;, DefaultEditorKit.selectionBeginLineAction,
                        &quot;shift END&quot;, DefaultEditorKit.selectionEndLineAction,
                       &quot;BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
                 &quot;shift BACK_SPACE&quot;, DefaultEditorKit.deletePrevCharAction,
                           &quot;ctrl H&quot;, DefaultEditorKit.deletePrevCharAction,
                           &quot;DELETE&quot;, DefaultEditorKit.deleteNextCharAction,
                      &quot;ctrl DELETE&quot;, DefaultEditorKit.deleteNextWordAction,
                  &quot;ctrl BACK_SPACE&quot;, DefaultEditorKit.deletePrevWordAction,
                            &quot;RIGHT&quot;, DefaultEditorKit.forwardAction,
                             &quot;LEFT&quot;, DefaultEditorKit.backwardAction,
                         &quot;KP_RIGHT&quot;, DefaultEditorKit.forwardAction,
                          &quot;KP_LEFT&quot;, DefaultEditorKit.backwardAction,
                            &quot;ENTER&quot;, JTextField.notifyAction,
                  &quot;ctrl BACK_SLASH&quot;, &quot;unselect&quot;,
                   &quot;control shift O&quot;, &quot;toggle-componentOrientation&quot;,
                           &quot;ESCAPE&quot;, &quot;reset-field-edit&quot;,
                               &quot;UP&quot;, &quot;increment&quot;,
                            &quot;KP_UP&quot;, &quot;increment&quot;,
                             &quot;DOWN&quot;, &quot;decrement&quot;,
                          &quot;KP_DOWN&quot;, &quot;decrement&quot;,
              }),
            &quot;FormattedTextField.inactiveBackground&quot;, ReadOnlyTextBackground,
            &quot;FormattedTextField.disabledBackground&quot;, DisabledTextBackground,

            // *** Panel
            &quot;Panel.font&quot;, ControlFont,
            &quot;Panel.background&quot;, ControlBackgroundColor,
            &quot;Panel.foreground&quot;, WindowTextColor,

            // *** PasswordField
            &quot;PasswordField.font&quot;, ControlFont,
            &quot;PasswordField.background&quot;, TextBackground,
            &quot;PasswordField.foreground&quot;, WindowTextColor,
            &quot;PasswordField.inactiveForeground&quot;, InactiveTextColor,      // for disabled
            &quot;PasswordField.inactiveBackground&quot;, ReadOnlyTextBackground, // for readonly
            &quot;PasswordField.disabledBackground&quot;, DisabledTextBackground, // for disabled
            &quot;PasswordField.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;PasswordField.selectionForeground&quot;, SelectionTextColor,
            &quot;PasswordField.caretForeground&quot;,WindowTextColor,
            &quot;PasswordField.echoChar&quot;, new XPValue(new Character((char)0x25CF),
                                                  new Character('*')),

            // *** ProgressBar
            &quot;ProgressBar.font&quot;, ControlFont,
            &quot;ProgressBar.foreground&quot;,  SelectionBackgroundColor,
            &quot;ProgressBar.background&quot;, ControlBackgroundColor,
            &quot;ProgressBar.shadow&quot;, ControlShadowColor,
            &quot;ProgressBar.highlight&quot;, ControlHighlightColor,
            &quot;ProgressBar.selectionForeground&quot;, ControlBackgroundColor,
            &quot;ProgressBar.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;ProgressBar.cellLength&quot;, Integer.valueOf(7),
            &quot;ProgressBar.cellSpacing&quot;, Integer.valueOf(2),
            &quot;ProgressBar.indeterminateInsets&quot;, new Insets(3, 3, 3, 3),

            // *** RootPane.
            // These bindings are only enabled when there is a default
            // button set on the rootpane.
            &quot;RootPane.defaultButtonWindowKeyBindings&quot;, new Object[] {
                             &quot;ENTER&quot;, &quot;press&quot;,
                    &quot;released ENTER&quot;, &quot;release&quot;,
                        &quot;ctrl ENTER&quot;, &quot;press&quot;,
               &quot;ctrl released ENTER&quot;, &quot;release&quot;
              },

            // *** ScrollBar.
            &quot;ScrollBar.background&quot;, ScrollbarBackgroundColor,
            &quot;ScrollBar.foreground&quot;, ControlBackgroundColor,
            &quot;ScrollBar.track&quot;, white,
            &quot;ScrollBar.trackForeground&quot;, ScrollbarBackgroundColor,
            &quot;ScrollBar.trackHighlight&quot;, black,
            &quot;ScrollBar.trackHighlightForeground&quot;, scrollBarTrackHighlight,
            &quot;ScrollBar.thumb&quot;, ControlBackgroundColor,
            &quot;ScrollBar.thumbHighlight&quot;, ControlHighlightColor,
            &quot;ScrollBar.thumbDarkShadow&quot;, ControlDarkShadowColor,
            &quot;ScrollBar.thumbShadow&quot;, ControlShadowColor,
            &quot;ScrollBar.width&quot;, scrollBarWidth,
            &quot;ScrollBar.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                       &quot;RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
                    &quot;KP_RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
                        &quot;DOWN&quot;, &quot;positiveUnitIncrement&quot;,
                     &quot;KP_DOWN&quot;, &quot;positiveUnitIncrement&quot;,
                   &quot;PAGE_DOWN&quot;, &quot;positiveBlockIncrement&quot;,
              &quot;ctrl PAGE_DOWN&quot;, &quot;positiveBlockIncrement&quot;,
                        &quot;LEFT&quot;, &quot;negativeUnitIncrement&quot;,
                     &quot;KP_LEFT&quot;, &quot;negativeUnitIncrement&quot;,
                          &quot;UP&quot;, &quot;negativeUnitIncrement&quot;,
                       &quot;KP_UP&quot;, &quot;negativeUnitIncrement&quot;,
                     &quot;PAGE_UP&quot;, &quot;negativeBlockIncrement&quot;,
                &quot;ctrl PAGE_UP&quot;, &quot;negativeBlockIncrement&quot;,
                        &quot;HOME&quot;, &quot;minScroll&quot;,
                         &quot;END&quot;, &quot;maxScroll&quot;
                 }),

            // *** ScrollPane.
            &quot;ScrollPane.font&quot;, ControlFont,
            &quot;ScrollPane.background&quot;, ControlBackgroundColor,
            &quot;ScrollPane.foreground&quot;, ControlTextColor,
            &quot;ScrollPane.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                           &quot;RIGHT&quot;, &quot;unitScrollRight&quot;,
                        &quot;KP_RIGHT&quot;, &quot;unitScrollRight&quot;,
                            &quot;DOWN&quot;, &quot;unitScrollDown&quot;,
                         &quot;KP_DOWN&quot;, &quot;unitScrollDown&quot;,
                            &quot;LEFT&quot;, &quot;unitScrollLeft&quot;,
                         &quot;KP_LEFT&quot;, &quot;unitScrollLeft&quot;,
                              &quot;UP&quot;, &quot;unitScrollUp&quot;,
                           &quot;KP_UP&quot;, &quot;unitScrollUp&quot;,
                         &quot;PAGE_UP&quot;, &quot;scrollUp&quot;,
                       &quot;PAGE_DOWN&quot;, &quot;scrollDown&quot;,
                    &quot;ctrl PAGE_UP&quot;, &quot;scrollLeft&quot;,
                  &quot;ctrl PAGE_DOWN&quot;, &quot;scrollRight&quot;,
                       &quot;ctrl HOME&quot;, &quot;scrollHome&quot;,
                        &quot;ctrl END&quot;, &quot;scrollEnd&quot;
                 }),

            // *** Separator
            &quot;Separator.background&quot;, ControlHighlightColor,
            &quot;Separator.foreground&quot;, ControlShadowColor,

            // *** Slider.
            &quot;Slider.font&quot;, ControlFont,
            &quot;Slider.foreground&quot;, ControlBackgroundColor,
            &quot;Slider.background&quot;, ControlBackgroundColor,
            &quot;Slider.highlight&quot;, ControlHighlightColor,
            &quot;Slider.shadow&quot;, ControlShadowColor,
            &quot;Slider.focus&quot;, ControlDarkShadowColor,
            &quot;Slider.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                       &quot;RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
                    &quot;KP_RIGHT&quot;, &quot;positiveUnitIncrement&quot;,
                        &quot;DOWN&quot;, &quot;negativeUnitIncrement&quot;,
                     &quot;KP_DOWN&quot;, &quot;negativeUnitIncrement&quot;,
                   &quot;PAGE_DOWN&quot;, &quot;negativeBlockIncrement&quot;,
                        &quot;LEFT&quot;, &quot;negativeUnitIncrement&quot;,
                     &quot;KP_LEFT&quot;, &quot;negativeUnitIncrement&quot;,
                          &quot;UP&quot;, &quot;positiveUnitIncrement&quot;,
                       &quot;KP_UP&quot;, &quot;positiveUnitIncrement&quot;,
                     &quot;PAGE_UP&quot;, &quot;positiveBlockIncrement&quot;,
                        &quot;HOME&quot;, &quot;minScroll&quot;,
                         &quot;END&quot;, &quot;maxScroll&quot;
                 }),

            // Spinner
            &quot;Spinner.font&quot;, ControlFont,
            &quot;Spinner.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                               &quot;UP&quot;, &quot;increment&quot;,
                            &quot;KP_UP&quot;, &quot;increment&quot;,
                             &quot;DOWN&quot;, &quot;decrement&quot;,
                          &quot;KP_DOWN&quot;, &quot;decrement&quot;,
               }),

            // *** SplitPane
            &quot;SplitPane.background&quot;, ControlBackgroundColor,
            &quot;SplitPane.highlight&quot;, ControlHighlightColor,
            &quot;SplitPane.shadow&quot;, ControlShadowColor,
            &quot;SplitPane.darkShadow&quot;, ControlDarkShadowColor,
            &quot;SplitPane.dividerSize&quot;, Integer.valueOf(5),
            &quot;SplitPane.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                        &quot;UP&quot;, &quot;negativeIncrement&quot;,
                      &quot;DOWN&quot;, &quot;positiveIncrement&quot;,
                      &quot;LEFT&quot;, &quot;negativeIncrement&quot;,
                     &quot;RIGHT&quot;, &quot;positiveIncrement&quot;,
                     &quot;KP_UP&quot;, &quot;negativeIncrement&quot;,
                   &quot;KP_DOWN&quot;, &quot;positiveIncrement&quot;,
                   &quot;KP_LEFT&quot;, &quot;negativeIncrement&quot;,
                  &quot;KP_RIGHT&quot;, &quot;positiveIncrement&quot;,
                      &quot;HOME&quot;, &quot;selectMin&quot;,
                       &quot;END&quot;, &quot;selectMax&quot;,
                        &quot;F8&quot;, &quot;startResize&quot;,
                        &quot;F6&quot;, &quot;toggleFocus&quot;,
                  &quot;ctrl TAB&quot;, &quot;focusOutForward&quot;,
            &quot;ctrl shift TAB&quot;, &quot;focusOutBackward&quot;
               }),

            // *** TabbedPane
            &quot;TabbedPane.tabsOverlapBorder&quot;, new XPValue(Boolean.TRUE, Boolean.FALSE),
            &quot;TabbedPane.tabInsets&quot;,         new XPValue(new InsetsUIResource(1, 4, 1, 4),
                                                        new InsetsUIResource(0, 4, 1, 4)),
            &quot;TabbedPane.tabAreaInsets&quot;,     new XPValue(new InsetsUIResource(3, 2, 2, 2),
                                                        new InsetsUIResource(3, 2, 0, 2)),
            &quot;TabbedPane.font&quot;, ControlFont,
            &quot;TabbedPane.background&quot;, ControlBackgroundColor,
            &quot;TabbedPane.foreground&quot;, ControlTextColor,
            &quot;TabbedPane.highlight&quot;, ControlHighlightColor,
            &quot;TabbedPane.light&quot;, ControlLightColor,
            &quot;TabbedPane.shadow&quot;, ControlShadowColor,
            &quot;TabbedPane.darkShadow&quot;, ControlDarkShadowColor,
            &quot;TabbedPane.focus&quot;, ControlTextColor,
            &quot;TabbedPane.focusInputMap&quot;,
              new UIDefaults.LazyInputMap(new Object[] {
                         &quot;RIGHT&quot;, &quot;navigateRight&quot;,
                      &quot;KP_RIGHT&quot;, &quot;navigateRight&quot;,
                          &quot;LEFT&quot;, &quot;navigateLeft&quot;,
                       &quot;KP_LEFT&quot;, &quot;navigateLeft&quot;,
                            &quot;UP&quot;, &quot;navigateUp&quot;,
                         &quot;KP_UP&quot;, &quot;navigateUp&quot;,
                          &quot;DOWN&quot;, &quot;navigateDown&quot;,
                       &quot;KP_DOWN&quot;, &quot;navigateDown&quot;,
                     &quot;ctrl DOWN&quot;, &quot;requestFocusForVisibleComponent&quot;,
                  &quot;ctrl KP_DOWN&quot;, &quot;requestFocusForVisibleComponent&quot;,
                }),
            &quot;TabbedPane.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                         &quot;ctrl TAB&quot;, &quot;navigateNext&quot;,
                   &quot;ctrl shift TAB&quot;, &quot;navigatePrevious&quot;,
                   &quot;ctrl PAGE_DOWN&quot;, &quot;navigatePageDown&quot;,
                     &quot;ctrl PAGE_UP&quot;, &quot;navigatePageUp&quot;,
                          &quot;ctrl UP&quot;, &quot;requestFocus&quot;,
                       &quot;ctrl KP_UP&quot;, &quot;requestFocus&quot;,
                 }),

            // *** Table
            &quot;Table.font&quot;, ControlFont,
            &quot;Table.foreground&quot;, ControlTextColor,  // cell text color
            &quot;Table.background&quot;, WindowBackgroundColor,  // cell background color
            &quot;Table.highlight&quot;, ControlHighlightColor,
            &quot;Table.light&quot;, ControlLightColor,
            &quot;Table.shadow&quot;, ControlShadowColor,
            &quot;Table.darkShadow&quot;, ControlDarkShadowColor,
            &quot;Table.selectionForeground&quot;, SelectionTextColor,
            &quot;Table.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;Table.gridColor&quot;, gray,  // grid line color
            &quot;Table.focusCellBackground&quot;, WindowBackgroundColor,
            &quot;Table.focusCellForeground&quot;, ControlTextColor,
            &quot;Table.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                               &quot;ctrl C&quot;, &quot;copy&quot;,
                               &quot;ctrl V&quot;, &quot;paste&quot;,
                               &quot;ctrl X&quot;, &quot;cut&quot;,
                                 &quot;COPY&quot;, &quot;copy&quot;,
                                &quot;PASTE&quot;, &quot;paste&quot;,
                                  &quot;CUT&quot;, &quot;cut&quot;,
                       &quot;control INSERT&quot;, &quot;copy&quot;,
                         &quot;shift INSERT&quot;, &quot;paste&quot;,
                         &quot;shift DELETE&quot;, &quot;cut&quot;,
                                &quot;RIGHT&quot;, &quot;selectNextColumn&quot;,
                             &quot;KP_RIGHT&quot;, &quot;selectNextColumn&quot;,
                          &quot;shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                       &quot;shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                     &quot;ctrl shift RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                  &quot;ctrl shift KP_RIGHT&quot;, &quot;selectNextColumnExtendSelection&quot;,
                           &quot;ctrl RIGHT&quot;, &quot;selectNextColumnChangeLead&quot;,
                        &quot;ctrl KP_RIGHT&quot;, &quot;selectNextColumnChangeLead&quot;,
                                 &quot;LEFT&quot;, &quot;selectPreviousColumn&quot;,
                              &quot;KP_LEFT&quot;, &quot;selectPreviousColumn&quot;,
                           &quot;shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                        &quot;shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                      &quot;ctrl shift LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                   &quot;ctrl shift KP_LEFT&quot;, &quot;selectPreviousColumnExtendSelection&quot;,
                            &quot;ctrl LEFT&quot;, &quot;selectPreviousColumnChangeLead&quot;,
                         &quot;ctrl KP_LEFT&quot;, &quot;selectPreviousColumnChangeLead&quot;,
                                 &quot;DOWN&quot;, &quot;selectNextRow&quot;,
                              &quot;KP_DOWN&quot;, &quot;selectNextRow&quot;,
                           &quot;shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                        &quot;shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                      &quot;ctrl shift DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                   &quot;ctrl shift KP_DOWN&quot;, &quot;selectNextRowExtendSelection&quot;,
                            &quot;ctrl DOWN&quot;, &quot;selectNextRowChangeLead&quot;,
                         &quot;ctrl KP_DOWN&quot;, &quot;selectNextRowChangeLead&quot;,
                                   &quot;UP&quot;, &quot;selectPreviousRow&quot;,
                                &quot;KP_UP&quot;, &quot;selectPreviousRow&quot;,
                             &quot;shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                          &quot;shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                        &quot;ctrl shift UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                     &quot;ctrl shift KP_UP&quot;, &quot;selectPreviousRowExtendSelection&quot;,
                              &quot;ctrl UP&quot;, &quot;selectPreviousRowChangeLead&quot;,
                           &quot;ctrl KP_UP&quot;, &quot;selectPreviousRowChangeLead&quot;,
                                 &quot;HOME&quot;, &quot;selectFirstColumn&quot;,
                           &quot;shift HOME&quot;, &quot;selectFirstColumnExtendSelection&quot;,
                      &quot;ctrl shift HOME&quot;, &quot;selectFirstRowExtendSelection&quot;,
                            &quot;ctrl HOME&quot;, &quot;selectFirstRow&quot;,
                                  &quot;END&quot;, &quot;selectLastColumn&quot;,
                            &quot;shift END&quot;, &quot;selectLastColumnExtendSelection&quot;,
                       &quot;ctrl shift END&quot;, &quot;selectLastRowExtendSelection&quot;,
                             &quot;ctrl END&quot;, &quot;selectLastRow&quot;,
                              &quot;PAGE_UP&quot;, &quot;scrollUpChangeSelection&quot;,
                        &quot;shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
                   &quot;ctrl shift PAGE_UP&quot;, &quot;scrollLeftExtendSelection&quot;,
                         &quot;ctrl PAGE_UP&quot;, &quot;scrollLeftChangeSelection&quot;,
                            &quot;PAGE_DOWN&quot;, &quot;scrollDownChangeSelection&quot;,
                      &quot;shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
                 &quot;ctrl shift PAGE_DOWN&quot;, &quot;scrollRightExtendSelection&quot;,
                       &quot;ctrl PAGE_DOWN&quot;, &quot;scrollRightChangeSelection&quot;,
                                  &quot;TAB&quot;, &quot;selectNextColumnCell&quot;,
                            &quot;shift TAB&quot;, &quot;selectPreviousColumnCell&quot;,
                                &quot;ENTER&quot;, &quot;selectNextRowCell&quot;,
                          &quot;shift ENTER&quot;, &quot;selectPreviousRowCell&quot;,
                               &quot;ctrl A&quot;, &quot;selectAll&quot;,
                           &quot;ctrl SLASH&quot;, &quot;selectAll&quot;,
                      &quot;ctrl BACK_SLASH&quot;, &quot;clearSelection&quot;,
                               &quot;ESCAPE&quot;, &quot;cancel&quot;,
                                   &quot;F2&quot;, &quot;startEditing&quot;,
                                &quot;SPACE&quot;, &quot;addToSelection&quot;,
                           &quot;ctrl SPACE&quot;, &quot;toggleAndAnchor&quot;,
                          &quot;shift SPACE&quot;, &quot;extendTo&quot;,
                     &quot;ctrl shift SPACE&quot;, &quot;moveSelectionTo&quot;,
                                   &quot;F8&quot;, &quot;focusHeader&quot;
                 }),
            &quot;Table.sortIconHighlight&quot;, ControlShadowColor,
            &quot;Table.sortIconLight&quot;, white,

            &quot;TableHeader.font&quot;, ControlFont,
            &quot;TableHeader.foreground&quot;, ControlTextColor, // header text color
            &quot;TableHeader.background&quot;, ControlBackgroundColor, // header background
            &quot;TableHeader.focusCellBackground&quot;,
                new XPValue(XPValue.NULL_VALUE,     // use default bg from XP styles
                            WindowBackgroundColor), // or white bg otherwise

            // *** TextArea
            &quot;TextArea.font&quot;, FixedControlFont,
            &quot;TextArea.background&quot;, WindowBackgroundColor,
            &quot;TextArea.foreground&quot;, WindowTextColor,
            &quot;TextArea.inactiveForeground&quot;, InactiveTextColor,
            &quot;TextArea.inactiveBackground&quot;, WindowBackgroundColor,
            &quot;TextArea.disabledBackground&quot;, DisabledTextBackground,
            &quot;TextArea.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;TextArea.selectionForeground&quot;, SelectionTextColor,
            &quot;TextArea.caretForeground&quot;, WindowTextColor,

            // *** TextField
            &quot;TextField.font&quot;, ControlFont,
            &quot;TextField.background&quot;, TextBackground,
            &quot;TextField.foreground&quot;, WindowTextColor,
            &quot;TextField.shadow&quot;, ControlShadowColor,
            &quot;TextField.darkShadow&quot;, ControlDarkShadowColor,
            &quot;TextField.light&quot;, ControlLightColor,
            &quot;TextField.highlight&quot;, ControlHighlightColor,
            &quot;TextField.inactiveForeground&quot;, InactiveTextColor,      // for disabled
            &quot;TextField.inactiveBackground&quot;, ReadOnlyTextBackground, // for readonly
            &quot;TextField.disabledBackground&quot;, DisabledTextBackground, // for disabled
            &quot;TextField.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;TextField.selectionForeground&quot;, SelectionTextColor,
            &quot;TextField.caretForeground&quot;, WindowTextColor,

            // *** TextPane
            &quot;TextPane.font&quot;, ControlFont,
            &quot;TextPane.background&quot;, WindowBackgroundColor,
            &quot;TextPane.foreground&quot;, WindowTextColor,
            &quot;TextPane.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;TextPane.selectionForeground&quot;, SelectionTextColor,
            &quot;TextPane.inactiveBackground&quot;, WindowBackgroundColor,
            &quot;TextPane.disabledBackground&quot;, DisabledTextBackground,
            &quot;TextPane.caretForeground&quot;, WindowTextColor,

            // *** TitledBorder
            &quot;TitledBorder.font&quot;, ControlFont,
            &quot;TitledBorder.titleColor&quot;,
                        new XPColorValue(Part.BP_GROUPBOX, null, Prop.TEXTCOLOR,
                                         WindowTextColor),

            // *** ToggleButton
            &quot;ToggleButton.font&quot;, ControlFont,
            &quot;ToggleButton.background&quot;, ControlBackgroundColor,
            &quot;ToggleButton.foreground&quot;, ControlTextColor,
            &quot;ToggleButton.shadow&quot;, ControlShadowColor,
            &quot;ToggleButton.darkShadow&quot;, ControlDarkShadowColor,
            &quot;ToggleButton.light&quot;, ControlLightColor,
            &quot;ToggleButton.highlight&quot;, ControlHighlightColor,
            &quot;ToggleButton.focus&quot;, ControlTextColor,
            &quot;ToggleButton.textShiftOffset&quot;, Integer.valueOf(1),
            &quot;ToggleButton.focusInputMap&quot;,
              new UIDefaults.LazyInputMap(new Object[] {
                            &quot;SPACE&quot;, &quot;pressed&quot;,
                   &quot;released SPACE&quot;, &quot;released&quot;
                }),

            // *** ToolBar
            &quot;ToolBar.font&quot;, MenuFont,
            &quot;ToolBar.background&quot;, ControlBackgroundColor,
            &quot;ToolBar.foreground&quot;, ControlTextColor,
            &quot;ToolBar.shadow&quot;, ControlShadowColor,
            &quot;ToolBar.darkShadow&quot;, ControlDarkShadowColor,
            &quot;ToolBar.light&quot;, ControlLightColor,
            &quot;ToolBar.highlight&quot;, ControlHighlightColor,
            &quot;ToolBar.dockingBackground&quot;, ControlBackgroundColor,
            &quot;ToolBar.dockingForeground&quot;, red,
            &quot;ToolBar.floatingBackground&quot;, ControlBackgroundColor,
            &quot;ToolBar.floatingForeground&quot;, darkGray,
            &quot;ToolBar.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                        &quot;UP&quot;, &quot;navigateUp&quot;,
                     &quot;KP_UP&quot;, &quot;navigateUp&quot;,
                      &quot;DOWN&quot;, &quot;navigateDown&quot;,
                   &quot;KP_DOWN&quot;, &quot;navigateDown&quot;,
                      &quot;LEFT&quot;, &quot;navigateLeft&quot;,
                   &quot;KP_LEFT&quot;, &quot;navigateLeft&quot;,
                     &quot;RIGHT&quot;, &quot;navigateRight&quot;,
                  &quot;KP_RIGHT&quot;, &quot;navigateRight&quot;
                 }),
            &quot;ToolBar.separatorSize&quot;, null,

            // *** ToolTip
            &quot;ToolTip.font&quot;, ToolTipFont,
            &quot;ToolTip.background&quot;, new DesktopProperty(&quot;win.tooltip.backgroundColor&quot;, table.get(&quot;info&quot;)),
            &quot;ToolTip.foreground&quot;, new DesktopProperty(&quot;win.tooltip.textColor&quot;, table.get(&quot;infoText&quot;)),

        // *** ToolTipManager
            &quot;ToolTipManager.enableToolTipMode&quot;, &quot;activeApplication&quot;,

        // *** Tree
            &quot;Tree.selectionBorderColor&quot;, black,
            &quot;Tree.drawDashedFocusIndicator&quot;, Boolean.TRUE,
            &quot;Tree.lineTypeDashed&quot;, Boolean.TRUE,
            &quot;Tree.font&quot;, ControlFont,
            &quot;Tree.background&quot;, WindowBackgroundColor,
            &quot;Tree.foreground&quot;, WindowTextColor,
            &quot;Tree.hash&quot;, gray,
            &quot;Tree.leftChildIndent&quot;, Integer.valueOf(8),
            &quot;Tree.rightChildIndent&quot;, Integer.valueOf(11),
            &quot;Tree.textForeground&quot;, WindowTextColor,
            &quot;Tree.textBackground&quot;, WindowBackgroundColor,
            &quot;Tree.selectionForeground&quot;, SelectionTextColor,
            &quot;Tree.selectionBackground&quot;, SelectionBackgroundColor,
            &quot;Tree.expandedIcon&quot;, treeExpandedIcon,
            &quot;Tree.collapsedIcon&quot;, treeCollapsedIcon,
            &quot;Tree.openIcon&quot;,   new ActiveWindowsIcon(&quot;win.icon.shellIconBPP&quot;,
                                   &quot;shell32Icon 5&quot;, &quot;icons/TreeOpen.gif&quot;),
            &quot;Tree.closedIcon&quot;, new ActiveWindowsIcon(&quot;win.icon.shellIconBPP&quot;,
                                   &quot;shell32Icon 4&quot;, &quot;icons/TreeClosed.gif&quot;),
            &quot;Tree.focusInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                                    &quot;ADD&quot;, &quot;expand&quot;,
                               &quot;SUBTRACT&quot;, &quot;collapse&quot;,
                                 &quot;ctrl C&quot;, &quot;copy&quot;,
                                 &quot;ctrl V&quot;, &quot;paste&quot;,
                                 &quot;ctrl X&quot;, &quot;cut&quot;,
                                   &quot;COPY&quot;, &quot;copy&quot;,
                                  &quot;PASTE&quot;, &quot;paste&quot;,
                                    &quot;CUT&quot;, &quot;cut&quot;,
                         &quot;control INSERT&quot;, &quot;copy&quot;,
                           &quot;shift INSERT&quot;, &quot;paste&quot;,
                           &quot;shift DELETE&quot;, &quot;cut&quot;,
                                     &quot;UP&quot;, &quot;selectPrevious&quot;,
                                  &quot;KP_UP&quot;, &quot;selectPrevious&quot;,
                               &quot;shift UP&quot;, &quot;selectPreviousExtendSelection&quot;,
                            &quot;shift KP_UP&quot;, &quot;selectPreviousExtendSelection&quot;,
                          &quot;ctrl shift UP&quot;, &quot;selectPreviousExtendSelection&quot;,
                       &quot;ctrl shift KP_UP&quot;, &quot;selectPreviousExtendSelection&quot;,
                                &quot;ctrl UP&quot;, &quot;selectPreviousChangeLead&quot;,
                             &quot;ctrl KP_UP&quot;, &quot;selectPreviousChangeLead&quot;,
                                   &quot;DOWN&quot;, &quot;selectNext&quot;,
                                &quot;KP_DOWN&quot;, &quot;selectNext&quot;,
                             &quot;shift DOWN&quot;, &quot;selectNextExtendSelection&quot;,
                          &quot;shift KP_DOWN&quot;, &quot;selectNextExtendSelection&quot;,
                        &quot;ctrl shift DOWN&quot;, &quot;selectNextExtendSelection&quot;,
                     &quot;ctrl shift KP_DOWN&quot;, &quot;selectNextExtendSelection&quot;,
                              &quot;ctrl DOWN&quot;, &quot;selectNextChangeLead&quot;,
                           &quot;ctrl KP_DOWN&quot;, &quot;selectNextChangeLead&quot;,
                                  &quot;RIGHT&quot;, &quot;selectChild&quot;,
                               &quot;KP_RIGHT&quot;, &quot;selectChild&quot;,
                                   &quot;LEFT&quot;, &quot;selectParent&quot;,
                                &quot;KP_LEFT&quot;, &quot;selectParent&quot;,
                                &quot;PAGE_UP&quot;, &quot;scrollUpChangeSelection&quot;,
                          &quot;shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
                     &quot;ctrl shift PAGE_UP&quot;, &quot;scrollUpExtendSelection&quot;,
                           &quot;ctrl PAGE_UP&quot;, &quot;scrollUpChangeLead&quot;,
                              &quot;PAGE_DOWN&quot;, &quot;scrollDownChangeSelection&quot;,
                        &quot;shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
                   &quot;ctrl shift PAGE_DOWN&quot;, &quot;scrollDownExtendSelection&quot;,
                         &quot;ctrl PAGE_DOWN&quot;, &quot;scrollDownChangeLead&quot;,
                                   &quot;HOME&quot;, &quot;selectFirst&quot;,
                             &quot;shift HOME&quot;, &quot;selectFirstExtendSelection&quot;,
                        &quot;ctrl shift HOME&quot;, &quot;selectFirstExtendSelection&quot;,
                              &quot;ctrl HOME&quot;, &quot;selectFirstChangeLead&quot;,
                                    &quot;END&quot;, &quot;selectLast&quot;,
                              &quot;shift END&quot;, &quot;selectLastExtendSelection&quot;,
                         &quot;ctrl shift END&quot;, &quot;selectLastExtendSelection&quot;,
                               &quot;ctrl END&quot;, &quot;selectLastChangeLead&quot;,
                                     &quot;F2&quot;, &quot;startEditing&quot;,
                                 &quot;ctrl A&quot;, &quot;selectAll&quot;,
                             &quot;ctrl SLASH&quot;, &quot;selectAll&quot;,
                        &quot;ctrl BACK_SLASH&quot;, &quot;clearSelection&quot;,
                              &quot;ctrl LEFT&quot;, &quot;scrollLeft&quot;,
                           &quot;ctrl KP_LEFT&quot;, &quot;scrollLeft&quot;,
                             &quot;ctrl RIGHT&quot;, &quot;scrollRight&quot;,
                          &quot;ctrl KP_RIGHT&quot;, &quot;scrollRight&quot;,
                                  &quot;SPACE&quot;, &quot;addToSelection&quot;,
                             &quot;ctrl SPACE&quot;, &quot;toggleAndAnchor&quot;,
                            &quot;shift SPACE&quot;, &quot;extendTo&quot;,
                       &quot;ctrl shift SPACE&quot;, &quot;moveSelectionTo&quot;
                 }),
            &quot;Tree.ancestorInputMap&quot;,
               new UIDefaults.LazyInputMap(new Object[] {
                     &quot;ESCAPE&quot;, &quot;cancel&quot;
                 }),

            // *** Viewport
            &quot;Viewport.font&quot;, ControlFont,
            &quot;Viewport.background&quot;, ControlBackgroundColor,
            &quot;Viewport.foreground&quot;, WindowTextColor,


        };

        table.putDefaults(defaults);
        table.putDefaults(getLazyValueDefaults());
        initVistaComponentDefaults(table);
    }

    static boolean isOnVista() {
        return OSInfo.getOSType() == OSInfo.OSType.WINDOWS
                &amp;&amp; OSInfo.getWindowsVersion().compareTo(OSInfo.WINDOWS_VISTA) &gt;= 0;
    }

    private void initVistaComponentDefaults(UIDefaults table) {
        if (! isOnVista()) {
            return;
        }
        /* START handling menus for Vista */
        String[] menuClasses = { &quot;MenuItem&quot;, &quot;Menu&quot;,
                &quot;CheckBoxMenuItem&quot;, &quot;RadioButtonMenuItem&quot;,
        };

        Object menuDefaults[] = new Object[menuClasses.length * 2];

        /* all the menus need to be non opaque. */
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.opaque&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(Boolean.FALSE, oldValue);
        }
        table.putDefaults(menuDefaults);

        /*
         * acceleratorSelectionForeground color is the same as
         * acceleratorForeground
         */
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.acceleratorSelectionForeground&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(
                    table.getColor(
                        menuClasses[i] + &quot;.acceleratorForeground&quot;),
                        oldValue);
        }
        table.putDefaults(menuDefaults);

        /* they have the same MenuItemCheckIconFactory */
        VistaMenuItemCheckIconFactory menuItemCheckIconFactory =
            WindowsIconFactory.getMenuItemCheckIconFactory();
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.checkIconFactory&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(menuItemCheckIconFactory, oldValue);
        }
        table.putDefaults(menuDefaults);

        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.checkIcon&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(menuItemCheckIconFactory.getIcon(menuClasses[i]),
                    oldValue);
        }
        table.putDefaults(menuDefaults);


        /* height can be even */
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.evenHeight&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] = new XPValue(Boolean.TRUE, oldValue);
        }
        table.putDefaults(menuDefaults);

        /* no margins */
        InsetsUIResource insets = new InsetsUIResource(0, 0, 0, 0);
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.margin&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] = new XPValue(insets, oldValue);
        }
        table.putDefaults(menuDefaults);

        /* set checkIcon offset */
        Integer checkIconOffsetInteger =
            Integer.valueOf(0);
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.checkIconOffset&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(checkIconOffsetInteger, oldValue);
        }
        table.putDefaults(menuDefaults);

        /* set width of the gap after check icon */
        Integer afterCheckIconGap = WindowsPopupMenuUI.getSpanBeforeGutter()
                + WindowsPopupMenuUI.getGutterWidth()
                + WindowsPopupMenuUI.getSpanAfterGutter();
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.afterCheckIconGap&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] =
                new XPValue(afterCheckIconGap, oldValue);
        }
        table.putDefaults(menuDefaults);

        /* text is started after this position */
        Object minimumTextOffset = new UIDefaults.ActiveValue() {
            public Object createValue(UIDefaults table) {
                return VistaMenuItemCheckIconFactory.getIconWidth()
                + WindowsPopupMenuUI.getSpanBeforeGutter()
                + WindowsPopupMenuUI.getGutterWidth()
                + WindowsPopupMenuUI.getSpanAfterGutter();
            }
        };
        for (int i = 0, j = 0; i &lt; menuClasses.length; i++) {
            String key = menuClasses[i] + &quot;.minimumTextOffset&quot;;
            Object oldValue = table.get(key);
            menuDefaults[j++] = key;
            menuDefaults[j++] = new XPValue(minimumTextOffset, oldValue);
        }
        table.putDefaults(menuDefaults);

        /*
         * JPopupMenu has a bit of free space around menu items
         */
        String POPUP_MENU_BORDER = &quot;PopupMenu.border&quot;;

        Object popupMenuBorder = new XPBorderValue(Part.MENU,
                new SwingLazyValue(
                  &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                  &quot;getInternalFrameBorder&quot;),
                  BorderFactory.createEmptyBorder(2, 2, 2, 2));
        table.put(POPUP_MENU_BORDER, popupMenuBorder);
        /* END handling menus for Vista */

        /* START table handling for Vista */
        table.put(&quot;Table.ascendingSortIcon&quot;, new XPValue(
            new SkinIcon(Part.HP_HEADERSORTARROW, State.SORTEDDOWN),
            new SwingLazyValue(
                &quot;sun.swing.plaf.windows.ClassicSortArrowIcon&quot;,
                null, new Object[] { Boolean.TRUE })));
        table.put(&quot;Table.descendingSortIcon&quot;, new XPValue(
            new SkinIcon(Part.HP_HEADERSORTARROW, State.SORTEDUP),
            new SwingLazyValue(
                &quot;sun.swing.plaf.windows.ClassicSortArrowIcon&quot;,
                null, new Object[] { Boolean.FALSE })));
        /* END table handling for Vista */
    }

    /**
     * If we support loading of fonts from the desktop this will return
     * a DesktopProperty representing the font. If the font can't be
     * represented in the current encoding this will return null and
     * turn off the use of system fonts.
     */
    private Object getDesktopFontValue(String fontName, Object backup) {
        if (useSystemFontSettings) {
            return new WindowsFontProperty(fontName, backup);
        }
        return null;
    }

    // When a desktop property change is detected, these classes must be
    // reinitialized in the defaults table to ensure the classes reference
    // the updated desktop property values (colors mostly)
    //
    private Object[] getLazyValueDefaults() {

        Object buttonBorder =
            new XPBorderValue(Part.BP_PUSHBUTTON,
                              new SwingLazyValue(
                               &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                               &quot;getButtonBorder&quot;));

        Object textFieldBorder =
            new XPBorderValue(Part.EP_EDIT,
                              new SwingLazyValue(
                               &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                               &quot;getTextFieldBorder&quot;));

        Object textFieldMargin =
            new XPValue(new InsetsUIResource(2, 2, 2, 2),
                        new InsetsUIResource(1, 1, 1, 1));

        Object spinnerBorder =
            new XPBorderValue(Part.EP_EDIT, textFieldBorder,
                              new EmptyBorder(2, 2, 2, 2));

        Object spinnerArrowInsets =
            new XPValue(new InsetsUIResource(1, 1, 1, 1),
                        null);

        Object comboBoxBorder = new XPBorderValue(Part.CP_COMBOBOX, textFieldBorder);

        // For focus rectangle for cells and trees.
        Object focusCellHighlightBorder = new SwingLazyValue(
                          &quot;com.sun.java.swing.plaf.windows.WindowsBorders&quot;,
                          &quot;getFocusCellHighlightBorder&quot;);

        Object etchedBorder = new SwingLazyValue(
                          &quot;javax.swing.plaf.BorderUIResource&quot;,
                          &quot;getEtchedBorderUIResource&quot;);

        Object internalFrameBorder = new SwingLazyValue(
                &quot;com.sun.java.swing.plaf.windows.WindowsBorders&quot;,
                &quot;getInternalFrameBorder&quot;);

        Object loweredBevelBorder = new SwingLazyValue(
                          &quot;javax.swing.plaf.BorderUIResource&quot;,
                          &quot;getLoweredBevelBorderUIResource&quot;);


        Object marginBorder = new SwingLazyValue(
                            &quot;javax.swing.plaf.basic.BasicBorders$MarginBorder&quot;);

        Object menuBarBorder = new SwingLazyValue(
                &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                &quot;getMenuBarBorder&quot;);


        Object popupMenuBorder = new XPBorderValue(Part.MENU,
                        new SwingLazyValue(
                          &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                          &quot;getInternalFrameBorder&quot;));

        // *** ProgressBar
        Object progressBarBorder = new SwingLazyValue(
                              &quot;com.sun.java.swing.plaf.windows.WindowsBorders&quot;,
                              &quot;getProgressBarBorder&quot;);

        Object radioButtonBorder = new SwingLazyValue(
                               &quot;javax.swing.plaf.basic.BasicBorders&quot;,
                               &quot;getRadioButtonBorder&quot;);

        Object scrollPaneBorder =
            new XPBorderValue(Part.LBP_LISTBOX, textFieldBorder);

        Object tableScrollPaneBorder =
            new XPBorderValue(Part.LBP_LISTBOX, loweredBevelBorder);

        Object tableHeaderBorder = new SwingLazyValue(
                          &quot;com.sun.java.swing.plaf.windows.WindowsBorders&quot;,
                          &quot;getTableHeaderBorder&quot;);

        // *** ToolBar
        Object toolBarBorder = new SwingLazyValue(
                              &quot;com.sun.java.swing.plaf.windows.WindowsBorders&quot;,
                              &quot;getToolBarBorder&quot;);

        // *** ToolTips
        Object toolTipBorder = new SwingLazyValue(
                              &quot;javax.swing.plaf.BorderUIResource&quot;,
                              &quot;getBlackLineBorderUIResource&quot;);



        Object checkBoxIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getCheckBoxIcon&quot;);

        Object radioButtonIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getRadioButtonIcon&quot;);

        Object radioButtonMenuItemIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getRadioButtonMenuItemIcon&quot;);

        Object menuItemCheckIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getMenuItemCheckIcon&quot;);

        Object menuItemArrowIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getMenuItemArrowIcon&quot;);

        Object menuArrowIcon = new SwingLazyValue(
                     &quot;com.sun.java.swing.plaf.windows.WindowsIconFactory&quot;,
                     &quot;getMenuArrowIcon&quot;);


        Object[] lazyDefaults = {
            &quot;Button.border&quot;, buttonBorder,
            &quot;CheckBox.border&quot;, radioButtonBorder,
            &quot;ComboBox.border&quot;, comboBoxBorder,
            &quot;DesktopIcon.border&quot;, internalFrameBorder,
            &quot;FormattedTextField.border&quot;, textFieldBorder,
            &quot;FormattedTextField.margin&quot;, textFieldMargin,
            &quot;InternalFrame.border&quot;, internalFrameBorder,
            &quot;List.focusCellHighlightBorder&quot;, focusCellHighlightBorder,
            &quot;Table.focusCellHighlightBorder&quot;, focusCellHighlightBorder,
            &quot;Menu.border&quot;, marginBorder,
            &quot;MenuBar.border&quot;, menuBarBorder,
            &quot;MenuItem.border&quot;, marginBorder,
            &quot;PasswordField.border&quot;, textFieldBorder,
            &quot;PasswordField.margin&quot;, textFieldMargin,
            &quot;PopupMenu.border&quot;, popupMenuBorder,
            &quot;ProgressBar.border&quot;, progressBarBorder,
            &quot;RadioButton.border&quot;, radioButtonBorder,
            &quot;ScrollPane.border&quot;, scrollPaneBorder,
            &quot;Spinner.border&quot;, spinnerBorder,
            &quot;Spinner.arrowButtonInsets&quot;, spinnerArrowInsets,
            &quot;Spinner.arrowButtonSize&quot;, new Dimension(17, 9),
            &quot;Table.scrollPaneBorder&quot;, tableScrollPaneBorder,
            &quot;TableHeader.cellBorder&quot;, tableHeaderBorder,
            &quot;TextArea.margin&quot;, textFieldMargin,
            &quot;TextField.border&quot;, textFieldBorder,
            &quot;TextField.margin&quot;, textFieldMargin,
            &quot;TitledBorder.border&quot;,
                        new XPBorderValue(Part.BP_GROUPBOX, etchedBorder),
            &quot;ToggleButton.border&quot;, radioButtonBorder,
            &quot;ToolBar.border&quot;, toolBarBorder,
            &quot;ToolTip.border&quot;, toolTipBorder,

            &quot;CheckBox.icon&quot;, checkBoxIcon,
            &quot;Menu.arrowIcon&quot;, menuArrowIcon,
            &quot;MenuItem.checkIcon&quot;, menuItemCheckIcon,
            &quot;MenuItem.arrowIcon&quot;, menuItemArrowIcon,
            &quot;RadioButton.icon&quot;, radioButtonIcon,
            &quot;RadioButtonMenuItem.checkIcon&quot;, radioButtonMenuItemIcon,
            &quot;InternalFrame.layoutTitlePaneAtOrigin&quot;,
                        new XPValue(Boolean.TRUE, Boolean.FALSE),
            &quot;Table.ascendingSortIcon&quot;, new XPValue(
                  new SwingLazyValue(
                     &quot;sun.swing.icon.SortArrowIcon&quot;,
                     null, new Object[] { Boolean.TRUE,
                                          &quot;Table.sortIconColor&quot; }),
                  new SwingLazyValue(
                      &quot;sun.swing.plaf.windows.ClassicSortArrowIcon&quot;,
                      null, new Object[] { Boolean.TRUE })),
            &quot;Table.descendingSortIcon&quot;, new XPValue(
                  new SwingLazyValue(
                     &quot;sun.swing.icon.SortArrowIcon&quot;,
                     null, new Object[] { Boolean.FALSE,
                                          &quot;Table.sortIconColor&quot; }),
                  new SwingLazyValue(
                     &quot;sun.swing.plaf.windows.ClassicSortArrowIcon&quot;,
                     null, new Object[] { Boolean.FALSE })),
        };

        return lazyDefaults;
    }

    public void uninitialize() {
        super.uninitialize();

        if (WindowsPopupMenuUI.mnemonicListener != null) {
            MenuSelectionManager.defaultManager().
                removeChangeListener(WindowsPopupMenuUI.mnemonicListener);
        }
        KeyboardFocusManager.getCurrentKeyboardFocusManager().
            removeKeyEventPostProcessor(WindowsRootPaneUI.altProcessor);
        DesktopProperty.flushUnreferencedProperties();
    }


    // Toggle flag for drawing the mnemonic state
    private static boolean isMnemonicHidden = true;

    // Flag which indicates that the Win98/Win2k/WinME features
    // should be disabled.
    private static boolean isClassicWindows = false;

    /**
     * Sets the state of the hide mnemonic flag. This flag is used by the
     * component UI delegates to determine if the mnemonic should be rendered.
     * This method is a non operation if the underlying operating system
     * does not support the mnemonic hiding feature.
     *
     * @param hide true if mnemonics should be hidden
     * @since 1.4
     */
    public static void setMnemonicHidden(boolean hide) {
        if (UIManager.getBoolean(&quot;Button.showMnemonics&quot;) == true) {
            // Do not hide mnemonics if the UI defaults do not support this
            isMnemonicHidden = false;
        } else {
            isMnemonicHidden = hide;
        }
    }

    /**
     * Gets the state of the hide mnemonic flag. This only has meaning
     * if this feature is supported by the underlying OS.
     *
     * @return true if mnemonics are hidden, otherwise, false
     * @see #setMnemonicHidden
     * @since 1.4
     */
    public static boolean isMnemonicHidden() {
        if (UIManager.getBoolean(&quot;Button.showMnemonics&quot;) == true) {
            // Do not hide mnemonics if the UI defaults do not support this
            isMnemonicHidden = false;
        }
        return isMnemonicHidden;
    }

    /**
     * Gets the state of the flag which indicates if the old Windows
     * look and feel should be rendered. This flag is used by the
     * component UI delegates as a hint to determine which style the component
     * should be rendered.
     *
     * @return true if Windows 95 and Windows NT 4 look and feel should
     *         be rendered
     * @since 1.4
     */
    public static boolean isClassicWindows() {
        return isClassicWindows;
    }

    /**
     * &lt;p&gt;
     * Invoked when the user attempts an invalid operation,
     * such as pasting into an uneditable &lt;code&gt;JTextField&lt;/code&gt;
     * that has focus.
     * &lt;/p&gt;
     * &lt;p&gt;
     * If the user has enabled visual error indication on
     * the desktop, this method will flash the caption bar
     * of the active window. The user can also set the
     * property awt.visualbell=true to achieve the same
     * results.
     * &lt;/p&gt;
     *
     * @param component Component the error occurred in, may be
     *                  null indicating the error condition is
     *                  not directly associated with a
     *                  &lt;code&gt;Component&lt;/code&gt;.
     *
     * @see javax.swing.LookAndFeel#provideErrorFeedback
     */
     public void provideErrorFeedback(Component component) {
         super.provideErrorFeedback(component);
     }

    /**
     * {@inheritDoc}
     */
    public LayoutStyle getLayoutStyle() {
        LayoutStyle style = this.style;
        if (style == null) {
            style = new WindowsLayoutStyle();
            this.style = style;
        }
        return style;
    }

    // ********* Auditory Cue support methods and objects *********

    /**
     * Returns an &lt;code&gt;Action&lt;/code&gt;.
     * &lt;P&gt;
     * This Action contains the information and logic to render an
     * auditory cue. The &lt;code&gt;Object&lt;/code&gt; that is passed to this
     * method contains the information needed to render the auditory
     * cue. Normally, this &lt;code&gt;Object&lt;/code&gt; is a &lt;code&gt;String&lt;/code&gt;
     * that points to a &lt;code&gt;Toolkit&lt;/code&gt; &lt;code&gt;desktopProperty&lt;/code&gt;.
     * This &lt;code&gt;desktopProperty&lt;/code&gt; is resolved by AWT and the
     * Windows OS.
     * &lt;P&gt;
     * This &lt;code&gt;Action&lt;/code&gt;'s &lt;code&gt;actionPerformed&lt;/code&gt; method
     * is fired by the &lt;code&gt;playSound&lt;/code&gt; method.
     *
     * @return      an Action which knows how to render the auditory
     *              cue for one particular system or user activity
     * @see #playSound(Action)
     * @since 1.4
     */
    protected Action createAudioAction(Object key) {
        if (key != null) {
            String audioKey = (String)key;
            String audioValue = (String)UIManager.get(key);
            return new AudioAction(audioKey, audioValue);
        } else {
            return null;
        }
    }

    static void repaintRootPane(Component c) {
        JRootPane root = null;
        for (; c != null; c = c.getParent()) {
            if (c instanceof JRootPane) {
                root = (JRootPane)c;
            }
        }

        if (root != null) {
            root.repaint();
        } else {
            c.repaint();
        }
    }

    /**
     * Pass the name String to the super constructor. This is used
     * later to identify the Action and decide whether to play it or
     * not. Store the resource String. It is used to get the audio
     * resource. In this case, the resource is a &lt;code&gt;Runnable&lt;/code&gt;
     * supplied by &lt;code&gt;Toolkit&lt;/code&gt;. This &lt;code&gt;Runnable&lt;/code&gt; is
     * effectively a pointer down into the Win32 OS that knows how to
     * play the right sound.
     *
     * @since 1.4
     */
    private static class AudioAction extends AbstractAction {
        private Runnable audioRunnable;
        private String audioResource;
        /**
         * We use the String as the name of the Action and as a pointer to
         * the underlying OSes audio resource.
         */
        public AudioAction(String name, String resource) {
            super(name);
            audioResource = resource;
        }
        public void actionPerformed(ActionEvent e) {
            if (audioRunnable == null) {
                audioRunnable = (Runnable)Toolkit.getDefaultToolkit().getDesktopProperty(audioResource);
            }
            if (audioRunnable != null) {
                // Runnable appears to block until completed playing, hence
                // start up another thread to handle playing.
                new Thread(audioRunnable).start();
            }
        }
    }

    /**
     * Gets an &lt;code&gt;Icon&lt;/code&gt; from the native libraries if available,
     * otherwise gets it from an image resource file.
     */
    private static class LazyWindowsIcon implements UIDefaults.LazyValue {
        private String nativeImage;
        private String resource;

        LazyWindowsIcon(String nativeImage, String resource) {
            this.nativeImage = nativeImage;
            this.resource = resource;
        }

        public Object createValue(UIDefaults table) {
            if (nativeImage != null) {
                Image image = (Image)ShellFolder.get(nativeImage);
                if (image != null) {
                    return new ImageIcon(image);
                }
            }
            return SwingUtilities2.makeIcon(getClass(),
                                            WindowsLookAndFeel.class,
                                            resource);
        }
    }


    /**
     * Gets an &lt;code&gt;Icon&lt;/code&gt; from the native libraries if available.
     * A desktop property is used to trigger reloading the icon when needed.
     */
    private class ActiveWindowsIcon implements UIDefaults.ActiveValue {
        private Icon icon;
        private String nativeImageName;
        private String fallbackName;
        private DesktopProperty desktopProperty;

        ActiveWindowsIcon(String desktopPropertyName,
                            String nativeImageName, String fallbackName) {
            this.nativeImageName = nativeImageName;
            this.fallbackName = fallbackName;

            if (OSInfo.getOSType() == OSInfo.OSType.WINDOWS &amp;&amp;
                    OSInfo.getWindowsVersion().compareTo(OSInfo.WINDOWS_XP) &lt; 0) {
                // This desktop property is needed to trigger reloading the icon.
                // It is kept in member variable to avoid GC.
                this.desktopProperty = new TriggerDesktopProperty(desktopPropertyName) {
                    @Override protected void updateUI() {
                        icon = null;
                        super.updateUI();
                    }
                };
            }
        }

        @Override
        public Object createValue(UIDefaults table) {
            if (icon == null) {
                Image image = (Image)ShellFolder.get(nativeImageName);
                if (image != null) {
                    icon = new ImageIconUIResource(image);
                }
            }
            if (icon == null &amp;&amp; fallbackName != null) {
                UIDefaults.LazyValue fallback = (UIDefaults.LazyValue)
                        SwingUtilities2.makeIcon(WindowsLookAndFeel.class,
                            BasicLookAndFeel.class, fallbackName);
                icon = (Icon) fallback.createValue(table);
            }
            return icon;
        }
    }

    /**
     * Icon backed-up by XP Skin.
     */
    private static class SkinIcon implements Icon, UIResource {
        private final Part part;
        private final State state;
        SkinIcon(Part part, State state) {
            this.part = part;
            this.state = state;
        }

        /**
         * Draw the icon at the specified location.  Icon implementations
         * may use the Component argument to get properties useful for
         * painting, e.g. the foreground or background color.
         */
        public void paintIcon(Component c, Graphics g, int x, int y) {
            XPStyle xp = XPStyle.getXP();
            assert xp != null;
            if (xp != null) {
                Skin skin = xp.getSkin(null, part);
                skin.paintSkin(g, x, y, state);
            }
        }

        /**
         * Returns the icon's width.
         *
         * @return an int specifying the fixed width of the icon.
         */
        public int getIconWidth() {
            int width = 0;
            XPStyle xp = XPStyle.getXP();
            assert xp != null;
            if (xp != null) {
                Skin skin = xp.getSkin(null, part);
                width = skin.getWidth();
            }
            return width;
        }

        /**
         * Returns the icon's height.
         *
         * @return an int specifying the fixed height of the icon.
         */
        public int getIconHeight() {
            int height = 0;
            XPStyle xp = XPStyle.getXP();
            if (xp != null) {
                Skin skin = xp.getSkin(null, part);
                height = skin.getHeight();
            }
            return height;
        }

    }

    /**
     * DesktopProperty for fonts. If a font with the name 'MS Sans Serif'
     * is returned, it is mapped to 'Microsoft Sans Serif'.
     */
    private static class WindowsFontProperty extends DesktopProperty {
        WindowsFontProperty(String key, Object backup) {
            super(key, backup);
        }

        public void invalidate(LookAndFeel laf) {
            if (&quot;win.defaultGUI.font.height&quot;.equals(getKey())) {
                ((WindowsLookAndFeel)laf).style = null;
            }
            super.invalidate(laf);
        }

        protected Object configureValue(Object value) {
            if (value instanceof Font) {
                Font font = (Font)value;
                if (&quot;MS Sans Serif&quot;.equals(font.getName())) {
                    int size = font.getSize();
                    // 4950968: Workaround to mimic the way Windows maps the default
                    // font size of 6 pts to the smallest available bitmap font size.
                    // This happens mostly on Win 98/Me &amp; NT.
                    int dpi;
                    try {
                        dpi = Toolkit.getDefaultToolkit().getScreenResolution();
                    } catch (HeadlessException ex) {
                        dpi = 96;
                    }
                    if (Math.round(size * 72F / dpi) &lt; 8) {
                        size = Math.round(8 * dpi / 72F);
                    }
                    Font msFont = new FontUIResource(&quot;Microsoft Sans Serif&quot;,
                                          font.getStyle(), size);
                    if (msFont.getName() != null &amp;&amp;
                        msFont.getName().equals(msFont.getFamily())) {
                        font = msFont;
                    } else if (size != font.getSize()) {
                        font = new FontUIResource(&quot;MS Sans Serif&quot;,
                                                  font.getStyle(), size);
                    }
                }

                if (FontUtilities.fontSupportsDefaultEncoding(font)) {
                    if (!(font instanceof UIResource)) {
                        font = new FontUIResource(font);
                    }
                }
                else {
                    font = FontUtilities.getCompositeFontUIResource(font);
                }
                return font;

            }
            return super.configureValue(value);
        }
    }


    /**
     * DesktopProperty for fonts that only gets sizes from the desktop,
     * font name and style are passed into the constructor
     */
    private static class WindowsFontSizeProperty extends DesktopProperty {
        private String fontName;
        private int fontSize;
        private int fontStyle;

        WindowsFontSizeProperty(String key, String fontName,
                                int fontStyle, int fontSize) {
            super(key, null);
            this.fontName = fontName;
            this.fontSize = fontSize;
            this.fontStyle = fontStyle;
        }

        protected Object configureValue(Object value) {
            if (value == null) {
                value = new FontUIResource(fontName, fontStyle, fontSize);
            }
            else if (value instanceof Integer) {
                value = new FontUIResource(fontName, fontStyle,
                                           ((Integer)value).intValue());
            }
            return value;
        }
    }


    /**
     * A value wrapper that actively retrieves values from xp or falls back
     * to the classic value if not running XP styles.
     */
    private static class XPValue implements UIDefaults.ActiveValue {
        protected Object classicValue, xpValue;

        // A constant that lets you specify null when using XP styles.
        private final static Object NULL_VALUE = new Object();

        XPValue(Object xpValue, Object classicValue) {
            this.xpValue = xpValue;
            this.classicValue = classicValue;
        }

        public Object createValue(UIDefaults table) {
            Object value = null;
            if (XPStyle.getXP() != null) {
                value = getXPValue(table);
            }

            if (value == null) {
                value = getClassicValue(table);
            } else if (value == NULL_VALUE) {
                value = null;
            }

            return value;
        }

        protected Object getXPValue(UIDefaults table) {
            return recursiveCreateValue(xpValue, table);
        }

        protected Object getClassicValue(UIDefaults table) {
            return recursiveCreateValue(classicValue, table);
        }

        private Object recursiveCreateValue(Object value, UIDefaults table) {
            if (value instanceof UIDefaults.LazyValue) {
                value = ((UIDefaults.LazyValue)value).createValue(table);
            }
            if (value instanceof UIDefaults.ActiveValue) {
                return ((UIDefaults.ActiveValue)value).createValue(table);
            } else {
                return value;
            }
        }
    }

    private static class XPBorderValue extends XPValue {
        private final Border extraMargin;

        XPBorderValue(Part xpValue, Object classicValue) {
            this(xpValue, classicValue, null);
        }

        XPBorderValue(Part xpValue, Object classicValue, Border extraMargin) {
            super(xpValue, classicValue);
            this.extraMargin = extraMargin;
        }

        public Object getXPValue(UIDefaults table) {
            Border xpBorder = XPStyle.getXP().getBorder(null, (Part)xpValue);
            if (extraMargin != null) {
                return new BorderUIResource.
                        CompoundBorderUIResource(xpBorder, extraMargin);
            } else {
                return xpBorder;
            }
        }
    }

    private static class XPColorValue extends XPValue {
        XPColorValue(Part part, State state, Prop prop, Object classicValue) {
            super(new XPColorValueKey(part, state, prop), classicValue);
        }

        public Object getXPValue(UIDefaults table) {
            XPColorValueKey key = (XPColorValueKey)xpValue;
            return XPStyle.getXP().getColor(key.skin, key.prop, null);
        }

        private static class XPColorValueKey {
            Skin skin;
            Prop prop;

            XPColorValueKey(Part part, State state, Prop prop) {
                this.skin = new Skin(part, state);
                this.prop = prop;
            }
        }
    }

    private class XPDLUValue extends XPValue {
        private int direction;

        XPDLUValue(int xpdlu, int classicdlu, int direction) {
            super(Integer.valueOf(xpdlu), Integer.valueOf(classicdlu));
            this.direction = direction;
        }

        public Object getXPValue(UIDefaults table) {
            int px = dluToPixels(((Integer)xpValue).intValue(), direction);
            return Integer.valueOf(px);
        }

        public Object getClassicValue(UIDefaults table) {
            int px = dluToPixels(((Integer)classicValue).intValue(), direction);
            return Integer.valueOf(px);
        }
    }

    private class TriggerDesktopProperty extends DesktopProperty {
        TriggerDesktopProperty(String key) {
            super(key, null);
            // This call adds a property change listener for the property,
            // which triggers a call to updateUI(). The value returned
            // is not interesting here.
            getValueFromDesktop();
        }

        protected void updateUI() {
            super.updateUI();

            // Make sure property change listener is readded each time
            getValueFromDesktop();
        }
    }

    private class FontDesktopProperty extends TriggerDesktopProperty {
        FontDesktopProperty(String key) {
            super(key);
        }

        protected void updateUI() {
            Object aaTextInfo = SwingUtilities2.AATextInfo.getAATextInfo(true);
            UIDefaults defaults = UIManager.getLookAndFeelDefaults();
            defaults.put(SwingUtilities2.AA_TEXT_PROPERTY_KEY, aaTextInfo);
            super.updateUI();
        }
    }

    // Windows LayoutStyle.  From:
    // http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwue/html/ch14e.asp
    private class WindowsLayoutStyle extends DefaultLayoutStyle {
        @Override
        public int getPreferredGap(JComponent component1,
                JComponent component2, ComponentPlacement type, int position,
                Container parent) {
            // Checks args
            super.getPreferredGap(component1, component2, type, position,
                                  parent);

            switch(type) {
            case INDENT:
                // Windows doesn't spec this
                if (position == SwingConstants.EAST ||
                        position == SwingConstants.WEST) {
                    int indent = getIndent(component1, position);
                    if (indent &gt; 0) {
                        return indent;
                    }
                    return 10;
                }
                // Fall through to related.
            case RELATED:
                if (isLabelAndNonlabel(component1, component2, position)) {
                    // Between text labels and their associated controls (for
                    // example, text boxes and list boxes): 3
                    // NOTE: We're not honoring:
                    // 'Text label beside a button 3 down from the top of
                    // the button,' but I suspect that is an attempt to
                    // enforce a baseline layout which will be handled
                    // separately.  In order to enforce this we would need
                    // this API to return a more complicated type (Insets,
                    // or something else).
                    return getButtonGap(component1, component2, position,
                                        dluToPixels(3, position));
                }
                // Between related controls: 4
                return getButtonGap(component1, component2, position,
                                    dluToPixels(4, position));
            case UNRELATED:
                // Between unrelated controls: 7
                return getButtonGap(component1, component2, position,
                                    dluToPixels(7, position));
            }
            return 0;
        }

        @Override
        public int getContainerGap(JComponent component, int position,
                                   Container parent) {
            // Checks args
            super.getContainerGap(component, position, parent);
            return getButtonGap(component, position, dluToPixels(7, position));
        }

    }

    /**
     * Converts the dialog unit argument to pixels along the specified
     * axis.
     */
    private int dluToPixels(int dlu, int direction) {
        if (baseUnitX == 0) {
            calculateBaseUnits();
        }
        if (direction == SwingConstants.EAST ||
            direction == SwingConstants.WEST) {
            return dlu * baseUnitX / 4;
        }
        assert (direction == SwingConstants.NORTH ||
                direction == SwingConstants.SOUTH);
        return dlu * baseUnitY / 8;
    }

    /**
     * Calculates the dialog unit mapping.
     */
    private void calculateBaseUnits() {
        // This calculation comes from:
        // http://support.microsoft.com/default.aspx?scid=kb;EN-US;125681
        FontMetrics metrics = Toolkit.getDefaultToolkit().getFontMetrics(
                UIManager.getFont(&quot;Button.font&quot;));
        baseUnitX = metrics.stringWidth(
                &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;);
        baseUnitX = (baseUnitX / 26 + 1) / 2;
        // The -1 comes from experimentation.
        baseUnitY = metrics.getAscent() + metrics.getDescent() - 1;
    }

    /**
     * {@inheritDoc}
     *
     * @since 1.6
     */
    public Icon getDisabledIcon(JComponent component, Icon icon) {
        // if the component has a HI_RES_DISABLED_ICON_CLIENT_KEY
        // client property set to Boolean.TRUE, then use the new
        // hi res algorithm for creating the disabled icon (used
        // in particular by the WindowsFileChooserUI class)
        if (icon != null
                &amp;&amp; component != null
                &amp;&amp; Boolean.TRUE.equals(component.getClientProperty(HI_RES_DISABLED_ICON_CLIENT_KEY))
                &amp;&amp; icon.getIconWidth() &gt; 0
                &amp;&amp; icon.getIconHeight() &gt; 0) {
            BufferedImage img = new BufferedImage(icon.getIconWidth(),
                    icon.getIconWidth(), BufferedImage.TYPE_INT_ARGB);
            icon.paintIcon(component, img.getGraphics(), 0, 0);
            ImageFilter filter = new RGBGrayFilter();
            ImageProducer producer = new FilteredImageSource(img.getSource(), filter);
            Image resultImage = component.createImage(producer);
            return new ImageIconUIResource(resultImage);
        }
        return super.getDisabledIcon(component, icon);
    }

    private static class RGBGrayFilter extends RGBImageFilter {
        public RGBGrayFilter() {
            canFilterIndexColorModel = true;
        }
        public int filterRGB(int x, int y, int rgb) {
            // find the average of red, green, and blue
            float avg = (((rgb &gt;&gt; 16) &amp; 0xff) / 255f +
                          ((rgb &gt;&gt;  8) &amp; 0xff) / 255f +
                           (rgb        &amp; 0xff) / 255f) / 3;
            // pull out the alpha channel
            float alpha = (((rgb&gt;&gt;24)&amp;0xff)/255f);
            // calc the average
            avg = Math.min(1.0f, (1f-avg)/(100.0f/35.0f) + avg);
            // turn back into rgb
            int rgbval = (int)(alpha * 255f) &lt;&lt; 24 |
                         (int)(avg   * 255f) &lt;&lt; 16 |
                         (int)(avg   * 255f) &lt;&lt;  8 |
                         (int)(avg   * 255f);
            return rgbval;
        }
    }

    private static class FocusColorProperty extends DesktopProperty {
        public FocusColorProperty () {
            // Fallback value is never used because of the configureValue method doesn't return null
            super(&quot;win.3d.backgroundColor&quot;, Color.BLACK);
        }

        @Override
        protected Object configureValue(Object value) {
            Object highContrastOn = Toolkit.getDefaultToolkit().
                    getDesktopProperty(&quot;win.highContrast.on&quot;);
            if (highContrastOn == null || !((Boolean) highContrastOn).booleanValue()) {
                return Color.BLACK;
            }
            return Color.BLACK.equals(value) ? Color.WHITE : Color.BLACK;
        }
    }

}
</pre>
</body>
</html>
